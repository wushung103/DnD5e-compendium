{"name":"24 - T02 - Fire Shield 2 (火焰護盾球2)","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params =\n[{\n    filterType: \"field\",\n    filterId: \"myFireField\",\n    shieldType: 1,\n    gridPadding: 2,\n    color: 0xE58550,\n    time: 0,\n    blend: 2,\n    intensity: 1.2,\n    lightAlpha: 1,\n    lightSize: 0.7,\n    scale: 1,\n    radius: 1,\n    chromatic: false,\n    discardThreshold: 0.5,\n    alphaDiscard: true,\n    animated :\n    {\n      time : \n      { \n        active: true, \n        speed: 0.0015, \n        animType: \"move\" \n      }\n    }\n}];\nfor (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters(params[0][\"filterId\"]);\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"0IuZqN6j8VV2dw0v"}
{"name":"醒目標示2","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":true},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params = \n[{\n   filterType: \"outline\",\n   filterId: \"myOutline\",\n   padding: 10,\n   color: 0x00FF00,\n   thickness: 0.2,\n   quality: 5,\n   zOrder: 9,\n   animated :\n   {\n      thickness: \n      { \n         active: true,\n         loopDuration: 2000,\n         animType: \"syncCosOscillation\",\n         val1: 1, \n         val2: 3\n      }\n   }\n}];\n    for (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters(params[0][\"filterId\"]);\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"https://assets.forge-vtt.com/5fbe5ec1f959b5dea569b164/uploaded-chat-images/8jctxbhy2wqqux5tb4up7j.png","actorIds":[],"_id":"0SZWMaJ3u6y04wAs"}
{"name":"橡棍術Macro","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false},"core":{"sourceId":"Macro.cslIZHQ9ILsUGEMj"},"cf":{"id":"temp_u8moge7sbaa","path":"Private Compendium#/CF_SEP/法術效果Macro","color":"#000000"}},"scope":"global","command":"let target = canvas.tokens.get(args[1]);\nlet weapons = target.actor.items.filter(i => i.data.type === `weapon`);\nlet weapon_content = ``;\n\nfor (let weapon of weapons) {\n    weapon_content += `<option value=${weapon.id}>${weapon.name}</option>`;\n}\nif (args[0] === \"on\" && !target.getFlag('world', 'shillelagh')) {\n    let content = `\n<div class=\"form-group\">\n  <label>Weapons : </label>\n  <select name=\"weapons\">\n    ${weapon_content}\n  </select>\n</div>`;\n\n    new Dialog({\n        title: \"請選擇要賦魔的武器\",\n        content,\n        buttons:\n        {\n            Ok:\n            {\n                label: `Ok`,\n                callback: (html) => {\n                    let itemId = html.find('[name=weapons]')[0].value;\n                    let item = target.actor.items.get(itemId);\n                    let copy_item = duplicate(item);\n                    target.actor.setFlag(`world`, `shillelagh`, {\n                        id : itemId,\n                        damage : copy_item.data.damage.parts[0][0]    \n                    });\n                    let damage = copy_item.data.damage.parts[0][0];\n                    var newdamage = damage.replace(/1d(4|6)/g,\"1d8\");\n                    copy_item.data.damage.parts[0][0] = newdamage;\n                    copy_item.data.ability = \"wis\";\n                    target.actor.updateEmbeddedEntity(\"OwnedItem\", copy_item);\n                    ChatMessage.create({content: copy_item.name + \" 已賦魔\"});\n                }\n            },\n            Cancel:\n            {\n                label: `Cancel`\n            }\n        }\n    }).render(true);\n}\n\nif (args[0] === \"off\") {\n    let flag = target.actor.getFlag(`world`, `shillelagh`);\n    let itemId = flag.id;\n    let damage = flag.damage;\n    let item = target.actor.items.get(itemId);\n    let copy_item = duplicate(item);\n    copy_item.data.damage.parts[0][0] = damage;\n    copy_item.data.ability = \"\";\n    target.actor.updateEmbeddedEntity(\"OwnedItem\", copy_item);\n    target.actor.unsetFlag(`world`, `shillelagh`);\n    ChatMessage.create({content: copy_item.name + \" 上的魔法解除了\"});\n\n}","author":"uDAdlkna037LVJd3","img":"https://assets.forge-vtt.com/bazaar/systems/dnd5e/assets/icons/spells/enchant-jade-1.jpg","actorIds":[],"_id":"0ijOGhNXzb0XYWEw"}
{"name":"D - Auto-Destroy Example  (範例--設定特效自動結束)","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"let params = \n[{\n    filterType: \"bevel\",\n    autoDestroy: true,\n    rotation: 0,\n    thickness: 5,\n    lightColor: 0x00FF00,\n    lightAlpha: 0.7,\n    shadowColor: 0xFF0000,\n    shadowAlpha: 0.4,\n    animated :\n    {\n       rotation: \n       { \n          active: true,\n          clockWise: true, \n          loopDuration: 1000,\n          loops: 5,\n          animType: \"rotation\"\n       }\n    }\n}];\n\nTokenMagic.addFiltersOnSelected(params);","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"2DVxLlhyDISbYWLD"}
{"name":"英雄氣概Macro","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":true},"core":{"sourceId":"Macro.Hpovl7B98Lq81YHO"},"cf":{"id":"temp_u8moge7sbaa","path":"Private Compendium#/CF_SEP/法術效果Macro","color":"#000000"}},"scope":"global","command":"//DAE Macro Execute, Effect Value = \"Macro Name\" @target @abilities.(insert casting score).mod\n\n\nlet mod = args[2];\nlet target = canvas.tokens.get(args[1]);\n\nif (args[0] === \"on\") {\n    ChatMessage.create({ content: target.name + \"受到了加護\" })\n    const hookId = Hooks.on(\"updateCombat\", (combat, update) => {\n        if (!(\"round\" in update || \"turn\" in update)) return;\n        if (combat.combatant.tokenId === args[1]) {\n            target.actor.update({ \"data.attributes.hp.temp\": mod });\n            ChatMessage.create({ content: target.name + \"身上的加護持續著\"　})\n        }\n    });\n    target.actor.setFlag(\"world\", \"heroismUpdateCombatHookId\", hookId);\n\n}\nif (args[0] === \"off\") {\n   let hookIdFlag = target.actor.getFlag(\"world\", \"heroismUpdateCombatHookId\");\n    ChatMessage.create({ content: target.name + \"身上的加護停止了\" });\n    Hooks.off(\"updateCombat\", hookIdFlag);\n    target.actor.unsetFlag(\"world\", \"heroismUpdateCombatHookId\");\n}","author":"uDAdlkna037LVJd3","img":"https://assets.forge-vtt.com/bazaar/systems/dnd5e/assets/icons/spells/heal-sky-2.jpg","actorIds":[],"_id":"2VaR6dBrcvbBHt4l"}
{"name":"31 - T01 - Glowing Globes (globes) 光點","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params = \n[{\n    filterType: \"globes\",\n    filterId: \"glowingGlobes\",\n    time: 0,\n    color: 0x5099DD,\n    distortion: 0.4,\n    scale: 80,\n    alphaDiscard: false,\n    zOrder: 1,\n    animated :\n    {\n      time : \n      { \n        active: true, \n        speed: 0.0005, \n        animType: \"move\" \n      }\n    }\n}]\nfor (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters();\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"2iPRSEQsP0Eu4RpJ"}
{"name":"24 - T12 - Warp Time Aura (油彩球)","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"furnace":{"runAsGM":false},"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params =\n[{\n    filterType: \"field\",\n    filterId: \"myWarpField\",\n    shieldType: 12,\n    gridPadding: 2,\n    color: 0xFFFFFF,\n    time: 0,\n    blend: 2,\n    intensity: 1.5,\n    lightAlpha: 0.8,\n    lightSize: 0.5,\n    scale: 0.7,\n    radius: 1,\n    chromatic: false,\n    animated :\n    {\n      time : \n      { \n        active: true, \n        speed: 0.0009, \n        animType: \"move\" \n      }\n    }\n}];\nfor (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters();\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"35YIuonrzgNAK4UE"}
{"name":"19 - T02 - Devouring Fire (火焰吞噬)","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params =\n[{\n    filterType: \"fire\",\n    filterId: \"myFire\",\n    intensity: 3,\n    color: 0xFFFFFF,\n    amplitude: 2,\n    time: 0,\n    blend: 10,\n    fireBlend : 1,\n    alphaDiscard: true,\n    zOrder: 50,\n    animated :\n    {\n      time : \n      { \n        active: true, \n        speed: -0.0024, \n        animType: \"move\" \n      }\n    }\n},{\n    filterType: \"glow\",\n    filterId: \"glowripples\",\n    outerStrength: 4,\n    innerStrength: 2,\n    color: 0xAA6500,\n    quality: 0.5,\n    padding: 10,\n    zOrder: 100,\n}];\n for (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters(params[0][\"filterId\"]);\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"3HJizCenFS8HY7ga"}
{"name":"24 - T02 - Fire Shield (火焰護盾球)","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params =\n[{\n    filterType: \"field\",\n    filterId: \"myFireField\",\n    shieldType: 1,\n    gridPadding: 2,\n    color: 0xE58550,\n    time: 0,\n    blend: 2,\n    intensity: 1.2,\n    lightAlpha: 1,\n    lightSize: 0.7,\n    scale: 1,\n    radius: 1,\n    chromatic: false,\n    zOrder: 512,\n    animated :\n    {\n      time : \n      { \n        active: true, \n        speed: 0.0015, \n        animType: \"move\" \n      }\n    }\n}];\nfor (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters(params[0][\"filterId\"]);\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"3pk1wF83XWWbZPC1"}
{"name":"F - 04 - Import FX Presets (local)","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"// Open the console (F12) to check the state of the import\n// You can configure in the module option panel the \"overwrite mode on import\"\n\nTokenMagic.importPresetLibrary();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"3uiPv0WpFqjz3rU8"}
{"name":"藍色EB","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"core":{"sourceId":"Macro.AFtnE8v55aIK2h6h"},"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false},"cf":{"id":"temp_aet7bgv1idl","path":"Private Compendium#/CF_SEP/動畫效果","color":"#000000"}},"scope":"global","command":"//This macro plays the animation on selected targets with a trajectory and distances of 15ft, 30ft and 45ft\n//It works for Throwing Dagger, Ray of Frost, Disintegrate\n//Import this macro, duplicate it and change its name making sure it's unique by adding the colour (i.e. \"Ray Of Frost Blue\").\n//If it has the exact same name as the spell or item you want to trigger it from, you'll encounter an issue.\n//folder 01 is the directory path to the assets\n// let folder01 = \"modules/JB2A_DnD5e/Library/Cantrip/Ray_Of_Frost/\";\n//anFile 15 for the 15ft file, anFile30 for 30ft and anFile 45 for 45ft\n// let anFile15 = `${folder01}RayOfFrost_01_Blue_15ft_1000x400.webm`;\n// let anFile30 = `${folder01}RayOfFrost_01_Blue_30ft_1600x400.webm`;\n// let anFile45 = `${folder01}RayOfFrost_01_Blue_45ft_2200x400.webm`;\n\n//How you would set it up for the Thrown Dagger01\n// let folder01 = \"modules/JB2A_DnD5e/Library/Generic/Weapon_Attacks/Ranged/\";\n// let anFile15 = `${folder01}ThrowingWeapon_Dagger01_15ft_1000x400.webm`;\n// let anFile30 = `${folder01}ThrowingWeapon_Dagger01_30ft_1600x400.webm`;\n// let anFile45 = `${folder01}ThrowingWeapon_Dagger01_45ft_2200x400.webm`;\n\n//How this macro is set up for Disintegrate\nlet folder01 = \"modules/JB2A_DnD5e/Library/Cantrip/Ray_Of_Frost/\";\nlet anFile15 = `${folder01}RayOfFrost_01_Blue_15ft_1000x400.webm`;\nlet anFile30 = `${folder01}RayOfFrost_01_Blue_30ft_1600x400.webm`;\nlet anFile45 = `${folder01}RayOfFrost_01_Blue_45ft_2200x400.webm`;\n\n\nif(game.user.targets.size == 0) ui.notifications.error('請至少選取一個目標');\nif(canvas.tokens.controlled.length == 0) ui.notifications.error(\"請選取你的Token\");\n///Check if Module dependencies are installed or returns an error to the user\nif (!canvas.fxmaster) ui.notifications.error(\"這個Marco需要搭配FXMaster module使用，請確保它功能啟動\");\nconst wait = (delay) => new Promise((resolve) => setTimeout(resolve, delay))\n\n\nasync function Cast() {\nvar myStringArray = Array.from(game.user.targets)[0];\nvar arrayLength = game.user.targets.size;\nfor (var i = 0; i < arrayLength; i++) {\n\nlet mainTarget = Array.from(game.user.targets)[i];\nlet myToken = canvas.tokens.controlled [0];\n\nlet ray = new Ray(myToken.center, mainTarget.center);\nlet anDeg = -(ray.angle * 57.3);\nlet anDist = ray.distance;\n\nlet anFile = anFile15;\nlet anFileSize = 600;\nlet anchorX = 0.2;\nswitch(true){\n case (anDist<=600):\n    anFileSize = 600;\n    anFile = anFile15;\n    anchorX = 0.2;\n    break;\n case (anDist>1200):\n    anFileSize = 1800;\n    anFile = anFile45;\n    anchorX = 0.091;\n    break;\n default:\n    anFileSize = 1200;\n    anFile = anFile30;\n    anchorX = 0.125;\n    break;\n}\n\nlet anScale = anDist / anFileSize;\nlet anScaleY = anScale;\nif (anDist<=300){anScaleY = 0.7}\nif (anDist>=400 && anDist<=600){anScaleY = anScale*0.9}\nif (anDist>=700 && anDist<=900){anScaleY = 0.8}\nif (anDist>=1000 && anDist<=1200){anScaleY = anScale*0.9}\nif (anDist>=1300 && anDist<=1500){anScaleY = 0.6}\nif (anDist>=1600 && anDist<=1800){anScaleY = 0.8}\nif (anDist>=1800){anScaleY = anScale}\n\nlet spellAnim = \n                    {\n                     file: anFile,\n                      position: myToken.center,\n                      anchor: {\n                       x: anchorX,\n                       y: 0.5\n                      },\n                      angle: anDeg,\n                      scale: {\n                       x: anScale,\n                       y: anScaleY\n                      }\n                    }; \n\ncanvas.fxmaster.playVideo(spellAnim);\ngame.socket.emit('module.fxmaster', spellAnim);\nawait wait (500);\n}\n}\nCast ()","author":"uDAdlkna037LVJd3","img":"https://assets.forge-vtt.com/bazaar/modules/JB2A_DnD5e/assets/Library/Cantrip/Ray_Of_Frost/RayOfFrost_01_Blue_Thumb.webp","actorIds":[],"_id":"4JhdmEMevAeJkPKC"}
{"name":"06 - Bloom (亮白色呼吸光)","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function ()  {\nlet params = \n[{\n   filterType: \"xbloom\",\n   filterId: \"letsShine\",\n   threshold: 0.35,\n   bloomScale: 0,\n   brightness: 1,\n   blur: 0.1,\n   padding: 10,\n   quality: 15,\n   blendMode: 0,\n   animated:\n   {\n       bloomScale: \n       { \n          active: true, \n          loopDuration: 2000, \n          animType: \"syncCosOscillation\", \n          val1: 0, \n          val2: 2.1\n       },\n       threshold:  \n       { \n          active: false, \n          loopDuration: 1000, \n          animType: \"syncCosOscillation\", \n          val1: 0.00, \n          val2: 1.90\n       }\n   }\n}];\n  for (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters(params[0][\"filterId\"]);\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"4dwN3Q4pXx0biMmB"}
{"name":"11 - Blur 震動模糊","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params =\n[{\n    filterType: \"blur\",\n    filterId: \"myBlur\",\n    padding: 10,\n    quality: 4.0,\n    blur: 0,\n    blurX: 0,\n    blurY: 0,\n    animated:\n    {\n        blurX: \n        { \n           active: true, \n           animType: \"syncCosOscillation\", \n           loopDuration: 500, \n           val1: 0, \n           val2: 6\n        },\n        blurY: \n        { \n           active: true, \n           animType: \"syncCosOscillation\", \n           loopDuration: 750, \n           val1: 0, \n           val2: 6}\n    }\n}];\n\n    for (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters(params[0][\"filterId\"]);\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"590qyyOV1jOKCZZz"}
{"name":"36 - T01 - Turn into Mystery Man (polymorph) 變形成其他外貌","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"// This macro contains a small tutorial : how to work with non-infinite loops and halfCosOscillation animType\n\n// Click once to transform your token and again to revert to the original shape (thank to halfCosOscillation)\n\n// There is 9 types of metamorphose\n// 1 - Simple transition\n// 2 - Dreamy\n// 3 - Twist\n// 4 - Water drop\n// 5 - TV Noise\n// 6 - Morphing\n// 7 - Take off/Put on you disguise!\n// 8 - Wind\n// 9 - Hologram\n\n// change the type here\nlet transitionType = 4;\n\n// change the target image here\nlet targetImagePath = \"icons/svg/mystery-man.svg\";\n\n// declare filter id (think to change the id for personal macros)\n// each filterId should be unique to a player or gm to prevent collisions\n// example : \"brutusChthulhuPolymorph\"\nlet polymorphFilterId = \"myPolymorph\";\n\n// we put our code into an async function that will be called later\nlet polymorphFunc = async function () {\n\n    for (const token of canvas.tokens.controlled) {\n        let params;\n        \n        // Is the filter already activated on the placeable ? \n        if (token.TMFXhasFilterId(polymorphFilterId)) {\n           \n            // Yes. So we update the type in the general section and loops + active in the progress animated section, to activate the animation for just one loop.\n            // \"type\" to allow you to change the animation type\n            // \"active\" to say at Token Magic : \"Hey filter! It's time to work again!\"\n            // \"loops\" so that Token Magic can know how many loops it needs to schedule for the animation.\n            // Each animation loop decreases \"loops\" by one. When \"loops\" reach 0, \"active\" becomes \"false\" and the animation will be dormant again.\n            // Thank to the halfCosOscillation, a loop brings the value of the property from val1 to val2. A second loop is needed to bring val2 to val1. This is useful for monitoring progress with back and forth movements.\n            params =\n                [{\n                    filterType: \"polymorph\",\n                    filterId: polymorphFilterId,\n                    type: transitionType,\n                    animated:\n                    {\n                        progress:\n                        {\n                            active: true,\n                            loops: 1\n                        }\n                    }\n                }];\n\n        } else {\n\n            // No. So we create the entirety of the filter\n            params =\n                [{\n                    filterType: \"polymorph\",\n                    filterId: polymorphFilterId,\n                    type: transitionType,\n                    padding: 70,\n                    magnify: 1,\n                    imagePath: targetImagePath,\n                    animated:\n                    {\n                        progress:\n                        {\n                            active: true,\n                            animType: \"halfCosOscillation\",\n                            val1: 0,\n                            val2: 100,\n                            loops: 1,\n                            loopDuration: 1000\n                        }\n                    }\n                }];\n        }\n\n        // all functions that add, update or delete filters are asynchronous\n        // if you are in a loop AND/OR you chain these functions, it is MANDATORY to await them\n        // otherwise, data persistence may not works.\n        // this is the reason why we use an async function (we cant use await in a non-async function)\n        // avoid awaiting in a forEach loop, use \"for\" or \"for/of\" loop.\n        await token.TMFXaddUpdateFilters(params);\n    }\n\n};\n\n// polymorph async function call\npolymorphFunc();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"5SD5QpK4ctTJZTaQ"}
{"name":"33 - T02 - Saving Roll (transform) 晃跳","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"furnace":{"runAsGM":false},"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params =\n    [{\n        filterType: \"transform\",\n        filterId: \"savingRoll\",\n        autoDestroy: true,\n        padding: 80,\n        pivotX: 0.5,\n        pivotY: 0.55,\n        animated:\n        {\n            translationX:\n            {\n                animType: \"sinOscillation\",\n                val1: -0.220,\n                val2: +0.220,\n                loops: 1,\n                loopDuration: 1250\n            },\n            rotation:\n            {\n                animType: \"sinOscillation\",\n                val1: -360,\n                val2: +360,\n                loops: 1,\n                loopDuration: 1250,\n            },\n            scaleY:\n            {\n                animType: \"cosOscillation\",\n                val1: 1,\n                val2: 1.3,\n                loops: 2,\n                loopDuration: 625,\n            },\n            scaleX:\n            {\n                animType: \"cosOscillation\",\n                val1: 1,\n                val2: 1.4,\n                loops: 2,\n                loopDuration: 625,\n            }\n        }\n    }];\nfor (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters();\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"661XY25actFhI4SG"}
{"name":"CUB Condition","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false},"core":{"sourceId":"Macro.WdwVdMQmK7EhPkKV"},"cf":{"id":"temp_p28w90xb3v","path":"Private Compendium#/CF_SEP/系統(背景運作)","color":"#000000"}},"scope":"global","command":"let target = args[2];\nif(args[0] === \"apply\"){\n    game.cub.addCondition(args[1], target)\n}\nif(args[0] === \"remove\") {\n    game.cub.removeCondition(args[1], target )\n}","author":"uDAdlkna037LVJd3","img":"https://assets.forge-vtt.com/bazaar/core/icons/svg/dice-target.svg","actorIds":[],"_id":"68Cr9z9XEJlpD4n0"}
{"name":"魔法武器Macro","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false},"core":{"sourceId":"Macro.6avU8avuuue4Q8hE"},"cf":{"id":"temp_u8moge7sbaa","path":"Private Compendium#/CF_SEP/法術效果Macro","color":"#000000"}},"scope":"global","command":"//DAE Macro Execute, Effect Value = \"Macro Name\" @target\n\nlet target = canvas.tokens.get(args[1]);\nlet weapons = target.actor.items.filter(i => i.data.type === `weapon`);\nlet weapon_content = ``;\nfunction value_limit(val, min, max) {\n    return val < min ? min : (val > max ? max : val);\n};\n\n//Filter for weapons\nfor (let weapon of weapons) {\n    weapon_content += `<option value=${weapon.id}>${weapon.name}</option>`;\n}\n\n/**\n * Select for weapon and apply bonus based on spell level\n */\nif (args[0] === \"on\") {\n    let content = `\n    <div class=\"form-group\">\n    <label>Weapons : </label>\n    <select name=\"weapons\">\n        ${weapon_content}\n        </select>\n    </div>`;\n\n    new Dialog({\n        content,\n        buttons:\n        {\n            Ok:\n            {\n                label: `Ok`,\n                callback: (html) => {\n                    let itemId = html.find('[name=weapons]')[0].value;\n                    let item = target.actor.items.get(itemId);\n                    let copy_item = duplicate(item);\n                    let spellLevel = Math.floor(args[2] / 2);\n                    let bonus = value_limit(spellLevel, 1, 3);\n                    let wpDamage = copy_item.data.damage.parts[0][0];\n                    target.actor.setFlag(`world`, `magicWeapon`, {\n                        damage: item.data.attackBonus,\n                        weapon: itemId,\n                        weaponDmg: wpDamage,\n                    }\n                    );\n                    copy_item.data.attackBonus = (copy_item.data.attackBonus + bonus);\n                    copy_item.data.damage.parts[0][0] = (wpDamage + \" + \" + bonus);\n                    target.actor.updateEmbeddedEntity(\"OwnedItem\", copy_item);\n                }\n            },\n            Cancel:\n            {\n                label: `Cancel`\n            }\n        }\n    }).render(true);\n}\n\n//Revert weapon and unset flag.\nif (args[0] === \"off\") {\n    let { damage, weapon, weaponDmg } = target.actor.getFlag('world', 'magicWeapon');\n    let item = target.actor.items.get(weapon);\n    let copy_item = duplicate(item);\n    copy_item.data.attackBonus = (copy_item.data.attackBonus - damage);\n    copy_item.data.damage.parts[0][0] = weaponDmg;\n    target.actor.updateEmbeddedEntity(\"OwnedItem\", copy_item);\n    target.actor.unsetFlag(`world`, `magicWeapon`);\n}","author":"uDAdlkna037LVJd3","img":"https://assets.forge-vtt.com/bazaar/systems/dnd5e/assets/icons/spells/enchant-blue-2.jpg","actorIds":[],"_id":"6TBJnuJAk8WsCMXX"}
{"name":"26 - T01 - Spectral Body (liquid) 水感濾鏡","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params =\n[{\n    filterType: \"liquid\",\n    filterId: \"mySpectralBody\",\n    color: 0x20AAEE,\n    time: 0,\n    blend: 8,\n    intensity: 4,\n    spectral: true,\n    scale: 0.9,\n    animated :\n    {\n       time : \n       { \n          active: true, \n          speed: 0.0010, \n          animType: \"move\" \n       },\n       color: \n       {\n          active: true, \n          loopDuration: 6000, \n          animType: \"colorOscillation\", \n          val1:0xFFFFFF, \n          val2:0x00AAFF\n       }\n    }\n}];\nfor (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters();\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"6aeeEkp8AMDVFGoy"}
{"name":"09 - T01 - Twist (transform) 扭曲","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params =\n    [{\n        filterType: \"transform\",\n        filterId: \"myTwistTransform\",\n        twRadiusPercent: 70,\n        padding: 10,\n        animated:\n        {\n            twRotation:\n            {\n                animType: \"sinOscillation\",\n                val1: -90,\n                val2: +90,\n                loopDuration: 5000,\n            }\n        }\n    }];\n for (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters(params[0][\"filterId\"]);\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"6m2AyMg1MzFZysl6"}
{"name":"03 - Drop Shadow","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params =\n[{\n    filterType: \"shadow\",\n    filterId: \"myShadow\",\n    rotation: 35,\n    blur: 2,\n    quality: 5,\n    distance: 20,\n    alpha: 0.7,\n    padding: 10,\n    shadowOnly: false,\n    color: 0x000000,\n    zOrder: 6000,\n    animated:\n    {\n        blur:     \n        { \n           active: true, \n           loopDuration: 500, \n           animType: \"syncCosOscillation\", \n           val1: 2, \n           val2: 4\n        },\n        rotation:\n        {\n           active: true,\n           loopDuration: 100,\n           animType: \"syncSinOscillation\",\n           val1: 33,\n           val2: 37\n        }\n     }\n}];\n\n    for (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters(params[0][\"filterId\"]);\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"6p2YTzNg1pEdQVjG"}
{"name":"35 - T09 - SuperHeat (xfire) 熱視線","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params =\n[{\n    filterType: \"xfire\",\n    filterId: \"mySuperHeat\",\n    time: 0,\n    blend: 5,\n    amplitude: 0.25,\n    dispersion: -1,\n    chromatic: false,\n    scaleX: 1,\n    scaleY: 1,\n    inlay: true,\n    animated :\n    {\n      time : \n      { \n        active: true, \n        speed: -0.0090, \n        animType: \"move\" \n      }\n    }\n}];\nfor (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters();\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"7DVoPfId65Yu2lST"}
{"name":"35 - T10 - Animated SuperHeat (xfire+liquid+wave) 晃動岩漿","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params =\n[{\n    filterType: \"xfire\",\n    filterId: \"myAnimSuperHeat\",\n    time: 0,\n    blend: 5,\n    amplitude: 0.5,\n    dispersion: -1,\n    chromatic: false,\n    scaleX: 1,\n    scaleY: 1,\n    inlay: true,\n    animated :\n    {\n      time : \n      { \n        active: true, \n        speed: -0.0090, \n        animType: \"move\" \n      }\n    }\n},\n{\n    filterType: \"liquid\",\n    filterId: \"myAnimSuperHeat\",\n    color: 0xBB9500,\n    time: 0,\n    blend: 8,\n    intensity: 1,\n    spectral: false,\n    scale: 0.25,\n    animated :\n    {\n       time : \n       { \n          active: true, \n          speed: 0.0010, \n          animType: \"move\" \n       }\n    }\n},\n{\n    filterType: \"wave\",\n    filterId: \"myAnimSuperHeat\",\n    time: 0,\n    anchorX: 0.5,\n    anchorY: 0.5,\n    strength: 0.005,\n    frequency: 60,\n    color: 0xFFFFFF,\n    maxIntensity: 2.0,\n    minIntensity: 1.0,\n    padding:10,\n    animated :\n    {\n      time : \n      { \n        active: true, \n        speed: 0.0100, \n        animType: \"move\" \n      }\n    }\n}];\nfor (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters();\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"8EznaocW6cVscPvv"}
{"name":"藍彈動畫","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"core":{"sourceId":"Macro.68CDpJv8wdDdnGI6"},"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false},"cf":{"id":"temp_aet7bgv1idl","path":"Private Compendium#/CF_SEP/動畫效果","color":"#000000"}},"scope":"global","command":"//This macro plays the animation on selected targets with a trajectory and distances of 30ft, 60ft and 90ft\n//It works for animations like Scorching Ray, Fire Bolt, Arrow, Boulder Toss, Siege Projectile that use these distances\n//Import this macro, duplicate it and change its name making sure it's unique by adding the colour (i.e. \"Ray Of Frost Blue\").\n//If it has the exact same name as the spell or item you want to trigger it from, you'll encounter an issue.\n\n//folder 01 is the directory path to the assets\n// let folder01 = \"modules/JB2A_DnD5e/Library/2nd_Level/Scorching_Ray/\";\n//anFile30 points to the file corresponding to 30ft, anFile60 for 60ft and anFile90 for 90ft\n// let anFile30 = `${folder01}ScorchingRay_01_Orange_30ft_1600x400.webm`;\n// let anFile60 = `${folder01}ScorchingRay_01_Orange_60ft_2800x400.webm`;\n// let anFile90 = `${folder01}ScorchingRay_01_Orange_90ft_4000x400.webm`;\n\n//How this macro is set up for Fire Bolt\nlet folder01 = \"modules/JB2A_DnD5e/Library/Generic/Weapon_Attacks/Ranged/\";\nlet anFile30 = `${folder01}LazerShot_01_Blue_30ft_1600x400.webm`;\nlet anFile60 = `${folder01}LazerShot_01_Blue_30ft_1600x400.webm`;\nlet anFile90 = `${folder01}LazerShot_01_Blue_30ft_1600x400.webm`;\n\n\nif(game.user.targets.size == 0) ui.notifications.error('請至少選取一個目標');\nif(canvas.tokens.controlled.length == 0) ui.notifications.error(\"請選取你的Token\");\n///Check if Module dependencies are installed or returns an error to the user\nif (!canvas.fxmaster) ui.notifications.error(\"這個Marco需要搭配FXMaster module使用，請確保它功能啟動\");\n\nconst wait = (delay) => new Promise((resolve) => setTimeout(resolve, delay))\n\nasync function Cast() {\nvar myStringArray = Array.from(game.user.targets)[0];\nvar arrayLength = game.user.targets.size;\nfor (var i = 0; i < arrayLength; i++) {\n\nlet mainTarget = Array.from(game.user.targets)[i];\nlet myToken = canvas.tokens.controlled [0];\n\nlet ray = new Ray(myToken.center, mainTarget.center);\nlet anDeg = -(ray.angle * 57.3);\nlet anDist = ray.distance;\n\n\nlet anFile = anFile30;\nlet anFileSize = 1200;\nlet anchorX = 0.125;\nswitch(true){\n case (anDist<=1200):\n    anFileSize = 1200;\n    anFile = anFile30;\n    anchorX = 0.125;\n    break;\n case (anDist>2400):\n    anFileSize = 3600;\n    anFile = anFile90;\n    anchorX = 0.05;\n    break;\n default:\n    anFileSize = 2400;\n    anFile = anFile60;\n    anchorX = 0.071;\n    break;\n}\n\nlet anScale = anDist / anFileSize;\nlet anScaleY = anDist <= 600 ? 0.6  : anScale;\n\nlet spellAnim = \n                    {\n                     file: anFile,\n                      position: myToken.center,\n                      anchor: {\n                       x: anchorX,\n                       y: 0.5\n                      },\n                      angle: anDeg,\n                      scale: {\n                       x: anScale,\n                       y: anScaleY\n                      }\n                    }; \n\ncanvas.fxmaster.playVideo(spellAnim);\ngame.socket.emit('module.fxmaster', spellAnim);\nawait wait (250);\n}\n}\nCast ()","author":"uDAdlkna037LVJd3","img":"https://assets.forge-vtt.com/bazaar/modules/JB2A_DnD5e/assets/Library/Generic/Weapon_Attacks/Ranged/LazerShot_01_Blue_Thumb.webp","actorIds":[],"_id":"8H28O6gQaUakoah1"}
{"name":"火焰刀Macro","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false},"core":{"sourceId":"Macro.SlQPN9cea6VW9R5d"},"cf":{"id":"temp_u8moge7sbaa","path":"Private Compendium#/CF_SEP/法術效果Macro","color":"#000000"}},"scope":"global","command":"//DAE Macro Execute, Effect Value = \"Macro Name\" @target @item.level\n\nlet target = canvas.tokens.get(args[1])\nlet data = {}\n/**\n * Create Flame Blade item in inventory\n */\nif (args[0] === \"on\") {\n  let weaponDamge = 2 + Math.floor(args[2] / 2);\n  await target.actor.createOwnedItem(\n    {\n      \"name\": \"火焰刀\",\n      \"type\": \"weapon\",\n      \"data\": {\n        \"quantity\": 1,\n        \"activation\": {\n          \"type\": \"action\",\n          \"cost\": 1,\n          \"condition\": \"\"\n        },\n        \"duration\": {\n          \"value\": null,\n          \"units\": \"\"\n        },\n        \"target\": {\n          \"value\": 1,\n          \"width\": null,\n          \"units\": \"\",\n          \"type\": \"creature\"\n        },\n        \"range\": {\n          \"value\": 5,\n          \"long\": null,\n          \"units\": \"\"\n        },\n        \"uses\": {\n          \"value\": 0,\n          \"max\": 0,\n          \"per\": \"\"\n        },\n        \"consume\": {\n          \"type\": \"\",\n          \"target\": \"\",\n          \"amount\": null\n        },\n        \"ability\": \"\",\n        \"actionType\": \"msak\",\n        \"attackBonus\": \"0\",\n        \"chatFlavor\": \"\",\n        \"critical\": null,\n        \"damage\": {\n          \"parts\": [\n            [\n              `${weaponDamge}d6`,\n              \"fire\"\n            ]\n          ],\n          \"versatile\": \"\"\n        },\n        \"weaponType\": \"simpleM\",\n        \"proficient\": true,\n      },\n      \"img\": \"systems/dnd5e/icons/spells/enchant-orange-2.jpg\",\n    }\n  );\n}\n\n// Delete Flame Blade\nif (args[0] === \"off\") {\n  let item = target.actor.data.items.find(i => i.name === \"火焰刀\" && i.type === \"weapon\")\n  target.actor.deleteOwnedItem(item._id)\n}","author":"uDAdlkna037LVJd3","img":"https://assets.forge-vtt.com/bazaar/systems/dnd5e/assets/icons/spells/enchant-orange-2.jpg","actorIds":[],"_id":"8gVmjgxF0e4Opq44"}
{"name":"24 - T06 - Air Bubble (暗影球(水下氣泡))","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params =\n[{\n    filterType: \"field\",\n    filterId: \"myAirField\",\n    shieldType: 6,\n    gridPadding: 1.2,\n    color: 0x7090AA,\n    time: 0,\n    blend: 1,\n    intensity: 1,\n    lightAlpha: 1,\n    lightSize: 0.7,\n    scale: 1,\n    radius: 1,\n    chromatic: false,\n    zOrder: 512,\n    animated :\n    {\n      time : \n      { \n        active: true, \n        speed: 0.0015, \n        animType: \"move\" \n      }\n    }\n}];\nfor (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters(params[0][\"filterId\"]);\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"8uiNpQ89vApzg4Uy"}
{"name":"至聖斬Macro","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":true},"core":{"sourceId":"Macro.oPNCqJHrvoAxfrrQ"},"cf":{"id":"temp_u8moge7sbaa","path":"Private Compendium#/CF_SEP/法術效果Macro","color":"#000000"}},"scope":"global","command":"/*\n * The Smite macro emulates the Divine Smite feature of Paladins in DnD 5e. A spell slot level to use\n * can be selected, which increases the number of damage dice, and smiting a fiend or undead\n * will also increase the number of damage dice.\n * \n * If a token is not selected, the macro will default back to the default character for the Actor. \n * This allows for the GM to cast the macro on behalf a character that possesses it, \n * without requiring that a PC have their character selected.\n * To execute the macro a target MUST be specified and, unless configured otherwise, the character must have an available spell slot. \n * Make your regular attack and then if you choose to use Divine Smite, run this macro.\n */\n\n(() => {\n\n//Configurable variables\nlet maxSpellSlot = 5; //  Highest spell-slot level that may be used.\nlet affectedCreatureTypes = [\"邪魔\", \"不死生物\", \"不死生物(變形)\"]; //  Creature types that take extra damage.\n\n// Use token selected, or default character for the Actor if none is.\nlet s_actor = canvas.tokens.controlled[0]?.actor || game.user.character;     \n\n// Verifies if the actor can smite.\nif (s_actor?.data.items.find(i => i.name === \"至聖斬 Divine Smite\") === undefined){\n    return ui.notifications.error(`所選角色不具備施展至聖斬的能力`);\n}\n\nlet confirmed = false;\nif (hasAvailableSlot(s_actor)) {\n\n    // Get options for available slots\n    let optionsText = \"\";\n    for (let i = 1; i < maxSpellSlot; i++) {\n        const slots = getSpellSlots(s_actor, i);\n        if (slots.value > 0) {\n            const level = CONFIG.DND5E.spellLevels[i];\n            const label = game.i18n.format('DND5E.SpellLevelSlot', {level: level, n: slots.value});\n            optionsText += `<option value=\"${i}\">${label}</option>`;\n        }\n    }\n\n    // Create a dialogue box to select spell slot level to use when smiting.\n    new Dialog({\n        title: \"至聖斬Divine Smite\",\n        content: `\n        <form id=\"smite-use-form\">\n            <p>` + game.i18n.format(\"DND5E.AbilityUseHint\", {name: \"Divine Smite\", type: \"feature\"}) + `</p>\n            <div class=\"form-group\">\n                <label>Spell Slot Level</label>\n                <div class=\"form-fields\">\n                    <select name=\"slot-level\">` + optionsText + `</select>\n                </div>\n            </div>\n\n            <div class=\"form-group\">\n                <label class=\"checkbox\">\n                <input type=\"checkbox\" name=\"consumeCheckbox\" checked/>` + game.i18n.localize(\"DND5E.SpellCastConsume\") + `</label>\n            </div>\n\n            <div class=\"form-group\">\n                <label class=\"checkbox\">\n                <input type=\"checkbox\" name=\"criticalCheckbox\"/>` + game.i18n.localize(\"DND5E.CriticalHit\") + \"?\" + `</label>\n            </div>\n        </form>\n        `,\n        buttons: {\n            one: {\n                icon: '<i class=\"fas fa-check\"></i>',\n                label: \"SMITE!\",\n                callback: () => confirmed = true\n            },\n            two: {\n                icon: '<i class=\"fas fa-times\"></i>',\n                label: \"Cancel\",\n                callback: () => confirmed = false\n            }\n        },\n        default: \"Cancel\",\n        close: html => {\n            if (confirmed) {\n                const slotLevel = parseInt(html.find('[name=slot-level]')[0].value);\n                const criticalHit = html.find('[name=criticalCheckbox]')[0].checked;\t\t\t\t\n                const consumeSlot = html.find('[name=consumeCheckbox]')[0].checked;\n                smite(s_actor, slotLevel, criticalHit, consumeSlot);\n            }\n        }\n    }).render(true);\n\n} else {\n    return ui.notifications.error(`你法術環用完了`);    \n}\n\n/**\n * Gives the spell slot information for a particular actor and spell slot level.\n * @param {Actor5e} actor - the actor to get slot information from.\n * @param {integer} level - the spell slot level to get information about. level 0 is deprecated.\n * @returns {object} contains value (number of slots remaining), max, and override.\n */\nfunction getSpellSlots(actor, level) {\n    return actor.data.data.spells[`spell${level}`];\n}\n\n/**\n * Returns whether the actor has any spell slot left.\n * @param {Actor5e} actor - the actor to get slot information from.\n * @returns {boolean} True if any spell slots of any spell level are available to be used.\n */\n function hasAvailableSlot(actor) {\n    for (let slot in actor.data.data.spells) {\n        if (actor.data.data.spells[slot].value > 0) {\n            return true;\n        }\n    }\n    return false;\n }\n\n/**\n * Use the controlled token to smite the targeted token.\n * @param {Actor5e} actor - the actor that is performing the action.\n * @param {integer} slotLevel - the spell slot level to use when smiting.\n * @param {boolean} criticalHit - whether the hit is a critical hit.\n * @param {boolean} consume - whether to consume the spell slot.\n */\nfunction smite(actor, slotLevel, criticalHit, consume) {\n    let targets = game.user.targets;\n    let chosenSpellSlots = getSpellSlots(actor, slotLevel);\n\n    if (chosenSpellSlots.value < 1) {\n        ui.notifications.error(\"已經沒有法術環了\");\n        return;\n    }\n    if (targets.size !== 1) {\n        ui.notifications.error(\"你只能斬【一個】目標\");\n        return;\n    }\n\n    targets.forEach(target => {\n        let numDice = slotLevel + 1;\n        let type = target.actor.data.data.details.type?.toLocaleLowerCase();\n        if (affectedCreatureTypes.includes(type)) numDice += 1;\n        if (criticalHit) numDice *= 2;\n        const flavor = `Macro Divine Smite - ${game.i18n.localize(\"DND5E.DamageRoll\")} (${game.i18n.localize(\"DND5E.DamageRadiant\")})`;\n        new Roll(`${numDice}d8`).roll().toMessage({ flavor: flavor, speaker });\n    })\n\n    if (consume){\n        let objUpdate = new Object();\n        objUpdate['data.spells.spell' + slotLevel + '.value'] = chosenSpellSlots.value - 1;\n        actor.update(objUpdate);\n    }\n}\n\n})();\n\n\n//This macro plays the animation on selected targets with no trajectory\n//It works for animations like Cure Wounds, Healing Ability and Dizzy Stars \n//Import this macro, duplicate it and change its name making sure it's unique by adding the colour (i.e. \"Cure Wounds Blue\").\n//If it has the exact same name as the spell or item you want to trigger it from, you'll encounter an issue.\n//folder 01 is the directory path to the assets\nlet folder01 = \"worlds/DamnAdventurers/Special%20Effect/\";\n//anFile is the name of the file used for the animation\nlet anFile = `${folder01}DS.webm`;\n\n//another example would be:\n//let folder01 = \"modules/JB2A_DnD5e/Library/Generic/Healing/\"\n//let anFile = `${folder01}HealingAbility_01_Green_200x200.webm`;\n\nconst wait = (delay) => new Promise((resolve) => setTimeout(resolve, delay))\n\nasync function Cast() {\nvar myStringArray = Array.from(game.user.targets)[0];\nvar arrayLength = game.user.targets.size;\nfor (var i = 0; i < arrayLength; i++) {\n\nlet mainTarget = Array.from(game.user.targets)[i];\nlet tarScale = ((mainTarget.data.width + mainTarget.data.height)/2);\n\n\nlet spellAnim = \n                    {\n                     file: anFile,\n                      position: mainTarget.center,\n                      anchor: {\n                       x: 0.5,\n                       y: 0.9\n                      },\n                      angle: 0,\n                      scale: {\n                       x: 0.9,\n                       y: 0.9\n                      }\n                    }; \ncanvas.fxmaster.playVideo(spellAnim);\ngame.socket.emit('module.fxmaster', spellAnim);\nawait wait (3000);\n}\n}\nCast ()","author":"uDAdlkna037LVJd3","img":"https://assets.forge-vtt.com/bazaar/systems/dnd5e/assets/icons/spells/beam-orange-3.jpg","actorIds":[],"_id":"9ALbs9OeUh09sjc1"}
{"name":"23 - T02 - Chaotic Images (超狂效果)","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"// This is an extreme example...\n\n//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params =\n[{\n    filterType: \"images\",\n    filterId: \"myChaoticImages\",\n    time: 0,\n    nbImage: 4,\n    alphaImg: 1.0,\n    alphaChr: 0.0,\n    blend: 4,\n    ampX: 0.10,\n    ampY: 0.10,\n    padding: 80,\n    zOrder: 20,\n    animated :\n    {\n      time: \n      { \n        active: true, \n        speed: 0.0010, \n        animType: \"move\" \n      },\n      ampX:\n      {\n        active: true,\n        val1: 0.00,\n        val2: 0.30,\n        chaosFactor: 0.03,\n        animType: \"syncChaoticOscillation\",\n        loopDuration: 2000\n      },\n      ampY:\n      {\n        active: true,\n        val1: 0.00,\n        val2: 0.30,\n        chaosFactor: 0.04,\n        animType: \"syncChaoticOscillation\",\n        loopDuration: 1650\n      },\n      alphaChr:        \n      { \n        active: true, \n        animType: \"randomNumberPerLoop\", \n        val1: 0.0, \n        val2: 1,\n        loopDuration: 250\n      },\n      alphaImg:        \n      { \n        active: true, \n        animType: \"randomNumberPerLoop\", \n        val1: 0.8, \n        val2: 1,\n        loopDuration: 250\n      },\n      nbImage:\n      {\n        active: true,\n        val1: 1,\n        val2: 9,\n        animType: \"syncSinOscillation\",\n        loopDuration: 1400\n      }\n    }\n}];\nfor (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters(params[0][\"filterId\"]);\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"9CO2Ies69V2KcqU1"}
{"name":"35 - T05 - Black Fire (xfire) 黑炎濾鏡","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params =\n[{\n    filterType: \"xfire\",\n    filterId: \"myBlackXFire\",\n    time: 0,\n    color: 0x707070,\n    blend: 11,\n    amplitude: 1,\n    dispersion: 2.2,\n    chromatic: false,\n    scaleX: 2.5,\n    scaleY: 2,\n    inlay: false,\n    animated :\n    {\n      time : \n      { \n        active: true, \n        speed: -0.0015, \n        animType: \"move\" \n      }\n    }\n}];\nfor (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters();\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"9Ep1m0nT919pbTDx"}
{"name":"24 - T13 - Simple Color (單色彩球)","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params =\n[{\n    filterType: \"field\",\n    filterId: \"mySimpleField\",\n    shieldType: 13,\n    gridPadding: 2,\n    alpha: 0.25,\n    color: 0xCCCC00,\n    time: 0,\n    blend: 14,\n    intensity: 1.10,\n    lightSize: 0,\n    scale: 1,\n    radius: 1,\n    chromatic: false,\n}];\nfor (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters();\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"9MOEK96x1HI9KUmL"}
{"name":"F - 05 - Import FX Presets (URL)","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"// Replace the dummy url with a valid url that points to a Token Magic FX presets file (json)\n// Open the console (F12) to check the state of the import\n// You can configure in the module option panel the \"overwrite mode on import\"\n\n// TokenMagic.importPresetLibraryFromURL(\"https://presets-to-import-url\");\n\nui.notifications.warn(\"Open this macro and read the instructions.\");","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"9UFkaUACZvB2DcD8"}
{"name":"24 - T07 - Mage Armor 2 法師護甲(薄)","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params =\n[{\n    filterType: \"field\",\n    filterId: \"myMageField\",\n    shieldType: 7,\n    gridPadding: 1,\n    color: 0xEEFFFF,\n    time: 0,\n    blend: 4,\n    intensity: 0.8,\n    lightAlpha: 0,\n    lightSize: 0,\n    scale: 1,\n    radius: 1,\n    chromatic: false,\n    discardThreshold: 0.25,\n    alphaDiscard: true,\n    animated :\n    {\n      time : \n      { \n        active: true, \n        speed: 0.003, \n        animType: \"move\" \n      }\n    }\n}];\n for (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters(params[0][\"filterId\"]);\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"9VGlP9OOl7otVJN2"}
{"name":"15 - Cosmic Ray (黃色斜向光線)","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params =\n[{\n    filterType: \"ray\",\n    filterId : \"myRay\",\n    time: 0,\n    color: 0xCF8000,\n    alpha: 0.5,\n    divisor: 32,\n    anchorX: 0,\n    anchorY: 0,\n    animated :\n    {\n       time : \n       { \n          active: true, \n          speed: 0.0005, \n          animType: \"move\" \n       }\n    }\n}];\n\n    for (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters(params[0][\"filterId\"]);\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"A0O8GfE530nQ0jmP"}
{"name":"35 - T03 - Sparks (xfire) 餘燼火光","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params =\n[{\n    filterType: \"xfire\",\n    filterId: \"mySparksXFire\",\n    time: 0,\n    blend: 2,\n    amplitude: 0.7,\n    dispersion: 0,\n    chromatic: false,\n    scaleX: 2,\n    scaleY: 2,\n    inlay: false,\n    animated :\n    {\n      time : \n      { \n        active: true, \n        speed: -0.0015, \n        animType: \"move\" \n      }\n    }\n}];\nfor (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters();\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"AknFFVfrtcQqW4PN"}
{"name":"治療(綠)","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false},"cf":{"id":"temp_aet7bgv1idl","path":"Private Compendium#/CF_SEP/動畫效果","color":"#000000"}},"scope":"global","command":"//This macro plays the animation on selected targets with no trajectory\n//It works for animations like Cure Wounds, Healing Ability and Dizzy Stars \n//Import this macro, duplicate it and change its name making sure it's unique by adding the colour (i.e. \"Cure Wounds Blue\").\n//If it has the exact same name as the spell or item you want to trigger it from, you'll encounter an issue.\n//folder 01 is the directory path to the assets\nlet folder01 = \"modules/JB2A_DnD5e/Library/Generic/Healing/\";\n//anFile is the name of the file used for the animation\nlet anFile = `${folder01}HealingAbility_01_Green_200x200.webm`;\n\n\n//another example would be:\n//let folder01 = \"modules/JB2A_DnD5e/Library/Generic/Healing/\"\n//let anFile = `${folder01}HealingAbility_01_Green_200x200.webm`;\n\n\n\nconst wait = (delay) => new Promise((resolve) => setTimeout(resolve, delay))\n\nasync function Cast() {\nvar myStringArray = Array.from(game.user.targets)[0];\nvar arrayLength = game.user.targets.size;\nfor (var i = 0; i < arrayLength; i++) {\n\nlet mainTarget = Array.from(game.user.targets)[i];\nlet tarScale = ((mainTarget.data.width + mainTarget.data.height)/2);\n\n\nlet spellAnim = \n                    {\n                     file: anFile,\n                      position: mainTarget.center,\n                      anchor: {\n                       x: 0.5,\n                       y: 0.5\n                      },\n                      angle: 0,\n                      scale: {\n                       x: 0.8,\n                       y: 0.8\n                      }\n                    }; \ncanvas.fxmaster.playVideo(spellAnim);\ngame.socket.emit('module.fxmaster', spellAnim);\nawait wait (75);\n}\n}\nCast ()","author":"uDAdlkna037LVJd3","img":"modules/JB2A_DnD5e/Library/Generic/Healing/HealingAbility_01_Green_Thumb.webp","actorIds":[],"_id":"AnMk9ltmfLgabrLt"}
{"name":"B - Multi-Filters Example","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"let params =\n[{\n    filterType: \"distortion\",\n    maskPath: \"/modules/tokenmagic/fx/assets/waves-2.png\",\n    maskSpriteScaleX: 7,\n    maskSpriteScaleY: 7,\n    padding: 50,\n    animated:\n    {\n        maskSpriteX: { active: true, speed: 0.05, animType: \"move\" },\n        maskSpriteY: { active: true, speed: 0.07, animType: \"move\" }\n    }\n},\n{\n    filterType: \"ray\",\n    time: 0,\n    color: 0xEF9000,\n    alpha: 0.25,\n    divisor: 32,\n    anchorY: 1,\n    animated :\n    {\n       time : \n       { \n          active: true, \n          speed: 0.0005, \n          animType: \"move\" \n       }\n    }\n},\n{\n    filterType: \"glow\",\n    distance: 10,\n    outerStrength: 8,\n    innerStrength: 0,\n    color: 0xB03000,\n    quality: 0.5,\n    animated:\n    {\n        color: \n        {\n           active: true, \n           loopDuration: 3000, \n           animType: \"colorOscillation\", \n           val1:0xB03000, \n           val2:0xFFD010\n        }\n    }\n}\n];\n\nTokenMagic.addFiltersOnSelected(params);","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"ArjXw98jbzHSscq8"}
{"name":"08 - Old film (舊電影黑白濾鏡)","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"// special : the OldFilm filter need an Outline filter to be contained (or else, it will affect all the container)\n\n//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\n\nlet params =\n[{\n    filterType: \"oldfilm\",\n    filterId: \"myOldfilm\",\n    sepia: 0.6,\n    noise: 0.2,\n    noiseSize: 1.0,\n    scratch: 0.8,\n    scratchDensity: 0.5,\n    scratchWidth: 1.2,\n    vignetting: 0.9,\n    vignettingAlpha: 0.6,\n    vignettingBlur: 0.2,\n    animated:\n    {\n        seed:        \n        { \n           active: true, \n           animType: \"randomNumber\", \n           val1: 0, \n           val2: 1 \n        },\n        vignetting:  \n        { \n           active: true, \n           animType: \"syncCosOscillation\" , \n           loopDuration: 2000, \n           val1: 0.2, \n           val2: 0.4 }\n    }\n},\n{\n    filterType: \"outline\",\n    filterId: \"oldfilmOutline\",\n    color: 0x000000,\n    thickness: 0,\n    zOrder: 61\n}];\n\n    for (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters(params[0][\"filterId\"]);\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"B9QTMeLzq1O10pPW"}
{"name":"刀切","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false},"cf":{"id":"temp_aet7bgv1idl","path":"Private Compendium#/CF_SEP/動畫效果","color":"#000000"}},"scope":"global","command":"//This macro plays the animation on selected targets with no trajectory\n//It works for animations like Cure Wounds, Healing Ability and Dizzy Stars \n//Import this macro, duplicate it and change its name making sure it's unique by adding the colour (i.e. \"Cure Wounds Blue\").\n//If it has the exact same name as the spell or item you want to trigger it from, you'll encounter an issue.\n//folder 01 is the directory path to the assets\nlet folder01 = \"worlds/DamnAdventurers/Special%20Effect/\";\n//anFile is the name of the file used for the animation\nlet anFile = `${folder01}Slash.webm`;\n\n\n//another example would be:\n//let folder01 = \"modules/JB2A_DnD5e/Library/Generic/Healing/\"\n//let anFile = `${folder01}HealingAbility_01_Green_200x200.webm`;\n\n\nconst wait = (delay) => new Promise((resolve) => setTimeout(resolve, delay))\n\nasync function Cast() {\nvar myStringArray = Array.from(game.user.targets)[0];\nvar arrayLength = game.user.targets.size;\nfor (var i = 0; i < arrayLength; i++) {\n\nlet mainTarget = Array.from(game.user.targets)[i];\nlet tarScale = ((mainTarget.data.width + mainTarget.data.height)/2);\n\n\nlet spellAnim = \n                    {\n                     file: anFile,\n                      position: mainTarget.center,\n                      anchor: {\n                       x: 0.5,\n                       y: 0.5\n                      },\n                      angle: 0,\n                      scale: {\n                       x: 2.5,\n                       y: 2.5\n                      }\n                    }; \ncanvas.fxmaster.playVideo(spellAnim);\ngame.socket.emit('module.fxmaster', spellAnim);\nawait wait (75);\n}\n}\nCast ()","author":"uDAdlkna037LVJd3","img":"https://assets.forge-vtt.com/5fbe5ec1f959b5dea569b164/uploaded-chat-images/lagg1r1t83rfw44vhc2y3.png","actorIds":[],"_id":"BF9hrGmGYEeIEoBW"}
{"name":"04 - Outline","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params = \n[{\n   filterType: \"outline\",\n   filterId: \"myOutline\",\n   padding: 10,\n   color: 0xEE6035,\n   thickness: 1,\n   quality: 5,\n   zOrder: 9,\n   animated :\n   {\n      thickness: \n      { \n         active: true,\n         loopDuration: 800,\n         animType: \"syncCosOscillation\",\n         val1: 1, \n         val2: 6\n      }\n   }\n}];\n    for (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters(params[0][\"filterId\"]);\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"Bc5IvYSex82SxnMp"}
{"name":"#[CF_tempEntity]","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"chat","flags":{"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000","name":"TOKEN FX","children":["TsHbzNjT2UY0JD1f","E2Ps3sRKDUZBVR7Q","lcxmTY7WBgkXx0SN","LfoYZ1RMzRFIQOib","6p2YTzNg1pEdQVjG","Bc5IvYSex82SxnMp","kjs5jCOzzXNB4sTG","4dwN3Q4pXx0biMmB","MykfS3OkmniBviaD","B9QTMeLzq1O10pPW","6m2AyMg1MzFZysl6","jtJzYaygquI2VT0u","590qyyOV1jOKCZZz","bQDyaCOcS5eL1OfQ","OsCLoh7ZXz07x2jd","UjdYpndt1NuetXfg","Rkn1rQZEliaX7jGY","qwJjewGv1FiMoxGd","A0O8GfE530nQ0jmP","y4CWmtoimFonbmqb","npdbD7mmQagZPMQO","i4jKaUXdiQ5daXX8","3HJizCenFS8HY7ga","JYCx5zeQUjRQBg5e","oSddAGvzdjHrwUuC","u7MTapRnE5GlAFWk","N6svxJsGysTYdU9Q","9CO2Ies69V2KcqU1","nWoXmTDKPkJCJbxx","bEL9WRAcVuFPnSiz","mAxxFqK8TjMdHxdE","QkluzlAbVREEWKPL","S4Fv31stSbg6KNgs","3pk1wF83XWWbZPC1","0IuZqN6j8VV2dw0v","xUb9IboADKjWeeSj","jWpjaqW3oZN9XW7a","CXCoU9ZN36HsEZ81","mU09xRzpZN1ApFFF","TlOqkuTGyUb6V9Pe","l1RmoFW2Mz9oKp7j","DpKZfLEMPQDS0eKv","zWhF9DAMlEqsuLZY","8uiNpQ89vApzg4Uy","9VGlP9OOl7otVJN2","cZTPWACQSqLeloyH","mNsFpiNEaKL4NvYa","gtRR0Mq0BhVbvJ2e","a9LADBP6Y3fOtxku","fh7edOUSG2zPDmXv","mjkrzj0j4M3XaRLL","gy6uaSVHwo6cykSq","ZyYgO54Sh93rR87w","9MOEK96x1HI9KUmL","HbooP0FFlfBK4f54","35YIuonrzgNAK4UE","rL8F9oTqrb4KddCP","K4eVUXsDRf596d4K","p7XxowlYKfyr7dXE","UoFeXp7QUkKsbyuM","6aeeEkp8AMDVFGoy","Vmmj6hvNvvbPLv0p","eUKfi10FcNwMzDj3","uI0MpqXWjeXh4Tag","nnQdkJmbwW4PBk2w","KSNhSTwQ653Tk0DG","rPCygdSKeUgxTSdb","VnXsusYrYTCxt92a","juRIJ6ZALu08Oabj","gDiRDsONBlfGJFCF","OYwjdOLwudbmlx6S","yZaTZa95U3L8MTTc","MnsH5FzqsNrFWFDR","DC46oZJAplR1kwVw","S8Mc8OjH9O2mnivT","2iPRSEQsP0Eu4RpJ","MpBUrtxRZl0EainC","MJKJAVvyOG1xkqZ5","xmmAuLynL0Twt9NN","FN5dW4kOWNlxXEMA","Q946AqvVtOLC2AAO","661XY25actFhI4SG","jrBK4733UZBHuSgR","EZW5TtPX9BanWEsA","F4fWKHI7iUaGw21J","8EznaocW6cVscPvv","7DVoPfId65Yu2lST","CxTyZBGEsD0nkENS","LucYolRQcwi9jgDX","9Ep1m0nT919pbTDx","uLj8n1zx8n0Lcf5O","AknFFVfrtcQqW4PN","UBeW1Zo5OV7mzXTa","F7n2trQWruvEsPKA","5SD5QpK4ctTJZTaQ","9UFkaUACZvB2DcD8","3uiPv0WpFqjz3rU8","z1hlFVckUDQEb3Du","myO2BKwcCn9G8WSp","2DVxLlhyDISbYWLD","q3D85sJZq3X3tabI","ArjXw98jbzHSscq8","Nh41Pg53p9I1HuBz","0SZWMaJ3u6y04wAs","PHp46KgO3hMfh5QV"],"folderPath":[]}},"scope":"global","command":"","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"BmSy7ztTzXUXiAh0"}
{"name":"啃咬動畫","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":true},"cf":{"id":"temp_aet7bgv1idl","path":"Private Compendium#/CF_SEP/動畫效果","color":"#000000"}},"scope":"global","command":"//This macro plays the animation on selected targets with no trajectory\n//It works for animations like Cure Wounds, Healing Ability and Dizzy Stars \n//Import this macro, duplicate it and change its name making sure it's unique by adding the colour (i.e. \"Cure Wounds Blue\").\n//If it has the exact same name as the spell or item you want to trigger it from, you'll encounter an issue.\n//folder 01 is the directory path to the assets\nlet folder01 = \"modules/JB2A_DnD5e/Library/Generic/Creature/\";\n//anFile is the name of the file used for the animation\nlet anFile = `${folder01}Bite_01_Red_400x400.webm`;\n\n\n//another example would be:\n//let folder01 = \"modules/JB2A_DnD5e/Library/Generic/Healing/\"\n//let anFile = `${folder01}HealingAbility_01_Green_200x200.webm`;\n\n\n\nconst wait = (delay) => new Promise((resolve) => setTimeout(resolve, delay))\n\nasync function Cast() {\nvar myStringArray = Array.from(game.user.targets)[0];\nvar arrayLength = game.user.targets.size;\nfor (var i = 0; i < arrayLength; i++) {\n\nlet mainTarget = Array.from(game.user.targets)[i];\nlet tarScale = ((mainTarget.data.width + mainTarget.data.height)/2);\n\n\nlet spellAnim = \n                    {\n                     file: anFile,\n                      position: mainTarget.center,\n                      anchor: {\n                       x: 0.5,\n                       y: 0.5\n                      },\n                      angle: 0,\n                      scale: {\n                       x: 0.8,\n                       y: 0.8\n                      }\n                    }; \ncanvas.fxmaster.playVideo(spellAnim);\ngame.socket.emit('module.fxmaster', spellAnim);\nawait wait (75);\n}\n}\nCast ()","author":"uDAdlkna037LVJd3","img":"modules/JB2A_DnD5e/Library/Generic/Creature/Bite_01_Red_Thumb.webp","actorIds":[],"_id":"CRt4EDL5o2a9UzVB"}
{"name":"24 - T03 - Poisoned Smoke (毒護盾球)","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params =\n[{\n    filterType: \"field\",\n    filterId: \"mySmokeField\",\n    shieldType: 3,\n    gridPadding: 1,\n    color: 0x60CC70,\n    time: 0,\n    blend: 0,\n    intensity: 0.9,\n    lightAlpha: 1,\n    lightSize: 0.7,\n    scale: 1,\n    radius: 1,\n    chromatic: false,\n    zOrder: 512,\n    animated :\n    {\n      time : \n      { \n        active: true, \n        speed: 0.0015, \n        animType: \"move\" \n      }\n    }\n}];\n for (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters(params[0][\"filterId\"]);\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"CXCoU9ZN36HsEZ81"}
{"name":"35 - T07 - SuperFrost (xfire) 結冰","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params =\n[{\n    filterType: \"xfire\",\n    filterId: \"mySuperFrost\",\n    color: 0xACC5C5,\n    time: 0,\n    blend: 5,\n    amplitude: 1,\n    dispersion: 0,\n    chromatic: false,\n    scaleX: 1,\n    scaleY: 1,\n    inlay: true,\n    animated :\n    {\n      time : \n      { \n        active: true, \n        speed: -0.0020, \n        animType: \"move\" \n      }  \n    }\n}];\nfor (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters();\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"CxTyZBGEsD0nkENS"}
{"name":"30 - T02 - Infernal Web (field+web) 蜘蛛網力場球","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params = \n[{\n    filterType: \"field\",\n    filterId: \"infernalWeb\",\n    shieldType: 1,\n    gridPadding: 1.5,\n    color: 0xCC2050,\n    time: 0,\n    blend: 3,\n    intensity: 1,\n    lightAlpha: 1,\n    lightSize: 0.8,\n    scale: 1,\n    radius: 1,\n    chromatic: false,\n    zOrder: 512,\n    animated :\n    {\n      time : \n      { \n        active: true, \n        speed: 0.0012, \n        animType: \"move\" \n      },\n      lightSize:        \n      {\n        val1: 0.4, val2: 1.5,\n        animType: \"syncCosOscillation\",\n        loopDuration: 5000\n      }\n    }\n}\n,{\n    filterType: \"web\",\n    filterId: \"infernalWeb\",\n    time: 100,\n    div1: 16,\n    div2: 8,\n    tear: 0.45,\n    amplitude: 0.8,\n    thickness: 2,\n    color: 0xAA3030,\n    zOrder: 1024,\n    animated :\n    {\n      time : \n      { \n        active: true, \n        speed: 0.0005, \n        animType: \"move\" \n      }\n    }\n}]\n for (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters();\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"DC46oZJAplR1kwVw"}
{"name":"治療(藍)","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false},"cf":{"id":"temp_aet7bgv1idl","path":"Private Compendium#/CF_SEP/動畫效果","color":"#000000"}},"scope":"global","command":"//This macro plays the animation on selected targets with no trajectory\n//It works for animations like Cure Wounds, Healing Ability and Dizzy Stars \n//Import this macro, duplicate it and change its name making sure it's unique by adding the colour (i.e. \"Cure Wounds Blue\").\n//If it has the exact same name as the spell or item you want to trigger it from, you'll encounter an issue.\n//folder 01 is the directory path to the assets\nlet folder01 = \"modules/JB2A_DnD5e/Library/Generic/Healing/\";\n//anFile is the name of the file used for the animation\nlet anFile = `${folder01}HealingAbility_01_Blue_400x400.webm`;\n\n\n//another example would be:\n//let folder01 = \"modules/JB2A_DnD5e/Library/Generic/Healing/\"\n//let anFile = `${folder01}HealingAbility_01_Green_200x200.webm`;\n\n\n\nconst wait = (delay) => new Promise((resolve) => setTimeout(resolve, delay))\n\nasync function Cast() {\nvar myStringArray = Array.from(game.user.targets)[0];\nvar arrayLength = game.user.targets.size;\nfor (var i = 0; i < arrayLength; i++) {\n\nlet mainTarget = Array.from(game.user.targets)[i];\nlet tarScale = ((mainTarget.data.width + mainTarget.data.height)/2);\n\n\nlet spellAnim = \n                    {\n                     file: anFile,\n                      position: mainTarget.center,\n                      anchor: {\n                       x: 0.5,\n                       y: 0.5\n                      },\n                      angle: 0,\n                      scale: {\n                       x: 0.8,\n                       y: 0.8\n                      }\n                    }; \ncanvas.fxmaster.playVideo(spellAnim);\ngame.socket.emit('module.fxmaster', spellAnim);\nawait wait (75);\n}\n}\nCast ()","author":"uDAdlkna037LVJd3","img":"modules/JB2A_DnD5e/Library/Generic/Healing/HealingAbility_01_Blue_Thumb.webp","actorIds":[],"_id":"DiAmi4h5D9gcGnHD"}
{"name":"24 - T05 - Mega - Chroma Shell (on top) (土綠色力場球)","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params =\n[{\n    filterType: \"field\",\n    filterId: \"myEarthFieldTop\",\n    shieldType: 5,\n    gridPadding: 3,\n    color: 0xAAAAAA,\n    time: 0,\n    blend: 5,\n    intensity: 1.9,\n    lightAlpha: 1,\n    lightSize: 0.7,\n    scale: 1,\n    radius: 1,\n    zIndex: 5,\n    chromatic: true,\n    zOrder: 512,\n    animated :\n    {\n      time : \n      { \n        active: true, \n        speed: 0.0015, \n        animType: \"move\" \n      }\n    }\n}];\nfor (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters(params[0][\"filterId\"]);\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"DpKZfLEMPQDS0eKv"}
{"name":"00 - B - 刪除最後一個TokenFX","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"// Delete all filters on the placeable in parameter (token or tile)\nTokenMagic.deleteFilters(_token);","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"E2Ps3sRKDUZBVR7Q"}
{"name":"高等隱形術Macro","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":true},"core":{"sourceId":"Macro.2XqFC9vr6cX7gPOy"},"cf":{"id":"temp_u8moge7sbaa","path":"Private Compendium#/CF_SEP/法術效果Macro","color":"#000000"}},"scope":"global","command":"//DAE Macro Execute, Effect Value = \"Macro Name\" @target\n\nlet target = canvas.tokens.get(args[1])\nif (args[0] === \"on\") {\n    ChatMessage.create({ content: `${target.name} 隱形了` });\n    target.update({ \"hidden\": true });\n}\nif (args[0] === \"off\") {\n    ChatMessage.create({ content: `${target.name} 現形了` });\n    target.update({ \"hidden\": false });\n}","author":"uDAdlkna037LVJd3","img":"https://assets.forge-vtt.com/bazaar/systems/dnd5e/assets/icons/spells/fog-sky-2.jpg","actorIds":[],"_id":"EMrU1ltN93xW6u4C"}
{"name":"34 - T02 - Dead (splash) 爆血死","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params =\n    [{\n        filterType: \"splash\",\n        filterId: \"mySplash\",\n        color: 0x900505,\n        padding: 30,\n        time: Math.random()*1000,\n        seed: Math.random()/100,\n        splashFactor: 2,\n        spread: 7,\n        blend: 1,\n        dimX: 1,\n        dimY: 1,\n        cut: true,\n        textureAlphaBlend: false\n    }];\nfor (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters();\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"https://assets.forge-vtt.com/5fbe5ec1f959b5dea569b164/uploaded-chat-images/0tlaz4f555q6eokrd2bbgs.png","actorIds":[],"_id":"EZW5TtPX9BanWEsA"}
{"name":"隱形術Macro","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":true},"core":{"sourceId":"Macro.tw3fOFIdx3EAzYjS"},"cf":{"id":"temp_u8moge7sbaa","path":"Private Compendium#/CF_SEP/法術效果Macro","color":"#000000"}},"scope":"global","command":"//DAE Macro Execute, Effect Value = \"Macro Name\" @target\n\nlet target = canvas.tokens.get(args[1])\nif (args[0] === \"on\") {\n    ChatMessage.create({ content: `${target.name} 隱形了` });\n    target.update({ \"hidden\": true });\n}\nif (args[0] === \"off\") {\n    ChatMessage.create({ content: `${target.name} 現形了` });\n    target.update({ \"hidden\": false });\n}","author":"uDAdlkna037LVJd3","img":"https://assets.forge-vtt.com/bazaar/systems/dnd5e/assets/icons/spells/fog-sky-2.jpg","actorIds":[],"_id":"F33u1DcaYZpdoDZB"}
{"name":"34 - T01 - Wound/Splash - Repeatable (splash) 血跡加筆","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"let params =\n    [{\n        filterType: \"splash\",\n        filterId: \"mySplash\",\n        rank:5,\n        color: 0x990505,\n        padding: 80,\n        time: Math.random()*1000,\n        seed: Math.random(),\n        splashFactor: 1,\n        spread: 0.4,\n        blend: 1,\n        dimX: 1,\n        dimY: 1,\n        cut: false,\n        textureAlphaBlend: true,\n        anchorX: 0.32+(Math.random()*0.36),\n        anchorY: 0.32+(Math.random()*0.36)\n    }];\n\nTokenMagic.addUpdateFiltersOnSelected(params);","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"F4fWKHI7iUaGw21J"}
{"name":"35 - T01 - Fire v2 (xfire) 暗色火焰","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\n\nlet params =\n[{\n    filterType: \"xfire\",\n    filterId: \"myFireV2XFire\",\n    time: 0,\n    blend: 1,\n    amplitude: 1,\n    dispersion: 0,\n    chromatic: false,\n    scaleX: 1.5,\n    scaleY: 1,\n    inlay: false,\n    animated :\n    {\n      time : \n      { \n        active: true, \n        speed: -0.0015, \n        animType: \"move\" \n      }\n    }\n}];\nfor (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters();\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"F7n2trQWruvEsPKA"}
{"name":"33 - T04 - Some Real Nuts Here! (transform) 一直跳~","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"furnace":{"runAsGM":false},"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\n\nlet params =\n    [{\n        filterType: \"transform\",\n        filterId: \"myTransform\",\n        padding: 200,\n        animated:\n        {\n            rotation:\n            {\n                clockWise: true,\n                loopDuration: 700,\n                animType: \"syncRotation\"\n            },\n            translationX:\n            {\n                animType: \"sinOscillation\",\n                val1: -0.25,\n                val2: +0.25\n            },\n            translationY:\n            {\n                animType: \"sinOscillation\",\n                val1: -0.125,\n                val2: +0.125,\n                loopDuration: 1500\n            },\n            scaleX:\n            {\n                animType: \"sinOscillation\",\n                val1: 0.5,\n                val2: 2.6,\n                loopDuration: 1200\n            },\n            scaleY:\n            {\n                animType: \"sinOscillation\",\n                val1: 0.5,\n                val2: 2.6,\n                loopDuration: 1200\n            }\n        }\n    }];\nfor (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters();\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"FN5dW4kOWNlxXEMA"}
{"name":"更改Token視線/光源","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"core":{"sourceId":"Macro.soTfO1EWK0mAeRqJ"},"cf":{"id":"temp_3cf00lo747r","path":"Private Compendium#/CF_SEP/GM用","color":"#000000"}},"scope":"global","command":"// Open a dialog for quickly changing token vision parameters of the controlled tokens.\n// This macro was written by @Sky#9453\n// https://github.com/Sky-Captain-13/foundry\n\nif (canvas.tokens.controlled.length === 0)\n  return ui.notifications.error(\"請先選擇一個Tokan\");\n\nlet applyChanges = false;\nnew Dialog({\n  title: `Token視線設定`,\n  content: `\n    <form>\n      <div class=\"form-group\">\n        <label>視線類型:</label>\n        <select id=\"vision-type\" name=\"vision-type\">\n          <option value=\"nochange\">不改變</option>\n          <option value=\"dim0\">自己</option>\n          <option value=\"dim30\">黑暗視覺(30 ft)</option>\n          <option value=\"dim60\">黑暗視覺(60 ft)</option>\n          <option value=\"dim90\">黑暗視覺(90 ft)</option>\n          <option value=\"dim120\">黑暗視覺(120 ft)</option>\n          <option value=\"dim150\">黑暗視覺(150 ft)</option>\n          <option value=\"dim180\">黑暗視覺(180 ft)</option>\n          <option value=\"bright120\">魔鬼視界(Warlock)</option>\n        </select>\n      </div>\n      <div class=\"form-group\">\n        <label>光源類型:</label>\n        <select id=\"light-source\" name=\"light-source\">\n          <option value=\"nochange\">不改變</option>\n          <option value=\"none\">無光源</option>\n          <option value=\"candle\">蠟燭</option>\n          <option value=\"lamp\">提燈</option>\n          <option value=\"bullseye\">牛眼提燈</option>\n          <option value=\"hooded-dim\">加蓋提燈(暗)</option>\n          <option value=\"hooded-bright\">加蓋提燈(亮)</option>\n          <option value=\"light\">亮光術</option>\n          <option value=\"torch\">火炬</option>\n        </select>\n      </div>\n    </form>\n    `,\n  buttons: {\n    yes: {\n      icon: \"<i class='fas fa-check'></i>\",\n      label: `Apply Changes`,\n      callback: () => applyChanges = true\n    },\n    no: {\n      icon: \"<i class='fas fa-times'></i>\",\n      label: `Cancel Changes`\n    },\n  },\n  default: \"yes\",\n  close: html => {\n    if (applyChanges) {\n      for ( let token of canvas.tokens.controlled ) {\n        let visionType = html.find('[name=\"vision-type\"]')[0].value || \"none\";\n        let lightSource = html.find('[name=\"light-source\"]')[0].value || \"none\";\n        let dimSight = 0;\n        let brightSight = 0;\n        let dimLight = 0;\n        let brightLight = 0;\n        let lightAngle = 360;\n        let lockRotation = token.data.lockRotation;\n        // Get Vision Type Values\n        switch (visionType) {\n          case \"dim0\":\n            dimSight = 0;\n            brightSight = 0;\n            break;\n          case \"dim30\":\n            dimSight = 30;\n            brightSight = 0;\n            break;\n          case \"dim60\":\n            dimSight = 60;\n            brightSight = 0;\n            break;\n          case \"dim90\":\n            dimSight = 90;\n            brightSight = 0;\n            break;\n          case \"dim120\":\n            dimSight = 120;\n            brightSight = 0;\n            break;\n          case \"dim150\":\n            dimSight = 150;\n            brightSight = 0;\n            break;\n          case \"dim180\":\n            dimSight = 180;\n            brightSight = 0;\n            break;\n          case \"bright120\":\n            dimSight = 0;\n            brightSight= 120;\n            break;\n          case \"nochange\":\n          default:\n            dimSight = token.data.dimSight;\n            brightSight = token.data.brightSight;\n        }\n        // Get Light Source Values\n        switch (lightSource) {\n          case \"none\":\n            dimLight = 0;\n            brightLight = 0;\n            break;\n          case \"candle\":\n            dimLight = 10;\n            brightLight = 5;\n            break;\n          case \"lamp\":\n            dimLight = 45;\n            brightLight = 15;\n            break;\n          case \"bullseye\":\n            dimLight = 120;\n            brightLight = 60;\n            lockRotation = false;\n            lightAngle = 52.5;\n            break;\n          case \"hooded-dim\":\n            dimLight = 5;\n            brightLight = 0;\n            break;\n          case \"hooded-bright\":\n            dimLight = 60;\n            brightLight = 30;\n            break;\n          case \"light\":\n            dimLight = 40;\n            brightLight = 20;\n            break;\n          case \"torch\":\n            dimLight = 40;\n            brightLight = 20;\n            break;\n          case \"nochange\":\n          default:\n            dimLight = token.data.dimLight;\n            brightLight = token.data.brightLight;\n            lightAngle = token.data.lightAngle;\n            lockRotation = token.data.lockRotation;\n        }\n        // Update Token\n        console.log(token);\n        token.update({\n          vision: true,\n          dimSight: dimSight,\n          brightSight: brightSight,\n          dimLight: dimLight,\n          brightLight:  brightLight,\n          lightAngle: lightAngle,\n          lockRotation: lockRotation\n        });\n      }\n    }\n  }\n}).render(true);","author":"uDAdlkna037LVJd3","img":"icons/sundries/lights/lantern-iron-yellow.webp","actorIds":[],"_id":"GYwa5Q7PtoUsONjT"}
{"name":"ActorGetFlag","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":true},"core":{"sourceId":"Macro.LIxsEoRzLeEAAsZd"},"cf":{"id":"temp_p28w90xb3v","path":"Private Compendium#/CF_SEP/系統(背景運作)","color":"#000000"}},"scope":"global","command":"return canvas.tokens.get(args[0]).actor.getFlag(args[1], args[2]);","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"GauCsivK3vbH6Llj"}
{"name":"出血","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false},"cf":{"id":"temp_aet7bgv1idl","path":"Private Compendium#/CF_SEP/動畫效果","color":"#000000"}},"scope":"global","command":"//This macro plays the animation on selected targets with no trajectory\n//It works for animations like Cure Wounds, Healing Ability and Dizzy Stars \n//Import this macro, duplicate it and change its name making sure it's unique by adding the colour (i.e. \"Cure Wounds Blue\").\n//If it has the exact same name as the spell or item you want to trigger it from, you'll encounter an issue.\n//folder 01 is the directory path to the assets\nlet folder01 = \"worlds/DamnAdventurers/Special%20Effect/\";\n//anFile is the name of the file used for the animation\nlet anFile = `${folder01}Blood%20Burst.webm`;\n\n\n//another example would be:\n//let folder01 = \"modules/JB2A_DnD5e/Library/Generic/Healing/\"\n//let anFile = `${folder01}HealingAbility_01_Green_200x200.webm`;\n\nconst wait = (delay) => new Promise((resolve) => setTimeout(resolve, delay))\n\nasync function Cast() {\nvar myStringArray = Array.from(game.user.targets)[0];\nvar arrayLength = game.user.targets.size;\nfor (var i = 0; i < arrayLength; i++) {\n\nlet mainTarget = Array.from(game.user.targets)[i];\nlet tarScale = ((mainTarget.data.width + mainTarget.data.height)/2);\n\n\nlet spellAnim = \n                    {\n                     file: anFile,\n                      position: mainTarget.center,\n                      anchor: {\n                       x: 0.6,\n                       y: 0.6\n                      },\n                      angle: 0,\n                      scale: {\n                       x: 3,\n                       y: 3\n                      }\n                    }; \ncanvas.fxmaster.playVideo(spellAnim);\ngame.socket.emit('module.fxmaster', spellAnim);\nawait wait (75);\n}\n}\nCast ()","author":"uDAdlkna037LVJd3","img":"https://assets.forge-vtt.com/5fbe5ec1f959b5dea569b164/uploaded-chat-images/etx50pcssgr8z93pkr136s.png","actorIds":[],"_id":"GkkTDwLNeblLwKWE"}
{"name":"24 - T12 - Warp Time Aura 2 (油彩球2)","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"furnace":{"runAsGM":false},"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params =\n[{\n    filterType: \"field\",\n    filterId: \"myMageField\",\n    shieldType: 7,\n    gridPadding: 2,\n    color: 0xFFFFFF,\n    time: 0,\n    blend: 4,\n    intensity: 0.8,\n    lightAlpha: 1,\n    lightSize: 0.45,\n    scale: 1,\n    radius: 1,\n    chromatic: true,\n    animated :\n    {\n      time : \n      { \n        active: true, \n        speed: 0.0080, \n        animType: \"move\" \n      }\n    }\n},{\n    filterType: \"field\",\n    filterId: \"myWarpField\",\n    shieldType: 12,\n    gridPadding: 2,\n    color: 0xFFFFFF,\n    time: 0,\n    blend: 2,\n    intensity: 1,\n    lightAlpha: 0,\n    lightSize: 0,\n    scale: 0.7,\n    radius: 1,\n    chromatic: false,\n    alphaDiscard: true,\n    discardThreshold: 0.1,\n    animated :\n    {\n      time : \n      { \n        active: true, \n        speed: 0.0009, \n        animType: \"move\" \n      }\n    }\n}];\nfor (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters();\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"HbooP0FFlfBK4f54"}
{"name":"創造舞光球(綠)","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false},"core":{"sourceId":"Macro.78gwoZysOGs10uQv"},"cf":{"id":"temp_2od1tntv3ht","path":"Private Compendium#/CF_SEP/創造TOKEN","color":"#000000"}},"scope":"global","command":"let d = new Dialog({\n    title: \"創造舞光球\",\n    content: \"<p>在角色列表中已有舞光球可供使用\",\n    buttons: {\n        one: {\n         icon: '<i class=\"fas fa-check\"></i>',\n         label: \"OK\",        \n        },\n      \n    },\n});\nd.render(true);\n\n(async ()=>{\n    let testFolder = game.folders.find(f => f.name === \"舞光球\" && f.type === \"Actor\");\n    if(!testFolder) testFolder = await Folder.create({ name : `舞光球`, type : `Actor`, parent : null });\n  \n    await Actor.create({\n      name: \"舞光球 - 綠色\",\n      type: \"character\",\n      img: \"modules/JB2A_DnD5e/Library/Cantrip/Dancing_Lights/DancingLights_01_Green_Thumb.webp\",\n      folder: testFolder.id,\n      sort: 12000,\n      token: { img: \"modules/JB2A_DnD5e/Library/Cantrip/Dancing_Lights/DancingLights_*.webm\", scale: 0.8},\n      \"token.randomImg\": true,\n      \"token.vision\": true,\n      \"token.dimLight\": 10,\n      \"token.lightAnimation\":{type: \"torch\", speed: 3, intensity: 7},\n      \"token.lightColor\": \"#a2c973\",\n      \"token.lightAlpha\": 0.2,\n    })\n  })();","author":"uDAdlkna037LVJd3","img":"https://assets.forge-vtt.com/bazaar/modules/JB2A_DnD5e/assets/Library/Cantrip/Dancing_Lights/DancingLights_01_Green_Thumb.webp","actorIds":[],"_id":"IgC5PBroyrBUOXA0"}
{"name":"防護能量傷害Macro","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false},"core":{"sourceId":"Macro.rRYlkSknbZUTGI0a"},"cf":{"id":"temp_u8moge7sbaa","path":"Private Compendium#/CF_SEP/法術效果Macro","color":"#000000"}},"scope":"global","command":"//DAE Macro Execute, Effect Value = \"Macro Name\" @target \n\n  let target = canvas.tokens.get(args[1]);\n\n  if (args[0] === \"on\") {\n    new Dialog({\n      title: '請選擇要防護的傷害類型',\n      content: `\n          <form class=\"flexcol\">\n            <div class=\"form-group\">\n              <select id=\"element\">\n                <option value=\"acid\">強酸</option>\n                <option value=\"cold\">冷凍</option>\n                <option value=\"fire\">火焰</option>\n                <option value=\"lightning\">閃電</option>\n                <option value=\"thunder\">雷鳴</option>\n              </select>\n            </div>\n          </form>\n        `,\n      buttons: {\n        yes: {\n          icon: '<i class=\"fas fa-check\"></i>',\n          label: 'Yes',\n          callback: (html) => {\n            let element = html.find('#element').val();\n            let resistances = target.actor.data.data.traits.dr.value;\n            resistances.push(element);\n            target.actor.update({ \"data.traits.dr.value\": resistances });\n            target.actor.setFlag('world', 'ProtectionFromEnergy', element);\n            ChatMessage.create({ content: target.name + \"對\" + element + \"具有抗性了\"});\n          }\n        },\n      },\n    }).render(true);\n  }\n  if (args[0] === \"off\") {\n    let element = target.actor.getFlag('world', 'ProtectionFromEnergy');\n    let resistances = target.actor.data.data.traits.dr.value;\n    const index = resistances.indexOf(element);\n    resistances.splice(index, 1);\n    target.actor.update({ \"data.traits.dr.value\": resistances });\n    target.actor.unsetFlag('world', 'ProtectionFromEnergy');\n    ChatMessage.create({ content: `${target.name} 對 ${element} 的抗性解除了`});\n  }","author":"uDAdlkna037LVJd3","img":"https://assets.forge-vtt.com/bazaar/systems/dnd5e/assets/icons/spells/protect-jade-2.jpg","actorIds":[],"_id":"JDGUw8rSO2WU4YIk"}
{"name":"19 - T01 - Fire (火焰濾鏡)","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params =\n[{\n    filterType: \"fire\",\n    filterId: \"myFire\",\n    intensity: 1,\n    color: 0xFFFFFF,\n    amplitude: 1,\n    time: 0,\n    blend: 2,\n    fireBlend : 1,\n    animated :\n    {\n      time : \n      { \n        active: true, \n        speed: -0.0024, \n        animType: \"move\" \n      },\n      intensity:\n      {\n        active:true,\n        loopDuration: 15000,\n        val1: 0.8,\n        val2: 2,\n        animType: \"syncCosOscillation\"\n      },\n      amplitude:\n      {\n        active:true,\n        loopDuration: 4400,\n        val1: 1,\n        val2: 1.4,\n        animType: \"syncCosOscillation\"\n      }\n      \n    }\n}];\n\n    for (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters(params[0][\"filterId\"]);\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"JYCx5zeQUjRQBg5e"}
{"name":"火焰護盾Macro","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"furnace":{"runAsGM":false},"combat-utility-belt":{"macroTrigger":""},"core":{"sourceId":"Macro.bvIHiiIZMdgXaAzn"},"cf":{"id":"temp_u8moge7sbaa","path":"Private Compendium#/CF_SEP/法術效果Macro","color":"#000000"}},"scope":"global","command":"let target = canvas.tokens.get(args[1]);\n\nif (args[0] === \"on\") {\n    if (token) {   \n        new Dialog({\n            title: \"溫暖護盾(冷凍抗性)\",\n            buttons: {\n                one: {\n                    label: \"溫暖護盾(冷凍抗性)\",\n                    callback: () => {\n                        let resistances = target.actor.data.data.traits.dr.value;\n                        resistances.push(\"cold\");\n                        target.actor.update({ \"data.traits.dr.value\": resistances });\n                        target.actor.setFlag('world', 'FireShield', \"cold\");\n                        ChatMessage.create({ content: target.name + \" 對冷凍傷害具有抗性\" });\n                    }\n                },\n                two: {\n                    label: \"凍寒護盾(火焰抗性)\",\n                    callback: () => {\n                        let resistances = target.actor.data.data.traits.dr.value;\n                        resistances.push(\"fire\");\n                        target.actor.update({ \"data.traits.dr.value\": resistances });\n                        target.actor.setFlag('world', 'FireShield', \"fire\");\n                        ChatMessage.create({ content: target.name + \"對火焰傷害有抗性\" });\n                    }\n                },\n            }\n        }).render(true);\nlet params =\n[{\n    filterType: \"xfire\",\n    filterId: \"mySparksXFire\",\n    time: 0,\n    blend: 2,\n    amplitude: 0.7,\n    dispersion: 0,\n    chromatic: false,\n    scaleX: 2,\n    scaleY: 2,\n    inlay: false,\n    animated :\n    {\n      time : \n      { \n        active: true, \n        speed: -0.0015, \n        animType: \"move\" \n      }\n    }\n}];\n\nTokenMagic.addUpdateFiltersOnSelected(params);\n    }\n}\nif (args[0] === \"off\") {\n    let element = target.actor.getFlag('world', 'FireShield');\n    let resistances = target.actor.data.data.traits.dr.value;\n    const index = resistances.indexOf(element);\n    resistances.splice(index, 1);\n    target.actor.update({ \"data.traits.dr.value\": resistances });\n    ChatMessage.create({ content: target.name + \"身上的護盾效果結束了\"});\nTokenMagic.deleteFilters(_token);\n}","author":"uDAdlkna037LVJd3","img":"https://assets.forge-vtt.com/bazaar/systems/dnd5e/assets/icons/spells/protect-red-3.jpg","actorIds":[],"_id":"JkaxAVMeIoLA2yCJ"}
{"name":"25 - T03 - X-ray Scan (xray) 異界濾鏡","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params =\n[{\n    filterType: \"xray\",\n    filterId: \"myXrayScan\",\n    time: 0,\n    color: 0xFFFFFF,\n    blend: 5,\n    dimX: 20,\n    dimY: 20,\n    anchorX: 0.5,\n    anchorY: 0,\n    divisor: 8,\n    intensity: 1,\n    animated :\n    {\n       time : \n       { \n          active: true, \n          speed: 0.00038, \n          animType: \"move\" \n       }\n    }\n}];\n for (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters();\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"K4eVUXsDRf596d4K"}
{"name":"#[CF_tempEntity]","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"chat","flags":{"cf":{"id":"temp_aet7bgv1idl","path":"Private Compendium#/CF_SEP/動畫效果","color":"#000000","name":"動畫效果","children":["8H28O6gQaUakoah1","4JhdmEMevAeJkPKC","ai4puw7ED4bkdN9j","oBFUKo8lphSXbnlj","kfXB3nnPbGwdHznj","N5x42knUTPZAaEDC","cZBSzVfqbALadC96","iwp4FntrEKQEUVd3","ViAcuvEsJRiaUp1X","BF9hrGmGYEeIEoBW","GkkTDwLNeblLwKWE","CRt4EDL5o2a9UzVB","DiAmi4h5D9gcGnHD","AnMk9ltmfLgabrLt","PcvZD6eZ3KQePYgf","xYkickP7pwcVCHY9","lq5m8KbPeXYRRln8"],"folderPath":["temp_5b37tcuw6xw"]}},"scope":"global","command":"","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"KEpEVOWeyvDSLECk"}
{"name":"27 - T03 - Ugly Villains Aura (xglow) 不詳光芒","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params =\n[{\n    filterType: \"zapshadow\",\n    filterId: \"myUglyZapShadow\",\n    alphaTolerance: 0.50\n},\n{\n    filterType: \"xglow\",\n    filterId: \"myUglyGlow\",\n    auraType: 2,\n    color: 0x050505,\n    thickness: 2.7,\n    scale: 7,\n    time: 0,\n    auraIntensity: 5,\n    subAuraIntensity: 2,\n    threshold: 0.08,\n    discard: false,\n    animated:\n    {\n        time : \n        {  \n           active: true,\n           speed: 0.0012, \n           animType: \"move\" \n        },\n        auraIntensity:\n        {\n           active: true,\n           loopDuration: 3000, \n           animType: \"syncCosOscillation\", \n           val1:5, \n           val2:0\n        },\n        subAuraIntensity:\n        {\n           active: true,\n           loopDuration: 3000, \n           animType: \"syncCosOscillation\", \n           val1:2, \n           val2:0\n        },\n        color:\n        {\n           active: true,\n           loopDuration: 6000, \n           animType: \"syncColorOscillation\", \n           val1:0x050505, \n           val2:0x200000\n        },\n        threshold:\n        {\n           active: true,\n           loopDuration: 1500, \n           animType: \"syncCosOscillation\", \n           val1:0.02, \n           val2:0.50\n        }\n    }\n}];\n for (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters();\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"KSNhSTwQ653Tk0DG"}
{"name":"02 - Adjustment","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"let TokenFXFunction = async function () {\nlet params =\n[{\n    filterType: \"adjustment\",\n    filterId: \"myAdjust\",\n    saturation: 1,\n    brightness: 1,\n    contrast: 1,\n    gamma: 1,\n    red: 0.2,\n    green: 0.2,\n    blue: 0.2,\n    alpha: 1,\n    animated:\n    {\n        alpha: \n        { \n           active: true, \n           loopDuration: 2000, \n           animType: \"syncCosOscillation\",\n           val1: 0.35,\n           val2: 0.75 }\n    }\n}];\n  for (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters(params[0][\"filterId\"]);\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"LfoYZ1RMzRFIQOib"}
{"name":"35 - T06 - Custom Color Fire (xfire) 色彩炎","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"// example with color fine tuning\n//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params =\n[{\n    filterType: \"xfire\",\n    filterId: \"myCustomXFire\",\n    time: 0,\n    color1: 0x00DD20,\n    color2: 0x009090,\n    color3: 0x001020,\n    color4: 0x00CCFF,\n    blend: 1,\n    amplitude: 1,\n    dispersion: 0,\n    chromatic: false,\n    scaleX: 1,\n    scaleY: 1,\n    inlay: false,\n    animated :\n    {\n      time : \n      { \n        active: true, \n        speed: -0.0015, \n        animType: \"move\" \n      }\n    }\n}];\n\nfor (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters();\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"LucYolRQcwi9jgDX"}
{"name":"32 - T01 - Solar Ripples (ripples) 陽炎","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params = \n[{\n    filterType: \"ripples\",\n    filterId: \"SolarRipples\",\n    color: 0xCC9000,\n    time: 0,\n    alphaDiscard: false,\n    animated :\n    {\n      time : \n      { \n        active: true, \n        speed: 0.0009, \n        animType: \"move\" \n      }\n    }\n}]\nfor (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters();\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"MJKJAVvyOG1xkqZ5"}
{"name":"30 - T01 - Simple Web (web) 蜘蛛網(細)","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params = \n[{\n    filterType: \"web\",\n    filterId: \"simpleweb\",\n    time: 100,\n    div1: 20,\n    div2: 10,\n    animated :\n    {\n      time : \n      { \n        active: true, \n        speed: 0.0005, \n        animType: \"move\" \n      }\n    }\n}]\nfor (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters();\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"MnsH5FzqsNrFWFDR"}
{"name":"32 - T02 - Devoured by the Bewitched Flames (ripples+glow) 異火吞噬","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params = \n[{\n    filterType: \"ripples\",\n    filterId: \"SolarRipples\",\n    color: 0x508000,\n    time: 0,\n    alphaDiscard: true,\n    zOrder:50,\n    animated :\n    {\n      time : \n      { \n        active: true, \n        speed: 0.0009, \n        animType: \"move\" \n      }\n    }\n},\n{\n    filterType: \"glow\",\n    filterId: \"glowripples\",\n    outerStrength: 2,\n    innerStrength: 1,\n    color: 0xFF3000,\n    quality: 0.5,\n    padding: 10,\n    zOrder: 100,\n    animated:\n    {\n        color: \n        {\n           active: true, \n           loopDuration: 3000, \n           animType: \"colorOscillation\", \n           val1:0xFF3000, \n           val2:0x30FF00\n        }\n    }\n}]\nfor (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters();\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"MpBUrtxRZl0EainC"}
{"name":"07 - Distortion (扭曲/水下)","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"// you can change the mask of the filter\n// the mask must have a power of 2 h and w (512x512, 128x128, ...) \n// the distortion applies on black and white and shades of grey\n// after testing the first version of this macro try this :\n// -> maskPath: \"/modules/tokenmagic/fx/assets/waves-2.png\"\n\n//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\n\nlet params =\n[{\n    filterType: \"distortion\",\n    filterId: \"myDistortion\",\n    maskPath: \"/modules/tokenmagic/fx/assets/distortion-1.png\",\n    maskSpriteScaleX: 5,\n    maskSpriteScaleY: 5,\n    padding: 20,\n    animated:\n    {\n        maskSpriteX: { active: true, speed: 0.05, animType: \"move\" },\n        maskSpriteY: { active: true, speed: 0.07, animType: \"move\" }\n    }\n}];\n\n    for (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters(params[0][\"filterId\"]);\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"MykfS3OkmniBviaD"}
{"name":"箭矢動畫","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"core":{"sourceId":"Macro.68CDpJv8wdDdnGI6"},"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_aet7bgv1idl","path":"Private Compendium#/CF_SEP/動畫效果","color":"#000000"}},"scope":"global","command":"//This macro plays the animation on selected targets with a trajectory and distances of 30ft, 60ft and 90ft\n//It works for animations like Scorching Ray, Fire Bolt, Arrow, Boulder Toss, Siege Projectile that use these distances\n//Import this macro, duplicate it and change its name making sure it's unique by adding the colour (i.e. \"Ray Of Frost Blue\").\n//If it has the exact same name as the spell or item you want to trigger it from, you'll encounter an issue.\n\n//folder 01 is the directory path to the assets\n// let folder01 = \"modules/JB2A_DnD5e/Library/2nd_Level/Scorching_Ray/\";\n//anFile30 points to the file corresponding to 30ft, anFile60 for 60ft and anFile90 for 90ft\n// let anFile30 = `${folder01}ScorchingRay_01_Orange_30ft_1600x400.webm`;\n// let anFile60 = `${folder01}ScorchingRay_01_Orange_60ft_2800x400.webm`;\n// let anFile90 = `${folder01}ScorchingRay_01_Orange_90ft_4000x400.webm`;\n\n//How this macro is set up for Fire Bolt\nlet folder01 = \"modules/JB2A_DnD5e/Library/Generic/Weapon_Attacks/Ranged/\";\nlet anFile30 = `${folder01}Arrow_Simple_01_30ft_1600x400.webm`;\nlet anFile60 = `${folder01}Arrow_Simple_01_60ft_2800x400.webm`;\nlet anFile90 = `${folder01}Arrow_Simple_01_90ft_4000x400.webm`;\n\n\nif(game.user.targets.size == 0) ui.notifications.error('請至少選取一個目標');\nif(canvas.tokens.controlled.length == 0) ui.notifications.error(\"請選取你的Token\");\n///Check if Module dependencies are installed or returns an error to the user\nif (!canvas.fxmaster) ui.notifications.error(\"This macro depends on the FXMaster module. Make sure it is installed and enabled\");\n\nconst wait = (delay) => new Promise((resolve) => setTimeout(resolve, delay))\n\nasync function Cast() {\nvar myStringArray = Array.from(game.user.targets)[0];\nvar arrayLength = game.user.targets.size;\nfor (var i = 0; i < arrayLength; i++) {\n\nlet mainTarget = Array.from(game.user.targets)[i];\nlet myToken = canvas.tokens.controlled [0];\n\nlet ray = new Ray(myToken.center, mainTarget.center);\nlet anDeg = -(ray.angle * 57.3);\nlet anDist = ray.distance;\n\n\nlet anFile = anFile30;\nlet anFileSize = 1200;\nlet anchorX = 0.125;\nswitch(true){\n case (anDist<=1200):\n    anFileSize = 1200;\n    anFile = anFile30;\n    anchorX = 0.125;\n    break;\n case (anDist>2400):\n    anFileSize = 3600;\n    anFile = anFile90;\n    anchorX = 0.05;\n    break;\n default:\n    anFileSize = 2400;\n    anFile = anFile60;\n    anchorX = 0.071;\n    break;\n}\n\nlet anScale = anDist / anFileSize;\nlet anScaleY = anDist <= 600 ? 0.6  : anScale;\n\nlet spellAnim = \n                    {\n                     file: anFile,\n                      position: myToken.center,\n                      anchor: {\n                       x: anchorX,\n                       y: 0.5\n                      },\n                      angle: anDeg,\n                      scale: {\n                       x: anScale,\n                       y: anScaleY\n                      }\n                    }; \n\ncanvas.fxmaster.playVideo(spellAnim);\ngame.socket.emit('module.fxmaster', spellAnim);\nawait wait (250);\n}\n}\nCast ()","author":"uDAdlkna037LVJd3","img":"https://assets.forge-vtt.com/bazaar/modules/JB2A_DnD5e/assets/Library/Generic/Weapon_Attacks/Ranged/Arrow_Simple_01_Thumb.webp","actorIds":[],"_id":"N5x42knUTPZAaEDC"}
{"name":"22 - Smoke (煙燻)","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params =\n[{\n    filterType: \"smoke\",\n    filterId: \"mySmoke\",\n    color: 0x050505,\n    time: 0,\n    blend: 2,\n    dimX: 1,\n    dimY: 1,\n    animated :\n    {\n      time : \n      { \n        active: true, \n        speed: 0.0015, \n        animType: \"move\"\n      }\n    }\n}];\n for (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters(params[0][\"filterId\"]);\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"N6svxJsGysTYdU9Q"}
{"name":"聖療Macro","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":true},"core":{"sourceId":"Macro.jy7zlw8utzdqEkat"},"cf":{"id":"temp_u8moge7sbaa","path":"Private Compendium#/CF_SEP/法術效果Macro","color":"#000000"}},"scope":"global","command":"/**\n * System: D&D5e\n * Apply lay-on-hands feat to a target character.  Asks the player how many HP to heal and\n * verifies the entered value is within range before marking down usage counter. If the player\n * has OWNER permissions of target (such as GM or self-heal) the HP are applied automatically; \n * otherwise, a 'roll' message appears allowing the target character to right-click to apply healing.\n */\n\nlet confirmed = false;\nlet actorData = actor || canvas.tokens.controlled[0] || game.user.character;\nlet featData = actorData ? actorData.items.find(i => i.name===\"聖療 Lay on Hands\") : null;\n\nif(actorData == null || featData == null) \n    ui.notifications.warn(`你為並未習得【聖療 Lay on Hands技能】`);\nelse if (game.user.targets.size !== 1)\n    ui.notifications.warn(`請選擇施法目標`);\nelse\n{\n    let featUpdate = duplicate(featData);\n    let targetActor = game.user.targets.values().next().value.actor;\n    let maxHeal = Math.clamped(featUpdate.data.uses.value, 0, \n        targetActor.data.data.attributes.hp.max - targetActor.data.data.attributes.hp.value);\n\n    let content = `<p><b>【${actorData.name}】對【${targetActor.data.name}】施展聖療.</b></p>\n                    <p>你希望恢復多少HP?</p>\n                    <form>\n                        <div class=\"form-group\">\n                            <label for=\"num\">HP恢復量(完全回滿需= ${maxHeal}點):</label>\n                            <input id=\"num\" name=\"num\" type=\"number\" min=\"0\" max=\"${maxHeal}\"></input>\n                        </div>\n                        <div class=\"form-group\">\n                            <label for=\"flavor\">Flavor:</label>\n                            <input id=\"flavor\" name=\"flavor\" value=\"${featUpdate.data.chatFlavor}\"></input>\n                        </div>\n                    </form>`;\n    new Dialog({\n        title: \"聖療 Lay on Hands\",\n        content: content,      \n        buttons: {\n            heal: { label: \"治癒!\", callback: () => confirmed = true },\n            cancel: { label: \"取消施法\", callback: () => confirmed = false }\n        },\n        default: \"heal\",\n\n        close: html => {\n            if (confirmed) \n            {\n                let number = Math.floor(Number(html.find('#num')[0].value));\n                if (number < 1 || number > maxHeal)\n                    ui.notifications.warn(`輸入數值無效，施法中斷。`);\n                else\n                {\n                    let flavor = `<strong>${html.find('#flavor')[0].value}</strong><br>`;\n                    if (targetActor.permission !== CONST.ENTITY_PERMISSIONS.OWNER)\n                        // We need help applying the healing, so make a roll message for right-click convenience.\n                        new Roll(`${number}`).roll().toMessage({\n                            speaker: ChatMessage.getSpeaker(),\n                            flavor: `【${actorData.name}】對【${targetActor.data.name}】施展聖療.<br>${flavor}\n                            <p><em>回覆HP ${number} 點` });\n                    else {\n                        // We can apply healing automatically, so just show a normal chat message.\n                        ChatMessage.create({\n                            speaker: ChatMessage.getSpeaker(),\n                            content: `【${actorData.name}】對【${targetActor.data.name}】施展聖療，恢復HP ${number} 點.<br>${flavor}`\n                        });\n                        targetActor.update({\"data.attributes.hp.value\" : targetActor.data.data.attributes.hp.value + number});\n                    }\n\n                    featUpdate.data.uses.value = featUpdate.data.uses.value - number;\n                    actorData.updateEmbeddedEntity(\"OwnedItem\", featUpdate);\n                };\n            }\n        }\n    }).render(true);\n}","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"NIYDzrefc0SH7l9N"}
{"name":"A - Multi-Filters Example","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"let params =\n[{\n    filterType: \"fog\",\n    color: 0x00FF50,\n    density: 0.20,\n    time: 0,\n    animated :\n    {\n      time : \n      { \n        active: true, \n        speed: 1.2, \n        animType: \"move\" \n      }\n    }\n},\n{\n    filterType: \"ray\",\n    time: 0,\n    color: 0x00DE50,\n    alpha: 0.25,\n    divisor: 32,\n    anchorY: 0,\n    animated :\n    {\n       time : \n       { \n          active: true, \n          speed: 0.0005, \n          animType: \"move\" \n       }\n    }\n},\n{\n    filterType: \"glow\",\n    distance: 10,\n    outerStrength: 8,\n    innerStrength: 0,\n    color: 0x003000,\n    quality: 0.5,\n    padding: 10,\n    animated:\n    {\n        color: \n        {\n           active: true, \n           loopDuration: 3000, \n           animType: \"colorOscillation\", \n           val1:0x003000, \n           val2:0x00EF00\n        }\n    }\n}\n];\n\nTokenMagic.addFiltersOnSelected(params);","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"Nh41Pg53p9I1HuBz"}
{"name":"29 - T01 - Foul Fog (xfog) 不詳霧","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params = \n[{\n    filterType: \"xfog\",\n    filterId: \"foulfog\",\n    color: 0xFFFFFF,\n    time: 0,\n    animated:\n        {\n            time:\n            {\n                active: true,\n                speed: 0.0005,\n                animType: \"move\"\n            }\n        }\n}]\n  for (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters();\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"OYwjdOLwudbmlx6S"}
{"name":"13 - Shockwave (wave)","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"furnace":{"runAsGM":false},"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"// Below, you can turn on the anchor animation.\n//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params =\n[{\n    filterType: \"wave\",\n    filterId: \"myShockwave\",\n    time: 0,\n    strength: 0.03,\n    frequency: 15,\n    maxIntensity: 4.0,\n    minIntensity: 0.5,\n    padding:25,\n    animated :\n    {\n      time : \n      { \n        active: true, \n        speed: 0.0180,\n        animType: \"move\",\n      }\n    }\n}];\n\n    for (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters(params[0][\"filterId\"]);\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"OsCLoh7ZXz07x2jd"}
{"name":"醒目標示","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"let TokenFXFunction = async function () {\nlet params = \n[{\n    filterType: \"glow\",\n    filterId: \"superSpookyGlow\",\n    outerStrength: 4,\n    innerStrength: 0,\n    color: 0x5099DD,\n    quality: 0.5,\n    padding: 10,\n    animated:\n    {\n        color: \n        {\n           active: true, \n           loopDuration: 3000, \n           animType: \"colorOscillation\", \n           val1:0x5099DD, \n           val2:0x90EEFF\n        }\n    }\n},\n{\n        filterType: \"transform\",\n        filterId: \"myBulgeTransform\",\n        bpRadiusPercent: 40,\n        padding: 100,\n        animated:\n        {\n            bpStrength:\n            {\n                animType: \"cosOscillation\",\n                val1: 0,\n                val2: 0.2,\n                loopDuration: 3500,\n            }\n        }\n    }];\n\n for (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters();\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"https://assets.forge-vtt.com/5fbe5ec1f959b5dea569b164/uploaded-chat-images/1xwv3354qlr8oto5o67wt6.png","actorIds":[],"_id":"PHp46KgO3hMfh5QV"}
{"name":"爪擊動畫","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false},"cf":{"id":"temp_aet7bgv1idl","path":"Private Compendium#/CF_SEP/動畫效果","color":"#000000"}},"scope":"global","command":"//This macro plays the animation on selected targets with no trajectory\n//It works for animations like Cure Wounds, Healing Ability and Dizzy Stars \n//Import this macro, duplicate it and change its name making sure it's unique by adding the colour (i.e. \"Cure Wounds Blue\").\n//If it has the exact same name as the spell or item you want to trigger it from, you'll encounter an issue.\n//folder 01 is the directory path to the assets\nlet folder01 = \"worlds/DamnAdventurers/Special%20Effect/\";\n//anFile is the name of the file used for the animation\nlet anFile = `${folder01}CLAW.webm`;\n\n//another example would be:\n//let folder01 = \"modules/JB2A_DnD5e/Library/Generic/Healing/\"\n//let anFile = `${folder01}HealingAbility_01_Green_200x200.webm`;\n\nconst wait = (delay) => new Promise((resolve) => setTimeout(resolve, delay))\n\nasync function Cast() {\nvar myStringArray = Array.from(game.user.targets)[0];\nvar arrayLength = game.user.targets.size;\nfor (var i = 0; i < arrayLength; i++) {\n\nlet mainTarget = Array.from(game.user.targets)[i];\nlet tarScale = ((mainTarget.data.width + mainTarget.data.height)/2);\n\n\nlet spellAnim = \n                    {\n                     file: anFile,\n                      position: mainTarget.center,\n                      anchor: {\n                       x: 0.5,\n                       y: 0.5\n                      },\n                      angle: 0,\n                      scale: {\n                       x: 0.6,\n                       y: 0.6\n                      }\n                    }; \ncanvas.fxmaster.playVideo(spellAnim);\ngame.socket.emit('module.fxmaster', spellAnim);\nawait wait (75);\n}\n}\nCast ()","author":"uDAdlkna037LVJd3","img":"https://assets.forge-vtt.com/5fbe5ec1f959b5dea569b164/uploaded-chat-images/gryd0pms2o78j064h5e6aa.png","actorIds":[],"_id":"PcvZD6eZ3KQePYgf"}
{"name":"33 - T03 - Dodge Jump (transform) 彈跳","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"furnace":{"runAsGM":false},"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params =\n    [{\n        filterType: \"transform\",\n        filterId: \"jumpedDodge\",\n        autoDestroy: true,\n        padding: 80,\n        animated:\n        {\n            translationY:\n            {\n                animType: \"cosOscillation\",\n                val1: 0,\n                val2: -0.225,\n                loops: 1,\n                loopDuration: 900\n            },\n            scaleY:\n            {\n                animType: \"cosOscillation\",\n                val1: 1,\n                val2: 0.65,\n                loops: 2,\n                loopDuration: 450,\n            },\n            scaleX:\n            {\n                animType: \"cosOscillation\",\n                val1: 1,\n                val2: 0.65,\n                loops: 2,\n                loopDuration: 450,\n            }\n        }\n    }];\nfor (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters();\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"Q946AqvVtOLC2AAO"}
{"name":"24 - T01 - Hexa Force Field 2 (藍色力場球)","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params =\n[{\n    filterType: \"field\",\n    filterId: \"myHexaField\",\n    shieldType: 2,\n    gridPadding: 2,\n    color: 0x00CCDD,\n    time: 0,\n    blend: 2,\n    intensity: 0.95,\n    lightAlpha: 0,\n    lightSize: 0,\n    scale: 0.75,\n    radius: 1,\n    chromatic: false,\n    alphaDiscard: true,\n    zOrder: 5000,\n    animated :\n    {\n      time : \n      { \n        active: true, \n        speed: 0.0015, \n        animType: \"move\" \n      }\n    }\n}];\nfor (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters(params[0][\"filterId\"]);\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"QkluzlAbVREEWKPL"}
{"name":"10 - T02 - Pinch (transform) 引力縮小","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params =\n    [{\n        filterType: \"transform\",\n        filterId: \"myPinchTransform\",\n        bpRadiusPercent: 70,\n        padding: 100,\n        animated:\n        {\n            bpStrength:\n            {\n                animType: \"cosOscillation\",\n                val1: 0,\n                val2: -0.65,\n                loopDuration: 3500,\n            }\n        }\n    }];\n for (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters(params[0][\"filterId\"]);\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"Rkn1rQZEliaX7jGY"}
{"name":"24 - T01 - Hexa Force Field (粉紫色力場球)","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params =\n[{\n    filterType: \"field\",\n    filterId: \"myHexaField\",\n    shieldType: 2,\n    gridPadding: 2,\n    color: 0xCC00CC,\n    time: 0,\n    blend: 3,\n    intensity: 1,\n    lightAlpha: 0.5,\n    lightSize: 0.5,\n    scale: 0.5,\n    radius: 1,\n    chromatic: false,\n    alphaDiscard: true,\n    zOrder: 5000,\n    animated :\n    {\n      time : \n      { \n        active: true, \n        speed: 0.0015, \n        animType: \"move\" \n      }\n    }\n}];\nfor (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters(params[0][\"filterId\"]);\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"S4Fv31stSbg6KNgs"}
{"name":"31 - T02 - Fairy Outline (globes+glow) 仙粉化","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"// works better with non-round forms\n//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params = \n[{\n    filterType: \"globes\",\n    filterId: \"glowingGlobes\",\n    time: 0,\n    color: 0x3080EE,\n    distortion: 0.9,\n    scale: 320,\n    alphaDiscard: true,\n    zOrder: 1,\n    animated :\n    {\n      time : \n      { \n        active: true, \n        speed: 0.0015, \n        animType: \"move\" \n      }\n    }\n},\n{\n    filterType: \"glow\",\n    filterId: \"superSpookyGlow\",\n    outerStrength: 4,\n    innerStrength: 0,\n    color: 0xFF3000,\n    quality: 0.5,\n    padding: 10,\n    animated:\n    {\n        color: \n        {\n           active: true, \n           loopDuration: 3000, \n           animType: \"colorOscillation\", \n           val1:0xFF3000, \n           val2:0x30FF00\n        }\n    }\n}]\nfor (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters();\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"S8Mc8OjH9O2mnivT"}
{"name":"#[CF_tempEntity]","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"chat","flags":{"cf":{"id":"temp_2od1tntv3ht","path":"Private Compendium#/CF_SEP/創造TOKEN","color":"#000000","name":"創造TOKEN","children":["IgC5PBroyrBUOXA0","a4POgaEGlpG6oR6C","xbB3aUKk7s9eq43M"],"folderPath":["temp_5b37tcuw6xw"]}},"scope":"global","command":"","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"SBkQl1fMTfzLMJA8"}
{"name":"英雄宴Macro","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"furnace":{"runAsGM":false},"combat-utility-belt":{"macroTrigger":""},"core":{"sourceId":"Macro.OFmbN8LvQCsDvrrT"},"cf":{"id":"temp_u8moge7sbaa","path":"Private Compendium#/CF_SEP/法術效果Macro","color":"#000000"}},"scope":"global","command":"//DAE Macro Execute, Effect Value = \"Macro Name\" @target \n\n\nlet target = canvas.tokens.get(args[1]);\nlet amount = new Roll(\"2d10\").roll().total;\n/**\n * Update HP and Max HP to roll formula, save result as flag\n */\nif (args[0] === \"on\") {\n        let hpMax = target.actor.data.data.attributes.hp.max;\n        let hp = target.actor.data.data.attributes.hp.value;\n        await target.actor.update({\"data.attributes.hp.max\": (hpMax + amount), \"data.attributes.hp.value\": (hp + amount) });\n        ChatMessage.create({content: `【英雄宴】 ${target.name} 生命值上限提升 ${amount} 點`});\n        await target.actor.setFlag('world', 'HeroesFeast', amount);\n};\n\n// Remove Max Hp and reduce HP to max if needed\nif (args[0] === \"off\") {\n        let amountOff = await target.actor.getFlag('world', 'HeroesFeast');\n        let hpMax = target.actor.data.data.attributes.hp.max;\n        let newHpMax = hpMax - amountOff;\n        await target.actor.update({\"data.attributes.hp.max\": newHpMax });\n        if ( target.actor.data.data.attributes.hp.value > newHpMax ) {\n            await target.actor.update({\"data.attributes.hp.value\": newHpMax });\n        }\n        ChatMessage.create({content: \"【英雄宴】\" + target.name + \"的生命值提升效果結束\"});\n        target.actor.unsetFlag('world', 'HeroesFeast');\n}","author":"uDAdlkna037LVJd3","img":"https://assets.forge-vtt.com/bazaar/systems/dnd5e/assets/icons/spells/heal-royal-3.jpg","actorIds":[],"_id":"TAvwRB90erm95QdU"}
{"name":"24 - T04 - Shell - Moving Ice Disc (藍色晃動盤)","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params =\n[{\n    filterType: \"field\",\n    filterId: \"myIceField\",\n    shieldType: 14,\n    gridPadding: 1.25,\n    color: 0x409090,\n    time: 0,\n    blend: 9,\n    intensity: 1,\n    lightAlpha: 2,\n    lightSize: 1,\n    scale: 1,\n    radius: 0.97,\n    chromatic: false,\n    discardThreshold: 0.2,\n    alphaDiscard: true,\n    animated :\n    {\n      posLightX:\n      {\n        active: true,\n        val1: 0.25,\n        val2: 0.75,\n        animType: \"syncCosOscillation\",\n        loopDuration: 5000\n      },\n      posLightY:\n      {\n        active: true,\n        val1: 0.25,\n        val2: 0.75,\n        animType: \"syncSinOscillation\",\n        loopDuration: 5000\n      },\n      lightSize:\n      {\n        active: true,\n        val1: 0.95,\n        val2: 1.05,\n        animType: \"sinOscillation\",\n        loopDuration: 900\n      }\n    }\n},{\n        filterType: \"xglow\",\n        filterId: \"myIceField\",\n        auraType: 1,\n        color: 0x5099DD,\n        thickness: 4.5,\n        scale: 1,\n        time: 0,\n        auraIntensity: 0.25,\n        subAuraIntensity: 0.25,\n        threshold: 0.1,\n        discard: false,\n        zOrder: 3000,\n        animated:\n        {\n            time:\n            {\n                active: true,\n                speed: 0.0018,\n                animType: \"move\"\n            },\n            thickness:\n            {\n                val1: 2, val2: 2.5,\n                animType: \"cosOscillation\",\n                loopDuration: 3000\n            },\n            subAuraIntensity:\n            {\n                val1: 0.45, val2: 0.65,\n                animType: \"cosOscillation\",\n                loopDuration: 6000\n            },\n            auraIntensity:\n            {\n                val1: 0.9, val2: 2.2,\n                animType: \"cosOscillation\",\n                loopDuration: 3000\n            }\n        }\n    }];\nfor (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters(params[0][\"filterId\"]);\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"TlOqkuTGyUb6V9Pe"}
{"name":"EnlargeReduce","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false},"core":{"sourceId":"Macro.tKKbvoCkf5A37rsc"},"cf":{"id":"temp_u8moge7sbaa","path":"Private Compendium#/CF_SEP/法術效果Macro","color":"#000000"}},"scope":"global","command":"//DAE Macro Execute, Effect Value = \"Macro Name\" @target \n\n/**\n * For each target, the GM will have to choose \n */\nlet target = canvas.tokens.get(args[1]);\nlet originalSize = target.data.width;\nlet mwak = target.actor.data.data.bonuses.mwak.damage;\n\nif (args[0] === \"on\") {\n    new Dialog({\n        title: \"變巨／縮小術 Enlarge/Reduce\",\n        buttons: {\n            one: {\n                label: \"變巨大\",\n                callback: () => {\n                    let bonus = mwak + \" 1d4\";\n                    let enlarge = (originalSize + 1);\n                    target.actor.update({ \"data.bonuses.mwak.damage\": bonus });\n                    target.update({ \"width\": enlarge, \"height\": enlarge });\n                    target.actor.setFlag('world', 'enlageReduceSpell', {\n                        size: originalSize,\n                        ogMwak: mwak,\n                    });\n                    ChatMessage.create({ content: target.name + \" 變大了!\" });\n                }\n            },\n            two: {\n                label: \"縮小小\",\n                callback: () => {\n                    let bonus = mwak + \" -1d4\";\n                    let size = originalSize;\n                    let newSize = (size > 1) ? (size - 1) : (size - 0.3);\n                    target.actor.update({ \"data.bonuses.mwak.damage\": bonus });\n                    target.update({ \"width\": newSize, \"height\": newSize });\n                    target.actor.setFlag('world', 'enlageReduceSpell', {\n                        size: originalSize,\n                        ogMwak: mwak,\n                    });\n                    ChatMessage.create({ content: target.name + \" 變小了!\" });\n                }\n            },\n        }\n    }).render(true);\n}\nif (args[0] === \"off\") {\n    let flag = target.actor.getFlag('world', 'enlageReduceSpell');\n    target.actor.update({ \"data.bonuses.mwak.damage\": flag.ogMwak });\n    target.update({ \"width\": flag.size, \"height\": flag.size });\n    target.actor.unsetFlag('world', 'enlageReduceSpell');\n    ChatMessage.create({ content: target.name + \" 已恢復原尺寸\" });\n}","author":"uDAdlkna037LVJd3","img":"https://assets.forge-vtt.com/bazaar/systems/dnd5e/assets/icons/spells/link-blue-2.jpg","actorIds":[],"_id":"ToLPaqo040kzptc2"}
{"name":"攝心目光Macro","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false},"core":{"sourceId":"Macro.yrTB6zHbr4HwYGnS"},"cf":{"id":"temp_u8moge7sbaa","path":"Private Compendium#/CF_SEP/法術效果Macro","color":"#000000"}},"scope":"global","command":"let target = canvas.tokens.get(args[1]);\nlet ConditionControl = game.macros.getName(\"CUB Condition\");\n\n/**\n * Dialog appears on players screen, CondtionControll callback execute on GM end \n */\n\nfunction EyebiteDialog() {\n    new Dialog({\n        title: \"攝心目光效應\",\n        content: \"<p>請標記一個目標生物，選擇一種效應</p>\",\n        buttons: {\n            one: {\n                label: \"沉睡\",\n                callback: async () => {\n                    for (let target of game.user.targets) {\n                        let { total } = await target.actor.rollAbilitySave(\"wis\");\n                        if (total < args[2]) {\n                            ChatMessage.create({ content: target.name + \" 豁免失敗 \"});\n                            ConditionControl.execute(\"apply\", \"昏迷\", target);\n                        }\n else {\n                            ChatMessage.create({ content: target.name + \" 豁免成功 \" });\n                        }\n                    }\n                }\n            },\n            two: {\n                label: \"驚慌\",\n                callback: async () => {\n                    for (let target of game.user.targets) {\n                        let { total } = await target.actor.rollAbilitySave(\"wis\");\n                        if (total < args[2]) {\n                            ChatMessage.create({ content: target.name + \" 豁免失敗 \"});\n                            ConditionControl.execute(\"apply\", \"恐慌\", target);\n                        }\n else {\n                            ChatMessage.create({ content: target.name + \" 豁免成功 \"  });\n                        }\n                    }\n                }\n            },\n            three: {\n                label: \"患病\",\n                callback: async () => {\n                    for (let target of game.user.targets) {\n                        let { total } = await target.actor.rollAbilitySave(\"wis\");\n                        if (total < args[2]) {\n                            ChatMessage.create({ content: target.name + \" 豁免失敗 \"});\n                            ConditionControl.execute(\"apply\", \"中毒\", target);\n                        }\n else {\n                            ChatMessage.create({ content: target.name + \" 豁免成功 \" });\n                        }\n                    }\n                }\n            },\n        }\n    }).render(true);\n}\n\nif (args[0] === \"on\") {\n    const hookId = Hooks.on(\"updateCombat\", (combat, update) => {\n        if (!(\"round\" in update || \"turn\" in update)) return;\n        if (combat.combatant.tokenId === args[1]) {\n            EyebiteDialog();\n        }\n    });\n    target.actor.setFlag(\"world\", \"EyebiteSpell\", hookId);\n    ChatMessage.create({ content: target.name + \" 獲得【攝心目光Eyebite】\" });\n    EyebiteDialog();\n\n}\n\n//Cleanup hooks and flags.\nif (args[0] === \"off\") {\n    async function off() {\n        ChatMessage.create({ content: \"【攝心目光Eyebite】效應中止\" });\n        let hookIdFlag = await target.actor.getFlag(\"world\", \"EyebiteSpell\");\n        Hooks.off(\"updateCombat\", hookIdFlag);\n    }\n    off();\n    target.actor.unsetFlag(\"world\", \"EyebiteSpell\");\n}","author":"uDAdlkna037LVJd3","img":"https://assets.forge-vtt.com/bazaar/systems/dnd5e/assets/icons/spells/evil-eye-red-3.jpg","actorIds":[],"_id":"TpE24TZTvt4We37E"}
{"name":"00 - A - 刪除所有選取TokenFX","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"// Delete all filters on the selected tokens/tiles\nTokenMagic.deleteFiltersOnSelected();","author":"uDAdlkna037LVJd3","img":"https://assets.forge-vtt.com/5fbe5ec1f959b5dea569b164/worlds/DamnAdventurers/UI/icGear.png","actorIds":[],"_id":"TsHbzNjT2UY0JD1f"}
{"name":"35 - T02 - Chromatic Fire (xfire) 細緻火焰纏身","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params =\n[{\n    filterType: \"xfire\",\n    filterId: \"myChromaticXFire\",\n    time: 0,\n    blend: 2,\n    amplitude: 1.1,\n    dispersion: 0,\n    chromatic: true,\n    scaleX: 1,\n    scaleY: 1,\n    inlay: false,\n    animated :\n    {\n      time : \n      { \n        active: true, \n        speed: -0.0015, \n        animType: \"move\" \n      }\n    }\n}];\nfor (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters();\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"UBeW1Zo5OV7mzXTa"}
{"name":"09 - T02 - Moo Man Dance (transform)","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params =\n    [{\n        filterType: \"transform\",\n        filterId: \"theMooManDance\",\n        twRadiusPercent: 70,\n        bpRadiusPercent: 90,\n        padding: 50,\n        animated:\n        {\n            twRotation:\n            {\n                animType: \"sinOscillation\",\n                val1: -90,\n                val2: +90,\n                loopDuration: 1000,\n            },\n            bpStrength:\n            {\n                animType: \"cosOscillation\",\n                val1: 0,\n                val2: 0.55,\n                loopDuration: 1000,\n            },\n            translationX:\n            {\n                animType: \"sinOscillation\",\n                val1: -0.125,\n                val2: +0.125,\n                loopDuration: 1400,\n            },\n            translationY:\n            {\n                animType: \"cosOscillation\",\n                val1: -0.125,\n                val2: +0.125,\n                loopDuration: 1400,\n            },\n            rotation:\n            {\n                animType: \"cosOscillation\",\n                val1: 90,\n                val2: -90,\n                loopDuration: 4200,\n            },    \n        }\n    }];\n\n    for (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters(params[0][\"filterId\"]);\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"UjdYpndt1NuetXfg"}
{"name":"25 - T01 - Sunburst Rays (xray) (黃色金光)","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params =\n[{\n    filterType: \"xray\",\n    filterId: \"mySunburstRays\",\n    time: 0,\n    color: 0xFFBB00,\n    blend: 9,\n    dimX: 1,\n    dimY: 1,\n    anchorX: 0,\n    anchorY: 0,\n    divisor: 36,\n    intensity: 4,\n    animated :\n    {\n       time : \n       { \n          active: true, \n          speed: 0.0012, \n          animType: \"move\" \n       },\n       anchorX:\n       {\n          animType: \"syncCosOscillation\",\n          loopDuration : 6000,\n          val1: 0.40,\n          val2: 0.60\n       }\n    }\n}];\n for (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters();\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"UoFeXp7QUkKsbyuM"}
{"name":"巫術箭動畫","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"core":{"sourceId":"Macro.ve9ZzNtZTztRpYpd"},"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false},"cf":{"id":"temp_aet7bgv1idl","path":"Private Compendium#/CF_SEP/動畫效果","color":"#000000"}},"scope":"global","command":"//This macro plays the animation on selected targets with a trajectory and distance of 30ft\n//It works for Laser Shots\n//Import this macro, duplicate it and change its name making sure it's unique by adding the colour (i.e. \"Laser Shot Blue\").\n//folder 01 is the directory path to the assets\nlet folder01 = \"modules/JB2A_DnD5e/Library/1st_Level/Witch_Bolt/\";\n// anFile30 is the file used. Here we only have 30ft\nlet anFile30 = `${folder01}WitchBolt_01_Regular_Blue_30ft_1600x400.webm`;\n\nif(game.user.targets.size == 0) ui.notifications.error('請至少選擇一個目標');\nif(canvas.tokens.controlled.length == 0) ui.notifications.error(\"請選取施法者\");\n///Check if Module dependencies are installed or returns an error to the user\nif (!canvas.fxmaster) ui.notifications.error(\"使用此Macro需要啟動FXMaster\");\n\n\n\nconst wait = (delay) => new Promise((resolve) => setTimeout(resolve, delay))\n\nasync function Cast() {\nvar myStringArray = Array.from(game.user.targets)[0];\nvar arrayLength = game.user.targets.size;\nfor (var i = 0; i < arrayLength; i++) {\n\nlet mainTarget = Array.from(game.user.targets)[i];\nlet myToken = canvas.tokens.controlled [0];\n\nlet ray = new Ray(myToken.center, mainTarget.center);\nlet anDeg = -(ray.angle * 57.3);\nlet anDist = ray.distance;\n\nlet anchorX = 0.125;\nlet anFile = anFile30;\nlet anFileSize = 1200;\n\n\n\nlet anScale = anDist / anFileSize;\nlet anScaleY = anDist <= 200 ? 0.66  : anScale;\n\nlet spellAnim = \n                    {\n                     file: anFile,\n                      position: myToken.center,\n                      anchor: {\n                       x: anchorX,\n                       y: 0.5\n                      },\n                      angle: anDeg,\n                      scale: {\n                       x: anScale,\n                       y: anScaleY\n                      }\n                    }; \n\ncanvas.fxmaster.playVideo(spellAnim);\ngame.socket.emit('module.fxmaster', spellAnim);\nawait wait (250);\n}\n}\nCast ()","author":"uDAdlkna037LVJd3","img":"https://assets.forge-vtt.com/bazaar/modules/JB2A_DnD5e/assets/Library/1st_Level/Witch_Bolt/WitchBolt_01_Regular_Blue_Thumb.webp","actorIds":[],"_id":"ViAcuvEsJRiaUp1X"}
{"name":"26 - T03 - Drift in Plans (liquid+waves) 奇異感濾鏡","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"furnace":{"runAsGM":false},"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params =\n[{\n    filterType: \"wave\",\n    filterId: \"myDriftWaves\",\n    time: 0,\n    anchorX: 0.5,\n    anchorY: 0.5,\n    strength: 0.035,\n    frequency: 20,\n    color: 0xFFFFFF,\n    maxIntensity: 1.5,\n    minIntensity: 0.5,\n    padding:10,\n    animated :\n    {\n      time : \n      { \n        active: true, \n        speed: 0.0085, \n        animType: \"move\" \n      },\n      anchorX :\n      {\n        active: true,\n        val1: 0.35,\n        val2: 0.65,\n        animType: \"syncCosOscillation\",\n        loopDuration: 10000\n      },\n      anchorY :\n      {\n        active: true,\n        val1: 0.35,\n        val2: 0.65,\n        animType: \"syncSinOscillation\",\n        loopDuration: 10000\n      }\n    }\n},\n{\n    filterType: \"liquid\",\n    filterId: \"myDriftLiquid\",\n    color: 0xFF0000,\n    time: 0,\n    blend: 6,\n    intensity: 5,\n    spectral: false,\n    scale: 2.5,\n    animated :\n    {\n       time : \n       { \n          active: true, \n          speed: 0.0018, \n          animType: \"move\" \n       },\n       color: \n       {\n          active: true, \n          loopDuration: 9000, \n          animType: \"colorOscillation\", \n          val1:0xFF0000, \n          val2:0xFFFFFF\n       }\n    }\n}];\nfor (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters();\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"Vmmj6hvNvvbPLv0p"}
{"name":"27 - T05 - Pure Fire v2 (xglow+fire) 火焰纏身2","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"// In this version, the glow is blending with the fire\n// This is to show that the order of the filters is important\n\n//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params =\n[{\n    filterType: \"zapshadow\",\n    filterId: \"myPureFireShadow\",\n    alphaTolerance: 0.50\n},\n{\n    filterType: \"xglow\",\n    filterId: \"myPureFireAura\",\n    auraType: 2,\n    color: 0x903010,\n    thickness: 9.8,\n    scale: 3.,\n    time: 0,\n    auraIntensity: 1,\n    subAuraIntensity: 0.3,\n    threshold: 0.25,\n    discard: true,\n    animated:\n    {\n        time : \n        {  \n           active: true,\n           speed: 0.0027, \n           animType: \"move\" \n        },\n        thickness:\n        {\n           active: true,\n           loopDuration: 3000, \n           animType: \"cosOscillation\", \n           val1:2, \n           val2:3.6\n        }\n    }\n},\n{\n    filterType: \"fire\",\n    filterId: \"myPureFire\",\n    intensity: 1,\n    color: 0xFFFFFF,\n    amplitude: 1,\n    time: 0,\n    blend: 2,\n    fireBlend : 1,\n    animated :\n    {\n      time : \n      { \n        active: true, \n        speed: -0.0024, \n        animType: \"move\" \n      },\n      intensity:\n      {\n        active:true,\n        loopDuration: 15000,\n        val1: 0.8,\n        val2: 3,\n        animType: \"syncCosOscillation\"\n      },\n      amplitude:\n      {\n        active:true,\n        loopDuration: 4400,\n        val1: 1,\n        val2: 1.6,\n        animType: \"syncCosOscillation\"\n      }\n      \n    }\n}];\nfor (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters();\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"VnXsusYrYTCxt92a"}
{"name":"#[CF_tempEntity]","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"chat","flags":{"cf":{"id":"temp_5b37tcuw6xw","path":"Private Compendium","color":"#000000","name":"Private Compendium","children":[],"folderPath":[]}},"scope":"global","command":"","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"ZirNrooXBc38C2mW"}
{"name":"24 - T11 - Grid Force Field 2 - Chromatic (透明網格力場)","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"core":{"sourceId":"Macro.3cAW4Jy8eXV4IvlZ"},"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params =\n[{\n    filterType: \"field\",\n    filterId: \"myGridField\",\n    shieldType: 11,\n    gridPadding: 2,\n    color: 0xC1C1C1,\n    time: 0,\n    blend: 2,\n    intensity: 1,\n    lightAlpha: 0,\n    lightSize: 0.3,\n    scale: 0.5,\n    radius: 1,\n    chromatic: true,\n    alphaDiscard: true,\n    discardThreshold: 0.3,\n    zOrder: 512,\n    animated :\n    {\n      time : \n      { \n        active: true, \n        speed: 0.0009, \n        animType: \"move\" \n      }\n    }\n}];\nfor (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters();\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"ZyYgO54Sh93rR87w"}
{"name":"創造火球/篝火","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"core":{"sourceId":"Macro.wH1oxGvmKdTAvy06"},"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_2od1tntv3ht","path":"Private Compendium#/CF_SEP/創造TOKEN","color":"#000000"}},"scope":"global","command":"let d = new Dialog({\n  title: \"創造火球/篝火\",\n  content: \"<p>火球已經新增到腳色清單，請將它拖曳到地圖上使用。\",\n  buttons: {\n      one: {\n       icon: '<i class=\"fas fa-check\"></i>',\n       label: \"OK\",\n       //callback: () => console.log(\"Chose One\")\n      },\n    \n  },\n});\nd.render(true);\n\n(async ()=>{\n    let testFolder = game.folders.find(f => f.name === \"創造火球/篝火\" && f.type === \"Actor\");\n    if(!testFolder) testFolder = await Folder.create({ name : `創造火球/篝火`, type : `Actor`, parent : null });\n  \n    await Actor.create({\n      name: \"火球/篝火\",\n      type: \"npc\",\n      img: \"modules/JB2A_DnD5e/Library/2nd_Level/Flaming_Sphere/FlamingSphere_01_Orange_Thumb.webp\",\n      folder: testFolder.id,\n      sort: 12000,\n      token: { img: \"modules/JB2A_DnD5e/Library/2nd_Level/Flaming_Sphere/FlamingSphere_01_Orange_200x200.webm\", scale:0.3},\n\"token.scale.ratio\": 0.3,      \n      \"token.vision\": true,\n      \"token.disposition\": 0.5,\n      \"token.dimLight\": 40,\n      \"token.brightLight\": 20,\n      \"token.lightAnimation\":{type: \"torch\", speed: 10, intensity: 1},\n      \"token.lightColor\": \"#ffde85\",\n      \"token.lightAlpha\": 0.09,\n    })\n  })();","author":"uDAdlkna037LVJd3","img":"https://assets.forge-vtt.com/bazaar/modules/JB2A_DnD5e/assets/Library/2nd_Level/Flaming_Sphere/FlamingSphere_01_Orange_Thumb.webp","actorIds":[],"_id":"a4POgaEGlpG6oR6C"}
{"name":"24 - T09 - Water Defense 2 - Ring (水護盾2)","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params =\n[{\n    filterType: \"field\",\n    filterId: \"myWaterField\",\n    shieldType: 9,\n    gridPadding: 1.2,\n    color: 0x20BBEE,\n    time: 0,\n    blend: 4,\n    intensity: 1,\n    lightAlpha: 0.7,\n    lightSize: 0.5,\n    scale: 0.6,\n    radius: 1,\n    chromatic: false,\n    hideRadius: 0.8,\n    animated :\n    {\n      time : \n      { \n        active: true, \n        speed: 0.0015, \n        animType: \"move\" \n      },\n      radius: \n       {\n          active: true, \n          loopDuration: 6000, \n          animType: \"cosOscillation\", \n          val1:1, \n          val2:0.8\n       },\n      hideRadius: \n       {\n          active: true, \n          loopDuration: 3000, \n          animType: \"cosOscillation\", \n          val1:0.6, \n          val2:0\n       }\n    }\n},{\n    filterType: \"liquid\",\n    filterId: \"myDriftLiquid\",\n    color: 0x002040,\n    time: 0,\n    blend: 4,\n    intensity: 4,\n    spectral: false,\n    scale: 1.5,\n    zOrder: 3000,\n    animated :\n    {\n       time : \n       { \n          active: true, \n          speed: 0.0018, \n          animType: \"move\" \n       }\n    }\n}];\n for (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters();\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"a9LADBP6Y3fOtxku"}
{"name":"綠彈動畫","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"core":{"sourceId":"Macro.68CDpJv8wdDdnGI6"},"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false},"cf":{"id":"temp_aet7bgv1idl","path":"Private Compendium#/CF_SEP/動畫效果","color":"#000000"}},"scope":"global","command":"//This macro plays the animation on selected targets with a trajectory and distances of 30ft, 60ft and 90ft\n//It works for animations like Scorching Ray, Fire Bolt, Arrow, Boulder Toss, Siege Projectile that use these distances\n//Import this macro, duplicate it and change its name making sure it's unique by adding the colour (i.e. \"Ray Of Frost Blue\").\n//If it has the exact same name as the spell or item you want to trigger it from, you'll encounter an issue.\n\n//folder 01 is the directory path to the assets\n// let folder01 = \"modules/JB2A_DnD5e/Library/2nd_Level/Scorching_Ray/\";\n//anFile30 points to the file corresponding to 30ft, anFile60 for 60ft and anFile90 for 90ft\n// let anFile30 = `${folder01}ScorchingRay_01_Orange_30ft_1600x400.webm`;\n// let anFile60 = `${folder01}ScorchingRay_01_Orange_60ft_2800x400.webm`;\n// let anFile90 = `${folder01}ScorchingRay_01_Orange_90ft_4000x400.webm`;\n\n//How this macro is set up for Fire Bolt\nlet folder01 = \"modules/JB2A_DnD5e/Library/Generic/Weapon_Attacks/Ranged/\";\nlet anFile30 = `${folder01}LazerShot_01_Green_30ft_1600x400.webm`;\nlet anFile60 = `${folder01}LazerShot_01_Green_30ft_1600x400.webm`;\nlet anFile90 = `${folder01}LazerShot_01_Green_30ft_1600x400.webm`;\n\n\nif(game.user.targets.size == 0) ui.notifications.error('請至少選取一個目標');\nif(canvas.tokens.controlled.length == 0) ui.notifications.error(\"請選取你的Token\");\n///Check if Module dependencies are installed or returns an error to the user\nif (!canvas.fxmaster) ui.notifications.error(\"這個Marco需要搭配FXMaster module使用，請確保它功能啟動\");\n\nconst wait = (delay) => new Promise((resolve) => setTimeout(resolve, delay))\n\nasync function Cast() {\nvar myStringArray = Array.from(game.user.targets)[0];\nvar arrayLength = game.user.targets.size;\nfor (var i = 0; i < arrayLength; i++) {\n\nlet mainTarget = Array.from(game.user.targets)[i];\nlet myToken = canvas.tokens.controlled [0];\n\nlet ray = new Ray(myToken.center, mainTarget.center);\nlet anDeg = -(ray.angle * 57.3);\nlet anDist = ray.distance;\n\n\nlet anFile = anFile30;\nlet anFileSize = 1200;\nlet anchorX = 0.125;\nswitch(true){\n case (anDist<=1200):\n    anFileSize = 1200;\n    anFile = anFile30;\n    anchorX = 0.125;\n    break;\n case (anDist>2400):\n    anFileSize = 3600;\n    anFile = anFile90;\n    anchorX = 0.05;\n    break;\n default:\n    anFileSize = 2400;\n    anFile = anFile60;\n    anchorX = 0.071;\n    break;\n}\n\nlet anScale = anDist / anFileSize;\nlet anScaleY = anDist <= 600 ? 0.6  : anScale;\n\nlet spellAnim = \n                    {\n                     file: anFile,\n                      position: myToken.center,\n                      anchor: {\n                       x: anchorX,\n                       y: 0.5\n                      },\n                      angle: anDeg,\n                      scale: {\n                       x: anScale,\n                       y: anScaleY\n                      }\n                    }; \n\ncanvas.fxmaster.playVideo(spellAnim);\ngame.socket.emit('module.fxmaster', spellAnim);\nawait wait (250);\n}\n}\nCast ()","author":"uDAdlkna037LVJd3","img":"https://assets.forge-vtt.com/bazaar/modules/JB2A_DnD5e/assets/Library/Generic/Weapon_Attacks/Ranged/LazerShot_01_Green_Thumb.webp","actorIds":[],"_id":"ai4puw7ED4bkdN9j"}
{"name":"23 - T03 - Spectral Images (移形換影)","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"// Another extreme example...\n//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params =\n[{\n    filterType: \"images\",\n    filterId: \"mySpectralImages\",\n    time: 0, \n    blend: 4,\n    nbImage: 4, \n    padding: 0,\n    alphaImg: 0.5, \n    alphaChr: 0.0,\n    ampX: 0.10, \n    ampY: 0.10,\n    zOrder: 20,\n    animated :\n    {\n      time: \n      { \n        speed: 0.0010, \n        animType: \"move\" \n      },\n      ampX:\n      {\n        val1: 0, val2: 0.22,\n        animType: \"syncCosOscillation\",\n        loopDuration: 2500\n      },\n      ampY:\n      {\n        val1: 0, val2: 0.28,\n        animType: \"syncCosOscillation\",\n        loopDuration: 2500,\n      },\n      alphaChr:        \n      {\n        val1: 1, val2: 0,\n        animType: \"syncCosOscillation\",\n        loopDuration: 2500\n      },\n      alphaImg:        \n      {\n        val1: 0.2, val2: 0.8,\n        animType: \"syncSinOscillation\",\n        loopDuration: 2500\n      }\n    }\n}];\n for (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters(params[0][\"filterId\"]);\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"bEL9WRAcVuFPnSiz"}
{"name":"12 - Zoom Blur (末梢模糊)","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params =\n[{\n    filterType: \"zoomblur\",\n    filterId: \"myZoomBlur\",\n    strength: 0.15,\n    innerRadiusPercent: 65,\n    radiusPercent: 100,\n    padding: 30,\n    animated:\n    {\n        innerRadiusPercent: \n        { \n           active: true, \n           animType: \"sinOscillation\", \n           loopDuration: 500, \n           val1: 65, \n           val2: 75\n        }\n    }\n}];\n\n    for (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters(params[0][\"filterId\"]);\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"bQDyaCOcS5eL1OfQ"}
{"name":"#[CF_tempEntity]","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"chat","flags":{"cf":{"id":"temp_3cf00lo747r","path":"Private Compendium#/CF_SEP/GM用","color":"#000000","name":"GM用","children":["gQOIAHm2HG4DLWO7","GYwa5Q7PtoUsONjT","teibn5fpycCIPyGT"],"folderPath":["temp_5b37tcuw6xw"]}},"scope":"global","command":"","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"cELPAoMIWdiB3dwu"}
{"name":"物理命中","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"core":{"sourceId":"Macro.B14ZptISDhdxLYtd"},"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false},"cf":{"id":"temp_aet7bgv1idl","path":"Private Compendium#/CF_SEP/動畫效果","color":"#000000"}},"scope":"global","command":"//This macro plays the animation on selected targets with no trajectory\n//It works for animations like Cure Wounds, Healing Ability and Dizzy Stars \n//Import this macro, duplicate it and change its name making sure it's unique by adding the colour (i.e. \"Cure Wounds Blue\").\n//If it has the exact same name as the spell or item you want to trigger it from, you'll encounter an issue.\n//folder 01 is the directory path to the assets\nlet folder01 = \"worlds/DamnAdventurers/Special%20Effect/\";\n//anFile is the name of the file used for the animation\nlet anFile = `${folder01}Hit.webm`;\n\n\n//another example would be:\n//let folder01 = \"modules/JB2A_DnD5e/Library/Generic/Healing/\"\n//let anFile = `${folder01}HealingAbility_01_Green_200x200.webm`;\n\n\nconst wait = (delay) => new Promise((resolve) => setTimeout(resolve, delay))\n\nasync function Cast() {\nvar myStringArray = Array.from(game.user.targets)[0];\nvar arrayLength = game.user.targets.size;\nfor (var i = 0; i < arrayLength; i++) {\n\nlet mainTarget = Array.from(game.user.targets)[i];\nlet tarScale = ((mainTarget.data.width + mainTarget.data.height)/2);\n\n\nlet spellAnim = \n                    {\n                     file: anFile,\n                      position: mainTarget.center,\n                      anchor: {\n                       x: 0.5,\n                       y: 0.5\n                      },\n                      angle: 0,\n                      scale: {\n                       x: 1,\n                       y: 1\n                      }\n                    }; \ncanvas.fxmaster.playVideo(spellAnim);\ngame.socket.emit('module.fxmaster', spellAnim);\nawait wait (75);\n}\n}\nCast ()","author":"uDAdlkna037LVJd3","img":"https://assets.forge-vtt.com/5fbe5ec1f959b5dea569b164/uploaded-chat-images/5e1k33roucczj38kzlrgw.png","actorIds":[],"_id":"cZBSzVfqbALadC96"}
{"name":"24 - T07 - Mage Armor (法師護甲)","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params =\n[{\n    filterType: \"field\",\n    filterId: \"myMageField\",\n    shieldType: 7,\n    gridPadding: 1.,\n    color: 0xFFFFFF,\n    time: 0,\n    blend: 4,\n    intensity: 0.8,\n    lightAlpha: 1,\n    lightSize: 0.45,\n    scale: 1,\n    radius: 1,\n    chromatic: false,\n    animated :\n    {\n      time : \n      { \n        active: true, \n        speed: 0.0015, \n        animType: \"move\" \n      }\n    }\n}];\nfor (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters(params[0][\"filterId\"]);\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"cZTPWACQSqLeloyH"}
{"name":"月華之光Macro","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false},"core":{"sourceId":"Macro.NBkeQXznAGf5ctbN"},"cf":{"id":"temp_u8moge7sbaa","path":"Private Compendium#/CF_SEP/法術效果Macro","color":"#000000"}},"scope":"global","command":"//DAE Macro Execute, Effect Value = \"Macro Name\" @target @item.level\n\nlet target = canvas.tokens.get(args[1])\nlet data = {}\n/**\n * Create Moonbeam item in inventory\n */\nif (args[0] === \"on\") {\n  let damage = args[2];\n  await target.actor.createOwnedItem(\n    {\n      \"name\": \"月華之光傷害\",\n      \"type\": \"spell\",\n      \"data\": {\n        \"description\": {\n          \"value\": \"\",\n          \"chat\": \"\",\n          \"unidentified\": \"\"\n        },\n        \"source\": \"\",\n        \"activation\": {\n          \"type\": \"special\",\n          \"cost\": 0,\n          \"condition\": \"\"\n        },\n        \"duration\": {\n          \"value\": null,\n          \"units\": \"\"\n        },\n        \"target\": {\n          \"value\": 5,\n          \"width\": null,\n          \"units\": \"ft\",\n          \"type\": \"cylinder\"\n        },\n        \"range\": {\n          \"value\": 120,\n          \"long\": null,\n          \"units\": \"ft\"\n        },\n        \"ability\": \"\",\n        \"actionType\": \"save\",\n        \"attackBonus\": 0,\n        \"damage\": {\n          \"parts\": [\n            [\n              `${damage}d10`,\n              \"radiant\"\n            ]\n          ],\n          \"versatile\": \"\"\n        },\n        \"formula\": \"\",\n        \"save\": {\n          \"ability\": \"con\",\n          \"dc\": null,\n          \"scaling\": \"spell\"\n        },\n        \"level\": 0,\n        \"school\": \"abj\",\n        \"preparation\": {\n          \"mode\": \"prepared\",\n          \"prepared\": false\n        },\n        \"scaling\": {\n          \"mode\": \"none\",\n          \"formula\": \"\"\n        }\n      },\n      \"img\": \"systems/dnd5e/icons/spells/beam-blue-3.jpg\",\n    }\n  );\n}\n\n// Delete Moonbeam\nif (args[0] === \"off\") {\n  let item = target.actor.data.items.find(i => i.name === \"Moonbeam repeating\" && i.type === \"spell\")\n  target.actor.deleteOwnedItem(item._id)\n}","author":"uDAdlkna037LVJd3","img":"https://assets.forge-vtt.com/bazaar/systems/dnd5e/assets/icons/spells/beam-blue-3.jpg","actorIds":[],"_id":"eSMTRXKKWzYpG8Nf"}
{"name":"26 - T02 - Mantle of Madness (liquid) 水下感濾鏡","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params =\n[{\n    filterType: \"liquid\",\n    filterId: \"myMantle\",\n    color: 0x0090FF,\n    time: 0,\n    blend: 5,\n    intensity: 0.0001,\n    spectral: false,\n    scale: 7,\n    animated :\n    {\n       time : \n       { \n          active: true, \n          speed: 0.0015, \n          animType: \"move\" \n       },\n       intensity : \n       { \n          active: true, \n          animType: \"syncCosOscillation\",\n          loopDuration: 30000,\n          val1: 0.0001, \n          val2: 4 \n       },\n       scale: \n       { \n          active: true, \n          animType: \"syncCosOscillation\",\n          loopDuration: 30000,\n          val1: 7, \n          val2: 1 \n       }\n    }\n}];\nfor (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters();\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"eUKfi10FcNwMzDj3"}
{"name":"ActorUnSetFlag","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":true},"core":{"sourceId":"Macro.WjEFOameOgKDV97B"},"cf":{"id":"temp_p28w90xb3v","path":"Private Compendium#/CF_SEP/系統(背景運作)","color":"#000000"}},"scope":"global","command":"//args[0] = token ID\r\n//args[1]-[3] = update data\r\n\r\nif(!args[0] || !args[1]) return ui.notifications.error(`${this.name}'s arguments are invalid.`);\r\n\r\ncanvas.tokens.get(args[0]).actor.unsetFlag(args[1], args[2]);\r\n","author":"uDAdlkna037LVJd3","img":"https://assets.forge-vtt.com/bazaar/core/icons/svg/dice-target.svg","actorIds":[],"_id":"fC6nXzYTJqZ9YB07"}
{"name":"獵人印記","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"dnd5e":{"itemMacro":true},"combat-utility-belt":{"macroTrigger":""},"core":{"sourceId":"Macro.Dho60hcIGhkbIu1G"},"cf":{"id":"temp_u8moge7sbaa","path":"Private Compendium#/CF_SEP/法術效果Macro","color":"#000000"}},"scope":"global","command":"//This marco is designed to be used in conjunction with MarkAttackWrapper.json\n//and GMConditions.js.\n\n//It is designed to replace the standard rollItemMacro for either the Hex\n//spell or the hunter's mark Spell on either the warlock or ranger, but\n//it will work on any class with hex or hunter's mark by changing the Localization\n//parameters. To use hex, replace warlockName variable below and if you\n//would like to use it with hunter's mark replace rangerName variable below.\n\n// CAUTION! if you change your global damage variables while this macro is\n//active the change will be erased. It should work fine with dynamic effects.\n\n//!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n//This macro is designed to be used with the combat utility belt module.\n//and the furnace module. Once you have it installed, you will have to enable \n//enhanced conditions, and create a condition called 'Marked' as the Localization \n//parameter below. You just need to update that parameter to match whatever condition \n//name you want if you want to use a different name in condition lab.\n//!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n\n//Localization\nconst rangerName = \"Ranger\";\nconst warlockName = \"Warlock\";\nconst rangerSpell = \"獵人印記\";\nconst warlockSpell = \"Hex\";\nconst condition = \"Marked\";\nconst flagScope = \"world\";\n\n//parameters\nif (!token) ui.notifications.error(\"Please select your token first.\");\nlet myToken = token;\nconst markDmg = \" + 1d6\";\nif (!game.user.targets.values().next().value) {\n  ui.notifications.error(\"Please select one target\");\n}\nconst target = game.user.targets.values().next().value;\n\nconst conditionList = target.data.effects;\nconst actorId = myToken.actor._id + \"_mark\";\nconst bonuses = myToken.actor.data.data.bonuses;\nlet className = \"\";\nlet spellName = \"\";\nlet gm_macro = null\n\n//Check to make sure that the GM has the GMConditions macro assigned.\ntry{\n    gm_macro = game.macros.entities.find(mb => mb.name === \"GMConditions\");\n}\ncatch(err)\n{\n    ui.notifications.error(\"GMConditions Macro was not found\")\n}\n\n//If Move flag and condition to a new selected target\nfunction move() {\n  let swapTarget = myToken.getFlag(flagScope, actorId);\n  const remCon = canvas.tokens.get(swapTarget.targetId);\n  gm_macro.execute(\"remove\", condition, swapTarget.targetId);\n  swapTarget.targetId = target.data._id;\n  (async () => {\n    await myToken.unsetFlag(flagScope, actorId);\n    myToken.setFlag(flagScope, actorId, swapTarget);\n  })();\n  gm_macro.execute(\"apply\", condition, target.id);\n  console.log();\n}\n\n//revert global damage to base, remove the condition and unset flag\n\nfunction remove() {\n  const flagId = myToken.getFlag(flagScope, actorId);\n\n  let obj = {\n    \"data.bonuses.mwak.damage\": flagId.meleeAtk,\n    \"data.bonuses.rwak.damage\": flagId.rangeAtk,\n    \"data.bonuses.msak.damage\": flagId.meleeSpell,\n    \"data.bonuses.rsak.damage\": flagId.rangeSpell\n  };\n\n  updateActor(myToken, obj);\n\n  const remFlag = canvas.tokens.get(flagId.targetId);\n\n  (async () => {\n    await gm_macro.execute(\"remove\", condition, flagId.targetId);\n    await myToken.unsetFlag(flagScope, actorId);\n  })();\n}\n\n// User input to move or remove flag and condition\n\nfunction alterMark() {\n  const d = new Dialog({\n    title: \"Mark Enemy\",\n    content: \"<p>Would you like to move or remove?</p>\",\n    buttons: {\n      one: {\n        icon: '<i class=\"fas fa-check\"></i>',\n        label: \"Move\",\n        callback: () => move()\n      },\n      two: {\n        icon: '<i class=\"fas fa-times\"></i>',\n        label: \"Remove\",\n        callback: () => remove()\n      }\n    },\n    default: \"two\",\n    close: () => console.log(\"Dialog closed\")\n  }).render(true);\n}\n\n// cast the spell, apply the condition, create and set flag\n\nasync function castSpell() {\n  try {\n    await game.dnd5e.rollItemMacro(spellName);\n  } catch (err) {\n    return null;\n  }\n  gm_macro.execute(\"apply\", condition, target.id);\n\n  let globalDmg = {\n    targetId: target.data._id,\n    meleeAtk: bonuses.mwak.damage,\n    rangeAtk: bonuses.rwak.damage,\n    meleeSpell: bonuses.msak.damage,\n    rangeSpell: bonuses.rsak.damage,\n    isSet: false\n  };\n  myToken.setFlag(flagScope, actorId, globalDmg);\n}\n\n//If the class is ranger and has the hunter's mark spell, set the spell name\n//or say the spell doesn't exist.\n\nfunction setRangerSpell() {\n  className = rangerName;\n  if (actor.items.find(i => i.name === `${rangerSpell}`)) {\n    spellName = rangerSpell;\n    castSpell();\n  } else {\n    ui.notifications.error(\n      \"Selected actor does not have the \" + rangerSpell + \" spell.\"\n    );\n    console.log(\"Selected actor does not have the \" + rangerSpell + \" spell.\");\n    return null;\n  }\n}\n\n//If the class is warlock and has the hex spell set the spell name\n//if say the spell doesn't exist\n\nfunction setWarlockSpell() {\n  className = warlockName;\n  if (actor.items.find(i => i.name === `${warlockSpell}`)) {\n    spellName = warlockSpell;\n    castSpell();\n  } else {\n    ui.notifications.error(\n      \"Selected actor does not have the \" + warlockSpell + \" spell.\"\n    );\n    console.log(\"Selected actor does not have the \" + warlockSpell + \" spell.\");\n    return null;\n  }\n}\n\n//check whether the token is a ranger or warlock\n\nfunction checkSpell() {\n  if (actor.items.find(i => i.name === `${rangerName}`)) {\n    setRangerSpell();\n  } else if (actor.items.find(i => i.name === `${warlockName}`)) {\n    setWarlockSpell();\n  } else {\n    ui.notifications.error(\n      \"Please select a \" + rangerName + \" or \" + warlockName + \" token.\"\n    );\n    console.log(\n      \"Please select a \" + rangerName + \" or \" + warlockName + \" token.\"\n    );\n  }\n}\n\nasync function updateActor(updateToken, obj) {\n  await updateToken.actor.update(obj);\n}\n\n//If the flag exists call functions to move or remove if it doesn't exist\n// call function to cast the spell\n\nif (myToken.getFlag(flagScope, actorId)) {\n  alterMark();\n} else {\n  checkSpell();\n}","author":"uDAdlkna037LVJd3","img":"https://assets.forge-vtt.com/bazaar/systems/dnd5e/assets/icons/spells/evil-eye-red-1.jpg","actorIds":[],"_id":"ffCTVAem63znHaOy"}
{"name":"24 - T09 - Water Defense (水護盾)","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\n\nlet params =\n[{\n    filterType: \"field\",\n    filterId: \"myWaterField\",\n    shieldType: 9,\n    gridPadding: 1.2,\n    color: 0x20BBEE,\n    time: 0,\n    blend: 4,\n    intensity: 1,\n    lightAlpha: 0.7,\n    lightSize: 0.5,\n    scale: 0.6,\n    radius: 1,\n    chromatic: false,\n    animated :\n    {\n      time : \n      { \n        active: true, \n        speed: 0.0015, \n        animType: \"move\" \n      }\n    }\n}];\nfor (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters(params[0][\"filterId\"]);\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"fh7edOUSG2zPDmXv"}
{"name":"28 - Glory to Pixels 馬賽克化","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params = \n[{\n    filterType: \"pixel\",\n    filterId: \"pixelate\",\n    sizeX: 2.5,\n    sizeY: 2.5\n}]\n  for (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters();\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"gDiRDsONBlfGJFCF"}
{"name":"ActorSetFlag","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":true},"core":{"sourceId":"Macro.6keeWvkYs6H43lHm"},"cf":{"id":"temp_p28w90xb3v","path":"Private Compendium#/CF_SEP/系統(背景運作)","color":"#000000"}},"scope":"global","command":"//args[0] = token ID\r\n//args[1]-[3] = update data\r\n\r\nif(!args[0] || !args[1]) return ui.notifications.error(`${this.name}'s arguments are invalid.`);\r\n\r\ncanvas.tokens.get(args[0]).actor.setFlag(args[1], args[2], args[3]);\r\n\r\n","author":"uDAdlkna037LVJd3","img":"https://assets.forge-vtt.com/bazaar/core/icons/svg/dice-target.svg","actorIds":[],"_id":"gE4JYAHakCtgAbID"}
{"name":"移除TokenFX","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"core":{"sourceId":"Macro.louNQauk7UbD2fCK"},"furnace":{"runAsGM":false},"cf":{"id":"temp_3cf00lo747r","path":"Private Compendium#/CF_SEP/GM用","color":"#000000"}},"scope":"global","command":"// Delete all filters on the selected tokens/tiles\nTokenMagic.deleteFiltersOnSelected();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"gQOIAHm2HG4DLWO7"}
{"name":"24 - T08 - Chromatic Bubble (七彩球)","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"furnace":{"runAsGM":false},"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params =\n[{\n    filterType: \"field\",\n    filterId: \"myChromaField\",\n    shieldType: 8,\n    gridPadding: 2,\n    color: 0xAAAAAA,\n    time: 0,\n    blend: 2,\n    intensity: 1,\n    lightAlpha: 0,\n    lightSize: 0,\n    scale: 1,\n    radius: 1,\n    chromatic: true,\n    zOrder: 512,\n    animated :\n    {\n      time : \n      { \n        active: true, \n        speed: 0.0045, \n        animType: \"move\" \n      }\n    }\n}];\nfor (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters(params[0][\"filterId\"]);\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"gtRR0Mq0BhVbvJ2e"}
{"name":"24 - T11 - Grid Force Field (格狀力場)","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params =\n[{\n    filterType: \"field\",\n    filterId: \"myGridField\",\n    shieldType: 11,\n    gridPadding: 2,\n    color: 0x00CCCC,\n    time: 0,\n    blend: 2,\n    intensity: 1,\n    lightAlpha: 1,\n    lightSize: 0.3,\n    scale: 0.5,\n    radius: 1,\n    chromatic: false,\n    zOrder: 512,\n    animated :\n    {\n      time : \n      { \n        active: true, \n        speed: 0.0009, \n        animType: \"move\" \n      }\n    }\n}];\nfor (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters();\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"gy6uaSVHwo6cykSq"}
{"name":"18 - Electric (藍色電弧)","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"furnace":{"runAsGM":false},"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"// Because the shader is dynamically compiled,\n// intensity is a one time init and can't be updated.\n// you must delete the filters to \"change\" it.\n\n//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params =\n[{\n    filterType: \"electric\",\n    filterId: \"myElectric\",\n    color: 0xFFFFFF,\n    time: 0,\n    blend: 1,\n    intensity: 5,\n    animated :\n    {\n      time : \n      { \n        active: true, \n        speed: 0.0020, \n        animType: \"move\" \n      }\n    }\n}];\n   for (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters(params[0][\"filterId\"]);\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"i4jKaUXdiQ5daXX8"}
{"name":"火焰彈","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"core":{"sourceId":"Macro.68CDpJv8wdDdnGI6"},"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false},"cf":{"id":"temp_aet7bgv1idl","path":"Private Compendium#/CF_SEP/動畫效果","color":"#000000"}},"scope":"global","command":"//This macro plays the animation on selected targets with a trajectory and distances of 30ft, 60ft and 90ft\n//It works for animations like Scorching Ray, Fire Bolt, Arrow, Boulder Toss, Siege Projectile that use these distances\n//Import this macro, duplicate it and change its name making sure it's unique by adding the colour (i.e. \"Ray Of Frost Blue\").\n//If it has the exact same name as the spell or item you want to trigger it from, you'll encounter an issue.\n\n//folder 01 is the directory path to the assets\n// let folder01 = \"modules/JB2A_DnD5e/Library/2nd_Level/Scorching_Ray/\";\n//anFile30 points to the file corresponding to 30ft, anFile60 for 60ft and anFile90 for 90ft\n// let anFile30 = `${folder01}ScorchingRay_01_Orange_30ft_1600x400.webm`;\n// let anFile60 = `${folder01}ScorchingRay_01_Orange_60ft_2800x400.webm`;\n// let anFile90 = `${folder01}ScorchingRay_01_Orange_90ft_4000x400.webm`;\n\n//How this macro is set up for Fire Bolt\nlet folder01 = \"modules/JB2A_DnD5e/Library/Cantrip/Fire_Bolt/\";\nlet anFile30 = `${folder01}FireBolt_01_Regular_Orange_30ft_1600x400.webm`;\nlet anFile60 = `${folder01}FireBolt_01_Regular_Orange_60ft_2800x400.webm`;\nlet anFile90 = `${folder01}FireBolt_01_Regular_Orange_90ft_4000x400.webm`;\n\n\nif(game.user.targets.size == 0) ui.notifications.error('請至少選取一個目標');\nif(canvas.tokens.controlled.length == 0) ui.notifications.error(\"請選取你的Token\");\n///Check if Module dependencies are installed or returns an error to the user\nif (!canvas.fxmaster) ui.notifications.error(\"這個Marco需要搭配FXMaster module使用，請確保它功能啟動\");\n\nconst wait = (delay) => new Promise((resolve) => setTimeout(resolve, delay))\n\nasync function Cast() {\nvar myStringArray = Array.from(game.user.targets)[0];\nvar arrayLength = game.user.targets.size;\nfor (var i = 0; i < arrayLength; i++) {\n\nlet mainTarget = Array.from(game.user.targets)[i];\nlet myToken = canvas.tokens.controlled [0];\n\nlet ray = new Ray(myToken.center, mainTarget.center);\nlet anDeg = -(ray.angle * 57.3);\nlet anDist = ray.distance;\n\n\nlet anFile = anFile30;\nlet anFileSize = 1200;\nlet anchorX = 0.125;\nswitch(true){\n case (anDist<=1200):\n    anFileSize = 1200;\n    anFile = anFile30;\n    anchorX = 0.125;\n    break;\n case (anDist>2400):\n    anFileSize = 3600;\n    anFile = anFile90;\n    anchorX = 0.05;\n    break;\n default:\n    anFileSize = 2400;\n    anFile = anFile60;\n    anchorX = 0.071;\n    break;\n}\n\nlet anScale = anDist / anFileSize;\nlet anScaleY = anDist <= 600 ? 0.6  : anScale;\n\nlet spellAnim = \n                    {\n                     file: anFile,\n                      position: myToken.center,\n                      anchor: {\n                       x: anchorX,\n                       y: 0.5\n                      },\n                      angle: anDeg,\n                      scale: {\n                       x: anScale,\n                       y: anScaleY\n                      }\n                    }; \n\ncanvas.fxmaster.playVideo(spellAnim);\ngame.socket.emit('module.fxmaster', spellAnim);\nawait wait (250);\n}\n}\nCast ()","author":"uDAdlkna037LVJd3","img":"https://assets.forge-vtt.com/bazaar/modules/JB2A_DnD5e/assets/Library/Cantrip/Fire_Bolt/FireBolt_01_Regular_Orange_Thumb.webp","actorIds":[],"_id":"iwp4FntrEKQEUVd3"}
{"name":"24 - T02 - Fire Shield 4 - Lava Zone","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params =\n[{\n    filterType: \"zapshadow\",\n    filterId: \"myZap\",\n    alphaTolerance: 0.45\n},{\n    filterType: \"field\",\n    filterId: \"myLavaRing\",\n    shieldType: 6,\n    gridPadding: 1.25,\n    color: 0xFFAA00,\n    time: 0,\n    blend: 14,\n    intensity: 1,\n    lightAlpha: 0,\n    lightSize: 0.7,\n    scale: 1,\n    radius: 1,\n    chromatic: false,\n    discardThreshold: 0.30,\n    hideRadius: 0.95,\n    alphaDiscard: true,\n    animated :\n    {\n      time : \n      { \n        active: true, \n        speed: 0.0015, \n        animType: \"move\" \n      },\n      radius: \n       {\n          active: true, \n          loopDuration: 6000, \n          animType: \"cosOscillation\", \n          val1:1, \n          val2:0.8\n       },\n      hideRadius: \n       {\n          active: true, \n          loopDuration: 3000, \n          animType: \"cosOscillation\", \n          val1:0.75, \n          val2:0.4\n       }\n    }\n},{\n    filterType: \"xglow\",\n    filterId: \"myBurningAura\",\n    auraType: 2,\n    color: 0xFF5000,\n    thickness: 9.8,\n    scale: 1.,\n    time: 0,\n    auraIntensity: 2,\n    subAuraIntensity: 1,\n    threshold: 0.30,\n    discard: true,\n    zOrder: 3000,\n    animated:\n    {\n        time : \n        {  \n           active: true,\n           speed: 0.0027, \n           animType: \"move\" \n        },\n        thickness:\n        {\n           active: true,\n           loopDuration: 600, \n           animType: \"cosOscillation\", \n           val1:4, \n           val2:8\n        }\n    }\n}];\n for (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters(params[0][\"filterId\"]);\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"jWpjaqW3oZN9XW7a"}
{"name":"34 - T03 - Blood Bath (splash) 輻射爆血","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params =\n    [{\n        filterType: \"splash\",\n        filterId: \"mySplash\",\n        color: 0xFF0505,\n        padding: 80,\n        time: 0,\n        seed: 0.10,\n        splashFactor: 2.25,\n        spread: 7,\n        blend: 7,\n        dimX: 1,\n        dimY: 1,\n        alphaBlending: false,\n        alphaDiscard: true,\n        cut: true,\n        animated :\n        {\n          time : \n          { \n            active: true, \n            speed: 0.0009, \n            animType: \"move\" \n          }\n        }\n    }];\nfor (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters();\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"jrBK4733UZBHuSgR"}
{"name":"10 - T01 - Bulge (transform) 膨脹","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params =\n    [{\n        filterType: \"transform\",\n        filterId: \"myBulgeTransform\",\n        bpRadiusPercent: 70,\n        padding: 100,\n        animated:\n        {\n            bpStrength:\n            {\n                animType: \"cosOscillation\",\n                val1: 0,\n                val2: 0.65,\n                loopDuration: 3500,\n            }\n        }\n    }];\n\n    for (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters(params[0][\"filterId\"]);\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"jtJzYaygquI2VT0u"}
{"name":"27 - T04 - Pure Fire (xglow+fire) 火焰纏身","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"furnace":{"runAsGM":false},"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params =\n[{\n    filterType: \"fire\",\n    filterId: \"myPureFire\",\n    intensity: 1,\n    color: 0xFFFFFF,\n    amplitude: 1,\n    time: 0,\n    blend: 2,\n    fireBlend : 1,\n    animated :\n    {\n      time : \n      { \n        active: true, \n        speed: -0.0024, \n        animType: \"move\" \n      },\n      intensity:\n      {\n        active:true,\n        loopDuration: 15000,\n        val1: 0.8,\n        val2: 2,\n        animType: \"syncCosOscillation\"\n      },\n      amplitude:\n      {\n        active:true,\n        loopDuration: 4400,\n        val1: 1,\n        val2: 1.4,\n        animType: \"syncCosOscillation\"\n      }\n      \n    }\n},\n{\n    filterType: \"zapshadow\",\n    filterId: \"myPureFireShadow\",\n    alphaTolerance: 0.50\n},\n{\n    filterType: \"xglow\",\n    filterId: \"myPureFireAura\",\n    auraType: 2,\n    color: 0x903010,\n    thickness: 9.8,\n    scale: 4.,\n    time: 0,\n    auraIntensity: 2,\n    subAuraIntensity: 1.5,\n    threshold: 0.40,\n    discard: true,\n    animated:\n    {\n        time : \n        {  \n           active: true,\n           speed: 0.0027, \n           animType: \"move\" \n        },\n        thickness:\n        {\n           active: true,\n           loopDuration: 3000, \n           animType: \"cosOscillation\", \n           val1:2, \n           val2:5\n        }\n    }\n}];\n for (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters();\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"juRIJ6ZALu08Oabj"}
{"name":"#[CF_tempEntity]","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"chat","flags":{"cf":{"id":"temp_p28w90xb3v","path":"Private Compendium#/CF_SEP/系統(背景運作)","color":"#000000","name":"系統(背景運作)","children":["68Cr9z9XEJlpD4n0","qjLYM6Nb59oRkRGx","n1aerdB9AqND2JfH","fC6nXzYTJqZ9YB07","gE4JYAHakCtgAbID","GauCsivK3vbH6Llj"],"folderPath":["temp_5b37tcuw6xw"]}},"scope":"global","command":"","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"kFttlnLCmP9PSUlN"}
{"name":"紅彈動畫","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"core":{"sourceId":"Macro.68CDpJv8wdDdnGI6"},"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false},"cf":{"id":"temp_aet7bgv1idl","path":"Private Compendium#/CF_SEP/動畫效果","color":"#000000"}},"scope":"global","command":"//This macro plays the animation on selected targets with a trajectory and distances of 30ft, 60ft and 90ft\n//It works for animations like Scorching Ray, Fire Bolt, Arrow, Boulder Toss, Siege Projectile that use these distances\n//Import this macro, duplicate it and change its name making sure it's unique by adding the colour (i.e. \"Ray Of Frost Blue\").\n//If it has the exact same name as the spell or item you want to trigger it from, you'll encounter an issue.\n\n//folder 01 is the directory path to the assets\n// let folder01 = \"modules/JB2A_DnD5e/Library/2nd_Level/Scorching_Ray/\";\n//anFile30 points to the file corresponding to 30ft, anFile60 for 60ft and anFile90 for 90ft\n// let anFile30 = `${folder01}ScorchingRay_01_Orange_30ft_1600x400.webm`;\n// let anFile60 = `${folder01}ScorchingRay_01_Orange_60ft_2800x400.webm`;\n// let anFile90 = `${folder01}ScorchingRay_01_Orange_90ft_4000x400.webm`;\n\n//How this macro is set up for Fire Bolt\nlet folder01 = \"modules/JB2A_DnD5e/Library/Generic/Weapon_Attacks/Ranged/\";\nlet anFile30 = `${folder01}LazerShot_01_Red_30ft_1600x400.webm`;\nlet anFile60 = `${folder01}LazerShot_01_Red_30ft_1600x400.webm`;\nlet anFile90 = `${folder01}LazerShot_01_Red_30ft_1600x400.webm`;\n\n\nif(game.user.targets.size == 0) ui.notifications.error('請至少選取一個目標');\nif(canvas.tokens.controlled.length == 0) ui.notifications.error(\"請選取你的Token\");\n///Check if Module dependencies are installed or returns an error to the user\nif (!canvas.fxmaster) ui.notifications.error(\"這個Marco需要搭配FXMaster module使用，請確保它功能啟動\");\n\nconst wait = (delay) => new Promise((resolve) => setTimeout(resolve, delay))\n\nasync function Cast() {\nvar myStringArray = Array.from(game.user.targets)[0];\nvar arrayLength = game.user.targets.size;\nfor (var i = 0; i < arrayLength; i++) {\n\nlet mainTarget = Array.from(game.user.targets)[i];\nlet myToken = canvas.tokens.controlled [0];\n\nlet ray = new Ray(myToken.center, mainTarget.center);\nlet anDeg = -(ray.angle * 57.3);\nlet anDist = ray.distance;\n\n\nlet anFile = anFile30;\nlet anFileSize = 1200;\nlet anchorX = 0.125;\nswitch(true){\n case (anDist<=1200):\n    anFileSize = 1200;\n    anFile = anFile30;\n    anchorX = 0.125;\n    break;\n case (anDist>2400):\n    anFileSize = 3600;\n    anFile = anFile90;\n    anchorX = 0.05;\n    break;\n default:\n    anFileSize = 2400;\n    anFile = anFile60;\n    anchorX = 0.071;\n    break;\n}\n\nlet anScale = anDist / anFileSize;\nlet anScaleY = anDist <= 600 ? 0.6  : anScale;\n\nlet spellAnim = \n                    {\n                     file: anFile,\n                      position: myToken.center,\n                      anchor: {\n                       x: anchorX,\n                       y: 0.5\n                      },\n                      angle: anDeg,\n                      scale: {\n                       x: anScale,\n                       y: anScaleY\n                      }\n                    }; \n\ncanvas.fxmaster.playVideo(spellAnim);\ngame.socket.emit('module.fxmaster', spellAnim);\nawait wait (250);\n}\n}\nCast ()","author":"uDAdlkna037LVJd3","img":"https://assets.forge-vtt.com/bazaar/modules/JB2A_DnD5e/assets/Library/Generic/Weapon_Attacks/Ranged/LazerShot_01_Red_Thumb.webp","actorIds":[],"_id":"kfXB3nnPbGwdHznj"}
{"name":"05 - Glow (藍色呼吸光)","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"furnace":{"runAsGM":false},"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params =\n[{\n    filterType: \"glow\",\n    filterId: \"superSpookyGlow\",\n    outerStrength: 4,\n    innerStrength: 0,\n    color: 0x5099DD,\n    quality: 0.5,\n    padding: 10,\n    animated:\n    {\n        color: \n        {\n           active: true, \n           loopDuration: 3000, \n           animType: \"colorOscillation\", \n           val1:0x5099DD, \n           val2:0x90EEFF\n        }\n    }\n}];\nfor (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters(params[0][\"filterId\"]);\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"kjs5jCOzzXNB4sTG"}
{"name":"24 - T05 - Mega - Ice Shell (on top) (冰霜力場球)","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\n\nlet params =\n[{\n    filterType: \"field\",\n    filterId: \"myEarthFieldTop\",\n    shieldType: 5,\n    gridPadding: 3,\n    color: 0x00DDFF,\n    time: 0,\n    blend: 5,\n    intensity: 1.9,\n    lightAlpha: 0,\n    lightSize: 0,\n    scale: 1,\n    radius: 1,\n    zIndex: 5,\n    discardThreshold: 0.09,\n    alphaDiscard: true,\n    animated :\n    {\n      time : \n      { \n        active: true, \n        speed: 0.0015, \n        animType: \"move\" \n      }\n    }\n},\n    {\n        filterType: \"xglow\",\n        filterId: \"myEarthFieldTopGlow\",\n        auraType: 1,\n        color: 0x5099DD,\n        thickness: 4.5,\n        scale: 1,\n        time: 0,\n        auraIntensity: 0.25,\n        subAuraIntensity: 1,\n        threshold: 0.5,\n        discard: false,\n        zOrder: 3000,\n        animated:\n        {\n            time:\n            {\n                active: true,\n                speed: 0.0018,\n                animType: \"move\"\n            },\n            thickness:\n            {\n                val1: 2, val2: 2.5,\n                animType: \"cosOscillation\",\n                loopDuration: 3000\n            },\n            subAuraIntensity:\n            {\n                val1: 0.45, val2: 0.65,\n                animType: \"cosOscillation\",\n                loopDuration: 6000\n            },\n            auraIntensity:\n            {\n                val1: 0.9, val2: 2.2,\n                animType: \"cosOscillation\",\n                loopDuration: 3000\n            }\n        }\n    }];\nfor (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters(params[0][\"filterId\"]);\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"l1RmoFW2Mz9oKp7j"}
{"name":"01 - Bevel","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"let TokenFXFunction = async function () {\nlet params = \n[{\n    filterType: \"bevel\",\n    filterId: \"myBevel\",\n    rotation: 0,\n    thickness: 5,\n    lightColor: 0xFF0000,\n    lightAlpha: 0.8,\n    shadowColor: 0x00FF00,\n    shadowAlpha: 0.5,\n    animated :\n    {\n       rotation: \n       { \n          active: true,\n          clockWise: true, \n          loopDuration: 1600, \n          animType: \"syncRotation\"\n       }\n    }\n}];\n for (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters(params[0][\"filterId\"]);\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"lcxmTY7WBgkXx0SN"}
{"name":"大爆血","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false},"cf":{"id":"temp_aet7bgv1idl","path":"Private Compendium#/CF_SEP/動畫效果","color":"#000000"}},"scope":"global","command":"//This macro plays the animation on selected targets with no trajectory\n//It works for animations like Cure Wounds, Healing Ability and Dizzy Stars \n//Import this macro, duplicate it and change its name making sure it's unique by adding the colour (i.e. \"Cure Wounds Blue\").\n//If it has the exact same name as the spell or item you want to trigger it from, you'll encounter an issue.\n//folder 01 is the directory path to the assets\nlet folder01 = \"worlds/DamnAdventurers/Special%20Effect/\";\n//anFile is the name of the file used for the animation\nlet anFile = `${folder01}Dramatic%20Blood%20burst.webm`;\n\n\n//another example would be:\n//let folder01 = \"modules/JB2A_DnD5e/Library/Generic/Healing/\"\n//let anFile = `${folder01}HealingAbility_01_Green_200x200.webm`;\n\nconst wait = (delay) => new Promise((resolve) => setTimeout(resolve, delay))\n\nasync function Cast() {\nvar myStringArray = Array.from(game.user.targets)[0];\nvar arrayLength = game.user.targets.size;\nfor (var i = 0; i < arrayLength; i++) {\n\nlet mainTarget = Array.from(game.user.targets)[i];\nlet tarScale = ((mainTarget.data.width + mainTarget.data.height)/2);\n\n\nlet spellAnim = \n                    {\n                     file: anFile,\n                      position: mainTarget.center,\n                      anchor: {\n                       x: 0.5,\n                       y: 0.5\n                      },\n                      angle: 0,\n                      scale: {\n                       x: 1.5,\n                       y: 1.5\n                      }\n                    }; \ncanvas.fxmaster.playVideo(spellAnim);\ngame.socket.emit('module.fxmaster', spellAnim);\nawait wait (75);\n}\n}\nCast ()","author":"uDAdlkna037LVJd3","img":"https://assets.forge-vtt.com/5fbe5ec1f959b5dea569b164/uploaded-chat-images/image_qdjv6iplawausvez6svnk.png","actorIds":[],"_id":"lq5m8KbPeXYRRln8"}
{"name":"24 - T01 - Hexa Force Field 3 - Scintillating (奇怪的力場球)","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params =\n[{\n    filterType: \"field\",\n    filterId: \"myHexaField\",\n    shieldType: 2,\n    gridPadding: 2,\n    color: 0x00CCDD,\n    time: 0,\n    blend: 2,\n    intensity: 1,\n    lightAlpha: 0,\n    lightSize: 0,\n    scale: 2,\n    radius: 0.98,\n    chromatic: false,\n    discardThreshold: 0.13,\n    alphaDiscard: true,\n    animated :\n    {\n      time : \n      { \n        active: true, \n        speed: 0.0015, \n        animType: \"move\" \n      }\n    }\n},\n{\n    filterType: \"xglow\",\n    filterId: \"myBurningAura\",\n    auraType: 2,\n    color: 0x500050,\n    scale: 1.,\n    time: 0,\n    auraIntensity: 1,\n    subAuraIntensity: 0,\n    threshold: 0,\n    discard: false,\n    zOrder: 3000,\n    animated:\n    {\n        time : \n        {  \n           active: true,\n           speed: 0.0027, \n           animType: \"move\" \n        },\n        thickness:\n        {\n           active: true,\n           loopDuration: 6000, \n           animType: \"cosOscillation\", \n           val1:2, \n           val2:4\n        }\n    }\n}];\nfor (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters(params[0][\"filterId\"]);\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"mAxxFqK8TjMdHxdE"}
{"name":"24 - T08 - Chromatic Bubble 2 (七彩球(小))","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"furnace":{"runAsGM":false},"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params =\n[{\n    filterType: \"field\",\n    filterId: \"myChromaField\",\n    shieldType: 8,\n    gridPadding: 1,\n    color: 0xAAAAAA,\n    time: 0,\n    blend: 2,\n    intensity: 1,\n    lightAlpha: 0,\n    lightSize: 0,\n    scale: 1,\n    radius: 1,\n    chromatic: true,\n    discardThreshold: 0.3,\n    alphaDiscard: true,\n    animated :\n    {\n      time : \n      { \n        active: true, \n        speed: 0.0045, \n        animType: \"move\" \n      }\n    }\n}];\nfor (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters(params[0][\"filterId\"]);\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"mNsFpiNEaKL4NvYa"}
{"name":"24 - T04 - Shell - Earth (土護盾球(大))","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params =\n[{\n    filterType: \"field\",\n    filterId: \"myEarthField\",\n    shieldType: 4,\n    gridPadding: 2,\n    color: 0xBB9070,\n    time: 0,\n    blend: 1,\n    intensity: 1.25,\n    lightAlpha: 1,\n    lightSize: 0.7,\n    scale: 1,\n    radius: 1,\n    chromatic: false,\n    animated :\n    {\n      time : \n      { \n        active: true, \n        speed: 0.0015, \n        animType: \"move\" \n      }\n    }\n}];\n for (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters(params[0][\"filterId\"]);\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"mU09xRzpZN1ApFFF"}
{"name":"24 - T10 - Evil Aura (不詳靈光)","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params =\n[{\n    filterType: \"field\",\n    filterId: \"myEvilField\",\n    shieldType: 10,\n    gridPadding: 1,\n    color: 0xFF3010,\n    time: 0,\n    blend: 5,\n    intensity: 1,\n    lightAlpha: 4,\n    lightSize: 0.8,\n    scale: 0.5,\n    radius: 1,\n    chromatic: false,\n    zOrder: 512,\n    animated :\n    {\n      time : \n      { \n        active: true, \n        speed: 0.0012, \n        animType: \"move\" \n      },\n      lightSize:        \n      {\n        val1: 0.4, val2: 1.5,\n        animType: \"syncCosOscillation\",\n        loopDuration: 5000\n      }\n    }\n}];\n for (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters();\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"mjkrzj0j4M3XaRLL"}
{"name":"E - Click, click, click and click !","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"let glowFunc = async function() {\n\n   const myTokens = canvas.tokens.placeables;\n\n   for (const myToken of myTokens ){\n       if (myToken.TMFXhasFilterId(\"funnyAlternateGlow\")) {\n           await myToken.TMFXdeleteFilters(\"funnyAlternateGlow\");\n       } else {\n           let params =\n           [{\n               filterType: \"glow\",\n               filterId: \"funnyAlternateGlow\",\n               color: Math.floor(Math.random() * 16777215),\n               animated: null\n           }];\n           await myToken.TMFXaddUpdateFilters(params);\n       }\n   }\n};\n\nglowFunc();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"myO2BKwcCn9G8WSp"}
{"name":"ActorUpdate","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":true},"core":{"sourceId":"Macro.gCnaEz5xK3oP11uI"},"cf":{"id":"temp_p28w90xb3v","path":"Private Compendium#/CF_SEP/系統(背景運作)","color":"#000000"}},"scope":"global","command":"//args[0] = actor ID\r\n//args[1] = update data\r\n\r\nif(!args[0] || !args[1]) return ui.notifications.error(`${this.name}'s arguments are invalid.`);\r\n\r\n(async()=>{\r\n  await canvas.tokens.get(args[0]).actor.update(args[1]);\r\n})();","author":"uDAdlkna037LVJd3","img":"https://assets.forge-vtt.com/bazaar/core/icons/svg/dice-target.svg","actorIds":[],"_id":"n1aerdB9AqND2JfH"}
{"name":"23 - T01 - Mirror Images 鏡影術","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params =\n[{\n    filterType: \"images\",\n    filterId: \"myMirrorImages\",\n    time: 0,\n    nbImage: 4,\n    alphaImg: 1.0,\n    alphaChr: 0.0,\n    blend: 4,\n    ampX: 0.10,\n    ampY: 0.10,\n    zOrder: 20,\n    animated :\n    {\n      time: \n      { \n        active: true, \n        speed: 0.0010, \n        animType: \"move\" \n      }\n    }\n}];\n  for (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters(params[0][\"filterId\"]);\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"nWoXmTDKPkJCJbxx"}
{"name":"27 - T01 - Burning Aura (xglow) 火焰外側","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params =\n[{\n    filterType: \"zapshadow\",\n    filterId: \"myZapShadow\",\n    alphaTolerance: 0.50\n},\n{\n    filterType: \"xglow\",\n    filterId: \"myBurningAura\",\n    auraType: 2,\n    color: 0x903010,\n    thickness: 9.8,\n    scale: 4.,\n    time: 0,\n    auraIntensity: 2,\n    subAuraIntensity: 1.5,\n    threshold: 0.40,\n    discard: true,\n    animated:\n    {\n        time : \n        {  \n           active: true,\n           speed: 0.0027, \n           animType: \"move\" \n        },\n        thickness:\n        {\n           active: true,\n           loopDuration: 3000, \n           animType: \"cosOscillation\", \n           val1:2, \n           val2:5\n        }\n    }\n}];\nfor (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters();\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"nnQdkJmbwW4PBk2w"}
{"name":"17 - Fumes (煙霧濾鏡)","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"furnace":{"runAsGM":false},"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params =\n[{\n    filterType: \"fumes\",\n    filterId: \"myFumes\",\n    color: 0x808080,\n    time: 0,\n    blend: 8,\n    animated :\n    {\n      time : \n      { \n        active: true, \n        speed: 0.001, \n        animType: \"move\" \n      }\n    }\n}];\n  for (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters(params[0][\"filterId\"]);\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"npdbD7mmQagZPMQO"}
{"name":"紫色追魂","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"core":{"sourceId":"Macro.8CSStDFwPkXZUdDy"},"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_aet7bgv1idl","path":"Private Compendium#/CF_SEP/動畫效果","color":"#000000"}},"scope":"global","command":"/// This macro pulls from the JB2A list of Magic Missiles to throw 1 random path at targeted tokens\n\n//folder01 targets the Magic Missile Folder\nlet folder01 = \"modules/JB2A_DnD5e/Library/1st_Level/Magic_Missile/\";\n//Each file is then defined as a variable that will be stored in an array and then chose at random\nlet mmA = `${folder01}MagicMissile_01_Purple_30ft_01_1600x400.webm`;\nlet mmB = `${folder01}MagicMissile_01_Purple_30ft_02_1600x400.webm`;\nlet mmC = `${folder01}MagicMissile_01_Purple_30ft_03_1600x400.webm`;\nlet mmD = `${folder01}MagicMissile_01_Purple_30ft_04_1600x400.webm`;\nlet mmE = `${folder01}MagicMissile_01_Purple_30ft_05_1600x400.webm`;\nlet mmF = `${folder01}MagicMissile_01_Purple_30ft_06_1600x400.webm`;\nlet mmG = `${folder01}MagicMissile_01_Purple_30ft_07_1600x400.webm`;\nlet mmH = `${folder01}MagicMissile_01_Purple_30ft_08_1600x400.webm`;\nlet mmI = `${folder01}MagicMissile_01_Purple_30ft_09_1600x400.webm`;\n\nlet mmAA = `${folder01}MagicMissile_01_Purple_60ft_01_2800x400.webm`;\nlet mmBB = `${folder01}MagicMissile_01_Purple_60ft_02_2800x400.webm`;\nlet mmCC = `${folder01}MagicMissile_01_Purple_60ft_03_2800x400.webm`;\nlet mmDD = `${folder01}MagicMissile_01_Purple_60ft_04_2800x400.webm`;\nlet mmEE = `${folder01}MagicMissile_01_Purple_60ft_05_2800x400.webm`;\nlet mmFF = `${folder01}MagicMissile_01_Purple_60ft_06_2800x400.webm`;\nlet mmGG = `${folder01}MagicMissile_01_Purple_60ft_07_2800x400.webm`;\nlet mmHH = `${folder01}MagicMissile_01_Purple_60ft_08_2800x400.webm`;\nlet mmII = `${folder01}MagicMissile_01_Purple_60ft_09_2800x400.webm`;\n\n///Check if Module dependencies are installed or returns an error to the user\nif (!canvas.fxmaster) ui.notifications.error(\"這個Marco需要搭配FXMaster module使用，請確保它功能啟動\");\nif(game.user.targets.size == 0) ui.notifications.error('請至少選取一個目標');\nif(canvas.tokens.controlled.length == 0) ui.notifications.error(\"請選取你的Token\");\n\n\n\nfunction random_itemA(itemsA)\n{\nreturn itemsA[Math.floor(Math.random()*itemsA.length)];\n}\n\nvar itemsA = [mmA, mmB, mmC, mmD, mmE, mmF, mmG, mmH, mmI];\n\nfunction random_itemB(itemsB)\n{\nreturn itemsB[Math.floor(Math.random()*itemsB.length)];\n}\n\nvar itemsB = [mmAA, mmBB, mmCC, mmDD, mmEE, mmFF, mmGG, mmHH, mmII];\nconst wait = (delay) => new Promise((resolve) => setTimeout(resolve, delay))\n\nasync function Cast() {\nvar myStringArray = Array.from(game.user.targets)[0];\nvar arrayLength = game.user.targets.size;\nfor (var i = 0; i < arrayLength; i++) {\n\nlet mainTarget = Array.from(game.user.targets)[i];\nlet myToken = canvas.tokens.controlled [0];\n\nlet ray = new Ray(myToken.center, mainTarget.center);\nlet anDeg = -(ray.angle * 57.3);\nlet anDist = ray.distance;\n\nlet anFile = random_itemA(itemsA);\nlet anFileSize = 1200;\nlet anchorX = 0.125;\nswitch(true){\n case (anDist<1800):\n    anFileSize = 1200;\n    anFile = random_itemA(itemsA);\n    anchorX = 0.125;\n    break;\n default:\n    anFileSize = 2400;\n    anFile = random_itemB(itemsB);\n    anchorX = 0.071;\n    break;\n}\n\n\n\nlet anScale = anDist / anFileSize;\nlet anScaleY = anScale;\nif (anDist<=600){anScaleY = 0.5}\nif (anDist>600 && anDist <1000){anScaleY = 0.66}\nif (anDist>=1000 && anDist <1800){anScaleY = anScale}\nif (anDist>=1800 && anDist <2400){anScaleY = 0.8}\nif (anDist>=2400){anScaleY = anScale}\n\nlet spellAnim = \n                    {\n                     file: anFile,\n                      position: myToken.center,\n                      anchor: {\n                       x: anchorX,\n                       y: 0.5\n                      },\n                      angle: anDeg,\n                      scale: {\n                       x: anScale,\n                       y: anScaleY\n                      }\n                    }; \n\ncanvas.fxmaster.playVideo(spellAnim);\nawait wait (80);\n\ngame.socket.emit('module.fxmaster', spellAnim);\nawait wait (50);\n}\n}\nCast()","author":"uDAdlkna037LVJd3","img":"https://assets.forge-vtt.com/bazaar/modules/JB2A_DnD5e/assets/Library/1st_Level/Magic_Missile/MagicMissile_01_Purple_Thumb.webp","actorIds":[],"_id":"oBFUKo8lphSXbnlj"}
{"name":"20 - Waves (很~奇~異)","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"// Below, you can turn on the anchor animation.\n\n//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params =\n[{\n    filterType: \"wave\",\n    filterId: \"myWaves\",\n    time: 0,\n    anchorX: 0.5,\n    anchorY: 0.5,\n    strength: 0.015,\n    frequency: 120,\n    color: 0xFFFFFF,\n    maxIntensity: 2.5,\n    minIntensity: 0.9,\n    padding:10,\n    animated :\n    {\n      time : \n      { \n        active: true, \n        speed: 0.0085, \n        animType: \"move\" \n      },\n      anchorX :\n      {\n        active: false,\n        val1: 0.15,\n        val2: 0.85,\n        animType: \"syncChaoticOscillation\",\n        loopDuration: 20000\n      },\n      anchorY :\n      {\n        active: false,\n        val1: 0.15,\n        val2: 0.85,\n        animType: \"syncSinOscillation\",\n        loopDuration: 20000\n      }\n    }\n}];\nfor (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters(params[0][\"filterId\"]);\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"oSddAGvzdjHrwUuC"}
{"name":"25 - T02 - Lucky Clover (xray) (黃綠色波紋)","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params =\n[{\n    filterType: \"xray\",\n    filterId: \"myLuckyRays\",\n    time: 0,\n    color: 0x00FF00,\n    blend: 9,\n    dimX: 0.05,\n    dimY: 0.05,\n    anchorX: 0.5,\n    anchorY: 0.5,\n    divisor: 4,\n    intensity: 1,\n    animated :\n    {\n       time : \n       { \n          active: true, \n          speed: 0.0012, \n          animType: \"move\" \n       },\n       anchorX:\n       {\n          animType: \"syncCosOscillation\",\n          loopDuration : 6000,\n          val1: 0.40,\n          val2: 0.60\n       },\n       anchorY:\n       {\n          animType: \"syncSinOscillation\",\n          loopDuration : 6000,\n          val1: 0.40,\n          val2: 0.60\n       }\n    }\n}];\n for (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters();\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"p7XxowlYKfyr7dXE"}
{"name":"C - Electric Multi-Filters","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"// works better with tokens or tiles with no shadows\nlet params =\n[{\n    filterType: \"shadow\",\n    blur: 2,\n    quality: 5,\n    distance: 0,\n    alpha: 1.,\n    padding: 100,\n    color: 0xFFFFFF,\n    animated:\n    {\n        blur:     \n        { \n           active: true, \n           loopDuration: 500, \n           animType: \"syncCosOscillation\", \n           val1: 2, \n           val2: 4\n        },\n     }\n},\n{\n    filterType: \"electric\",\n    color: 0xFFFFFF,\n    time: 0,\n    blend: 2,\n    intensity: 5,\n    animated :\n    {\n      time : \n      { \n        active: true, \n        speed: 0.0020, \n        animType: \"move\" \n      }\n    }\n}];\n\nTokenMagic.addFiltersOnSelected(params);","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"q3D85sJZq3X3tabI"}
{"name":"強化能力Macro","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false},"core":{"sourceId":"Macro.uwhN6zTM7HTzX8QC"},"cf":{"id":"temp_u8moge7sbaa","path":"Private Compendium#/CF_SEP/法術效果Macro","color":"#000000"}},"scope":"global","command":"//DAE Macro Execute, Effect Value = \"Macro Name\" @target \n\nlet target = canvas.tokens.get(args[1]);\n\n/**\n * For each target select the effect (GM selection)\n */\nif (args[0] === \"on\") {\n    new Dialog({\n        title: \"請選擇要強化的能力 \",\n        buttons: {\n            one: {\n                label: \"熊之堅韌 Bear’s Endurance\",\n                callback: () => {\n                    let formula = `2d6`;\n                    let amount = new Roll(formula).roll().total;\n                    target.actor.setFlag('world', 'enhanceAbility', {\n                        name: \"bear\",\n                    });\n                    ChatMessage.create({ content: target.name + \"獲得\" + amount + \"點臨時生命值\" });\n                    target.update({ \"data.attributes.hp.temp\": amount });\n\n                }\n            },\n            two: {\n                label: \"牛之蠻力 Bull’s Strength\",\n                callback: () => {\n                    ChatMessage.create({ content: target.name + \"的負重能力倍增了\" });\n                    target.actor.setFlag('world', 'enhanceAbility', {\n                        name: \"bull\",\n                    });\n                    target.actor.setFlag('dnd5e', 'powerfulBuild', true);\n                }\n            },\n            three: {\n                label: \"其他能力\",\n                callback: () => {\n                    target.actor.setFlag('world', 'enhanceAbility', {\n                        name: \"other\",\n                    });\n                    ChatMessage.create({ content: \"該強化能力無法自動計算，請DM自己加油。\" });\n                }\n            }\n        }\n    }).render(true);\n}\n\nif (args[0] === \"off\") {\n    let flag = target.actor.getFlag('world', 'enhanceAbility');\n    if (flag.name === \"bull\") target.actor.unsetFlag('dnd5e', 'powerfulBuild', false);\n    target.actor.unsetFlag('world', 'enhanceAbility');\n    ChatMessage.create({ content: \"強化能力的效果結束了\" });\n}","author":"uDAdlkna037LVJd3","img":"https://assets.forge-vtt.com/bazaar/systems/dnd5e/assets/icons/spells/haste-royal-2.jpg","actorIds":[],"_id":"qHsMqQwedIYRQskg"}
{"name":"GMConditions","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":true},"core":{"sourceId":"Macro.EjqFxrT7x1YTHbJX"},"cf":{"id":"temp_p28w90xb3v","path":"Private Compendium#/CF_SEP/系統(背景運作)","color":"#000000"}},"scope":"global","command":"//This macro must be called 'GMConditions' and be on the GM's\n//hot bar for the castMark.js macro to function correctly.\n//you must tick the option 'Excecute Macro As GM' to grant\n//players access to this macro.\n\n\nconst action = args[0]\nconst condition = args[1]\nconst targetId = args[2]\nconst target = canvas.tokens.get(targetId);\nif (action == \"apply\"){\n    game.cub.addCondition(condition, target, {replaceExisting: true})\n}\nelse if (action == \"remove\"){\n    game.cub.removeCondition(condition, target, {warn: true});\n}","author":"uDAdlkna037LVJd3","img":"https://assets.forge-vtt.com/5fbe5ec1f959b5dea569b164/worlds/DamnAdventurers/Player%20Assets/%E6%88%B4%E5%80%AB%20Pic(.png","actorIds":[],"_id":"qjLYM6Nb59oRkRGx"}
{"name":"14 - Remove Shadow (移除陰影)","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"// this simple filter remove pixels with a certain amount of alpha\n// it can be useful to remove shadows before using glow or outline filters.\n//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params =\n[{\n    filterType: \"zapshadow\",\n    filterId: \"myZap\",\n    alphaTolerance: 0.45,\n    rank: 2\n}];\n for (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters(params[0][\"filterId\"]);\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"qwJjewGv1FiMoxGd"}
{"name":"放逐術Macro","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false},"core":{"sourceId":"Macro.iO0OLVjnVC8mz9i0"},"cf":{"id":"temp_u8moge7sbaa","path":"Private Compendium#/CF_SEP/法術效果Macro","color":"#000000"}},"scope":"global","command":"//DAE Macro Execute, Effect Value = \"Macro Name\" @target\n\nlet target = canvas.tokens.get(args[1]); //find target\n\nif (args[0] === \"on\") {\n    target.update({hidden : true}); // hide targeted token\n    ChatMessage.create({content: target.name + \" 被驅逐了\"});\n    \n}\nif(args[0]=== \"off\") {\n target.update({hidden : false}); // unhide token\n ChatMessage.create({content: target.name + \"  已回歸\"});\n}","author":"uDAdlkna037LVJd3","img":"https://assets.forge-vtt.com/bazaar/systems/dnd5e/assets/icons/spells/link-eerie-3.jpg","actorIds":[],"_id":"qxxLrKWFemps1Pc0"}
{"name":"25 - T04 - Blue Rays ! (xray) 藍色異界濾鏡","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"furnace":{"runAsGM":false},"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params =\n[{\n    filterType: \"xray\",\n    filterId: \"myBlueRay\",\n    time: 0,\n    color: 0x1030FF,\n    blend: 9,\n    dimX: 1,\n    dimY: 1,\n    anchorX: 0,\n    anchorY: 0,\n    divisor: 24,\n    intensity: 1,\n    animated :\n    {\n       time : \n       { \n          active: true, \n          speed: 0.0002, \n          animType: \"move\" \n       },\n       anchorX:\n       {\n          animType: \"syncCosOscillation\",\n          loopDuration : 18000,\n          val1: 0.05,\n          val2: 0.95\n       },\n       anchorY:\n       {\n          animType: \"syncSinOscillation\",\n          loopDuration : 18000,\n          val1: 0.05,\n          val2: 0.95\n       }\n    }\n}];\n for (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters();\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"rL8F9oTqrb4KddCP"}
{"name":"27 - T06 - Pure Ice (xglow+smoke) 冰霜纏身","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\n   \nlet params =\n    [{\n        filterType: \"zapshadow\",\n        filterId: \"myPureIceZapShadow\",\n        alphaTolerance: 0.50\n    },\n    {\n        filterType: \"xglow\",\n        filterId: \"myPureIceAura\",\n        auraType: 1,\n        color: 0x5099DD,\n        thickness: 4.5,\n        scale: 10,\n        time: 0,\n        auraIntensity: 0.25,\n        subAuraIntensity: 1,\n        threshold: 0.5,\n        discard: false,\n        animated:\n        {\n            time:\n            {\n                active: true,\n                speed: 0.0018,\n                animType: \"move\"\n            },\n            thickness:\n            {\n                val1: 2, val2: 2.5,\n                animType: \"cosOscillation\",\n                loopDuration: 3000\n            },\n            subAuraIntensity:\n            {\n                val1: 0.45, val2: 0.65,\n                animType: \"cosOscillation\",\n                loopDuration: 6000\n            },\n            auraIntensity:\n            {\n                val1: 0.9, val2: 2.2,\n                animType: \"cosOscillation\",\n                loopDuration: 3000\n            }\n        }\n    },\n    {\n        filterType: \"smoke\",\n        filterId: \"myPureIceSmoke\",\n        color: 0x80CCFF,\n        time: 0,\n        blend: 2,\n        dimX: 0.3,\n        dimY: 1,\n        animated:\n        {\n            time:\n            {\n                active: true,\n                speed: -0.006,\n                animType: \"move\"\n            },\n            dimX:\n            {\n                val1: 0.4, val2: 0.2,\n                animType: \"cosOscillation\",\n                loopDuration: 3000\n            }\n        }\n    }];\nfor (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters();\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"rPCygdSKeUgxTSdb"}
{"name":"#[CF_tempEntity]","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"chat","flags":{"cf":{"id":"temp_u8moge7sbaa","path":"Private Compendium#/CF_SEP/法術效果Macro","color":"#000000","name":"法術效果Macro","children":["6TBJnuJAk8WsCMXX","EMrU1ltN93xW6u4C","F33u1DcaYZpdoDZB","JDGUw8rSO2WU4YIk","2VaR6dBrcvbBHt4l","TAvwRB90erm95QdU","9ALbs9OeUh09sjc1","NIYDzrefc0SH7l9N","ffCTVAem63znHaOy","ury2pbVpmv7CahAT","JkaxAVMeIoLA2yCJ","8gVmjgxF0e4Opq44","0ijOGhNXzb0XYWEw","eSMTRXKKWzYpG8Nf","qxxLrKWFemps1Pc0","TpE24TZTvt4We37E","qHsMqQwedIYRQskg","ToLPaqo040kzptc2"],"folderPath":["temp_5b37tcuw6xw"]}},"scope":"global","command":"","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"rUmvGmZORGcvqQHS"}
{"name":"Deck of Many Things","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"core":{"sourceId":"Macro.DfH9pgQvPCzRF1qV"},"cf":{"id":"temp_3cf00lo747r","path":"Private Compendium#/CF_SEP/GM用","color":"#000000"}},"scope":"global","command":"const table = game.tables.entities.find(t => t.name === \"Deck of Many Things\");\ntable.draw();","author":"uDAdlkna037LVJd3","img":"icons/sundries/gaming/playing-cards-grey.webp","actorIds":[],"_id":"teibn5fpycCIPyGT"}
{"name":"21 - Flood (藍色水下濾鏡)","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params =\n[{\n    filterType: \"flood\",\n    filterId: \"myFlood\",\n    time: 0,\n    color: 0x0020BB,\n    billowy: 0.43,\n    tintIntensity: 0.72,\n    glint: 0.31,\n    scale: 70,\n    padding: 10,\n    animated :\n    {\n      time : \n      { \n        active: true, \n        speed: 0.0006, \n        animType: \"move\"\n      }\n    }\n}];\n for (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters(params[0][\"filterId\"]);\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"u7MTapRnE5GlAFWk"}
{"name":"27 - T02 - Glacial Aura (xglow) 冰色光芒","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params =\n[{\n    filterType: \"zapshadow\",\n    filterId: \"myGlacialZapShadow\",\n    alphaTolerance: 0.50\n},\n{\n    filterType: \"xglow\",\n    filterId: \"myGlacialAura\",\n    auraType: 1,\n    color: 0x5099DD,\n    thickness: 4.5,\n    scale: 3,\n    time: 0,\n    auraIntensity: 0.8,\n    subAuraIntensity: 0.25,\n    threshold: 0.5,\n    discard: false,\n    animated:\n    {\n        time : \n        {  \n           active: true,\n           speed: 0.0018, \n           animType: \"move\" \n        },\n        thickness:        \n        {\n           val1: 2, val2: 4.7,\n           animType: \"cosOscillation\",\n           loopDuration: 3000\n        },\n        subAuraIntensity:        \n        {\n           val1: 0.45, val2: 0.65,\n           animType: \"cosOscillation\",\n           loopDuration: 6000\n        },\n        auraIntensity:        \n        {\n           val1: 0.9, val2: 2.2,\n           animType: \"cosOscillation\",\n           loopDuration: 3000\n        }\n    }\n}];\nfor (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters();\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"uI0MpqXWjeXh4Tag"}
{"name":"35 - T04 - Cold Fire (xfire) 青炎","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params =\n[{\n    filterType: \"xfire\",\n    filterId: \"myColdXFire\",\n    time: 0,\n    color: 0xBBDDEE,\n    blend: 1,\n    amplitude: 1,\n    dispersion: 0,\n    chromatic: false,\n    scaleX: 1,\n    scaleY: 1,\n    inlay: false,\n    animated :\n    {\n      time : \n      { \n        active: true, \n        speed: -0.0015, \n        animType: \"move\" \n      }\n    }\n}];\nfor (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters();\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"uLj8n1zx8n0Lcf5O"}
{"name":"熾焰法球Macro","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"core":{"sourceId":"Macro.wH1oxGvmKdTAvy06"},"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_u8moge7sbaa","path":"Private Compendium#/CF_SEP/法術效果Macro","color":"#000000"}},"scope":"global","command":"let d = new Dialog({\n  title: \"熾焰法球Macro\",\n  content: \"角色列表已新增熾焰法球，可將它拖曳到畫面上使用\",\n  buttons: {\n      one: {\n       icon: '<i class=\"fas fa-check\"></i>',\n       label: \"OK\",\n       //callback: () => console.log(\"Chose One\")\n      },\n    \n  },\n});\nd.render(true);\n\n(async ()=>{\n    let testFolder = game.folders.find(f => f.name === \"熾焰法球 Flaming Sphere\" && f.type === \"Actor\");\n    if(!testFolder) testFolder = await Folder.create({ name : `熾焰法球 Flaming Sphere`, type : `Actor`, parent : null });\n  \n    await Actor.create({\n      name: \"熾焰法球 Flaming Sphere\",\n      type: \"npc\",\n      img: \"modules/JB2A_DnD5e/Library/2nd_Level/Flaming_Sphere/FlamingSphere_01_Orange_Thumb.webp\",\n      folder: testFolder.id,\n      sort: 12000,\n      token: { img: \"modules/JB2A_DnD5e/Library/2nd_Level/Flaming_Sphere/FlamingSphere_01_Orange_200x200.webm\", scale:1},      \n      \"token.vision\": true,\n      \"token.disposition\": 1,\n      \"token.dimLight\": 40,\n      \"token.brightLight\": 20,\n      \"token.lightAnimation\":{type: \"torch\", speed: 10, intensity: 1},\n      \"token.lightColor\": \"#ffde85\",\n      \"token.lightAlpha\": 0.09,\n    })\n  })();","author":"uDAdlkna037LVJd3","img":"https://assets.forge-vtt.com/bazaar/modules/JB2A_DnD5e/assets/Library/2nd_Level/Flaming_Sphere/FlamingSphere_01_Orange_Thumb.webp","actorIds":[],"_id":"ury2pbVpmv7CahAT"}
{"name":"24 - T02 - Fire Shield 3 - Ring (火焰圓環(小))","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params =\n[{\n    filterType: \"zapshadow\",\n    filterId: \"myZap\",\n    alphaTolerance: 0.45\n},{\n    filterType: \"field\",\n    filterId: \"myFireField\",\n    shieldType: 1,\n    gridPadding: 1.1,\n    color: 0xE58550,\n    time: 0,\n    blend: 2,\n    intensity: 1.2,\n    lightAlpha: 1,\n    lightSize: 0.7,\n    scale: 1,\n    radius: 1,\n    chromatic: false,\n    discardThreshold: 0.9,\n    hideRadius: 0.95,\n    alphaDiscard: true,\n    animated :\n    {\n      time : \n      { \n        active: true, \n        speed: 0.0015, \n        animType: \"move\" \n      }\n    }\n},{\n    filterType: \"xglow\",\n    filterId: \"myBurningAura\",\n    auraType: 2,\n    color: 0x903010,\n    thickness: 9.8,\n    scale: 4.,\n    time: 0,\n    auraIntensity: 2,\n    subAuraIntensity: 1.5,\n    threshold: 0.40,\n    discard: true,\n    zOrder: 3000,\n    animated:\n    {\n        time : \n        {  \n           active: true,\n           speed: 0.0027, \n           animType: \"move\" \n        },\n        thickness:\n        {\n           active: true,\n           loopDuration: 3000, \n           animType: \"cosOscillation\", \n           val1:2, \n           val2:5\n        }\n    }\n}];\nfor (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters(params[0][\"filterId\"]);\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"xUb9IboADKjWeeSj"}
{"name":"雷劈動畫","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false},"cf":{"id":"temp_aet7bgv1idl","path":"Private Compendium#/CF_SEP/動畫效果","color":"#000000"}},"scope":"global","command":"//This macro plays the animation on selected targets with no trajectory\n//It works for animations like Cure Wounds, Healing Ability and Dizzy Stars \n//Import this macro, duplicate it and change its name making sure it's unique by adding the colour (i.e. \"Cure Wounds Blue\").\n//If it has the exact same name as the spell or item you want to trigger it from, you'll encounter an issue.\n//folder 01 is the directory path to the assets\nlet folder01 = \"worlds/DamnAdventurers/Special%20Effect/\";\n//anFile is the name of the file used for the animation\nlet anFile = `${folder01}DS.webm`;\n\n//another example would be:\n//let folder01 = \"modules/JB2A_DnD5e/Library/Generic/Healing/\"\n//let anFile = `${folder01}HealingAbility_01_Green_200x200.webm`;\n\nconst wait = (delay) => new Promise((resolve) => setTimeout(resolve, delay))\n\nasync function Cast() {\nvar myStringArray = Array.from(game.user.targets)[0];\nvar arrayLength = game.user.targets.size;\nfor (var i = 0; i < arrayLength; i++) {\n\nlet mainTarget = Array.from(game.user.targets)[i];\nlet tarScale = ((mainTarget.data.width + mainTarget.data.height)/2);\n\n\nlet spellAnim = \n                    {\n                     file: anFile,\n                      position: mainTarget.center,\n                      anchor: {\n                       x: 0.5,\n                       y: 0.9\n                      },\n                      angle: 0,\n                      scale: {\n                       x: 0.9,\n                       y: 0.9\n                      }\n                    }; \ncanvas.fxmaster.playVideo(spellAnim);\ngame.socket.emit('module.fxmaster', spellAnim);\nawait wait (3000);\n}\n}\nCast ()","author":"uDAdlkna037LVJd3","img":"https://assets.forge-vtt.com/5fbe5ec1f959b5dea569b164/uploaded-chat-images/wxaeaw8hzumma2jhwfbrc.png","actorIds":[],"_id":"xYkickP7pwcVCHY9"}
{"name":"創造靈體武器","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"core":{"sourceId":"Macro.pFPiaw9k2o8tKnlz"},"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_2od1tntv3ht","path":"Private Compendium#/CF_SEP/創造TOKEN","color":"#000000"}},"scope":"global","command":"let d = new Dialog({\n  title: \"創造靈體武器\",\n  content: \"<p>靈體武器已經新增到角色清單，請將它拖曳到地圖上使用\",\n  buttons: {\n      one: {\n       icon: '<i class=\"fas fa-check\"></i>',\n       label: \"OK\",\n       callback: () => console.log(\"Chose One\")\n      },\n    \n  },\n});\nd.render(true);\n\n(async ()=>{\n  let testFolder = game.folders.find(f => f.name === \"靈體武器\" && f.type === \"Actor\");\n  if(!testFolder) testFolder = await Folder.create({ name : `靈體武器`, type : `Actor`, parent : null });\n\n  await Actor.create({\n    name: \"靈體武器\",\n    type: \"npc\",\n    img: \"modules/JB2A_DnD5e/Library/2nd_Level/Spiritual_Weapon/SpiritualWeapon_Mace01_01_Spectral_Blue_Thumb.webp\",\n    folder: testFolder.id,\n    sort: 12000,\n    token: { img: \"modules/JB2A_DnD5e/Library/2nd_Level/Spiritual_Weapon/SpiritualWeapon_Mace01_01_Spectral_Blue_200x200.webm\", scale: 2},      \n    \"token.vision\": true,\n    \"token.disposition\": 1,\n  })\n})();","author":"uDAdlkna037LVJd3","img":"https://assets.forge-vtt.com/bazaar/modules/JB2A_DnD5e/assets/Library/2nd_Level/Spiritual_Weapon/SpiritualWeapon_Mace01_01_Spectral_Blue_Thumb.webp","actorIds":[],"_id":"xbB3aUKk7s9eq43M"}
{"name":"33 - T01 - Evade Stance (transform) Token晃動","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"furnace":{"runAsGM":false},"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params =\n    [{\n        filterType: \"transform\",\n        filterId: \"dodgeStance\",\n        padding: 50,\n        animated:\n        {\n            translationX:\n            {\n                animType: \"sinOscillation\",\n                val1: -0.125,\n                val2: +0.125,\n                loopDuration: 1400,\n            },\n            translationY:\n            {\n                animType: \"cosOscillation\",\n                val1: -0.035,\n                val2: +0.035,\n                loopDuration: 1400,\n            }\n        }\n    }];\nfor (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters();\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"xmmAuLynL0Twt9NN"}
{"name":"16 - Inner Fog (迷霧濾鏡)","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"furnace":{"runAsGM":false},"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params =\n[{\n    filterType: \"fog\",\n    filterId: \"myFog\",\n    color: 0x000000,\n    density: 0.65,\n    time: 0,\n    dimX: 1,\n    dimY: 1,\n    animated :\n    {\n      time : \n      { \n        active: true, \n        speed: 2.2, \n        animType: \"move\" \n      }\n    }\n}];\n  for (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters(params[0][\"filterId\"]);\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"y4CWmtoimFonbmqb"}
{"name":"29 - T02 - Phase Spider Web (xfog+web) 蜘蛛網","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\nlet params = \n[{\n    filterType: \"web\",\n    filterId: \"phaseweb\",\n    time: 0,\n    animated:\n        {\n            time:\n            {\n                active: true,\n                speed: 0.0005,\n                animType: \"move\"\n            }\n        }\n},\n{\n    filterType: \"xfog\",\n    filterId: \"phaseweb\",\n    color: 0x30FF30,\n    time: 0,\n    animated:\n        {\n            time:\n            {\n                active: true,\n                speed: 0.0005,\n                animType: \"move\"\n            }\n        }\n}]\n  for (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters();\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"yZaTZa95U3L8MTTc"}
{"name":"F - 03 - Export FX Presets","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"TokenMagic.exportPresetLibrary();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"z1hlFVckUDQEb3Du"}
{"name":"24 - T06 - Air Bubble 2 (殘破藍色護盾)","permission":{"default":0,"uDAdlkna037LVJd3":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"cf":{"id":"temp_lcdzr6f17v8","path":"TOKEN FX","color":"#000000"}},"scope":"global","command":"//把Params置換成想要的特效效果即可\nlet TokenFXFunction = async function () {\n\nlet params =\n[{\n    filterType: \"field\",\n    filterId: \"myAirField\",\n    shieldType: 6,\n    gridPadding: 1.2,\n    color: 0x7090AA,\n    time: 0,\n    blend: 2,\n    intensity: 1,\n    lightAlpha: 0,\n    lightSize: 0,\n    scale: 1,\n    radius: 1,\n    chromatic: false,\n    discardThreshold: 0.1,\n    alphaDiscard: true,\n    animated :\n    {\n      time : \n      { \n        active: true, \n        speed: 0.0015, \n        animType: \"move\" \n      }\n    }\n}];\n for (const token of canvas.tokens.controlled) {\n        if (token.TMFXhasFilterId(params[0][\"filterId\"])) {\n            await token.TMFXdeleteFilters(params[0][\"filterId\"]);\n        } else {\n            await token.TMFXaddUpdateFilters(params);\n        }\n    }\n}\n\n// call the async function\nTokenFXFunction();","author":"uDAdlkna037LVJd3","img":"icons/svg/dice-target.svg","actorIds":[],"_id":"zWhF9DAMlEqsuLZY"}
